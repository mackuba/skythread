{
  "version": 3,
  "sources": ["../minisky.js", "../models.js", "../api.js", "../lib/purify.es.mjs", "../utils.js", "../utils_ts.ts", "../embed_component.js", "../rich_text_lite.js", "../post_component.js", "../menu.js", "../thread_page.js", "../posting_stats_page.js", "../notifications_page.js", "../like_stats_page.js", "../private_search_page.js", "../skythread.js"],
  "sourcesContent": [
    "/**\n * Thrown when status code of an API response is not \"success\".\n */\n\nexport class APIError extends Error {\n\n  /** @param {number} code, @param {json} json */\n  constructor(code, json) {\n    super(\"APIError status \" + code + \"\\n\\n\" + JSON.stringify(json));\n    this.code = code;\n    this.json = json;\n  }\n}\n\n\n/**\n * Thrown when passed arguments/options are invalid or missing.\n */\n\nexport class RequestError extends Error {}\n\n\n/**\n * Thrown when authentication is needed, but access token is invalid or missing.\n */\n\nexport class AuthError extends Error {}\n\n\n/**\n * Thrown when DID or DID document is invalid.\n */\n\nexport class DIDError extends Error {}\n\n\n/**\n * Base API client for connecting to an ATProto XRPC API.\n */\n\nexport class Minisky {\n\n  /** @param {string} did, @returns {Promise<string>} */\n\n  static async pdsEndpointForDid(did) {\n    let url;\n\n    if (did.startsWith('did:plc:')) {\n      url = new URL(`https://plc.directory/${did}`);\n    } else if (did.startsWith('did:web:')) {\n      let host = did.replace(/^did:web:/, '');\n      url = new URL(`https://${host}/.well-known/did.json`);\n    } else {\n      throw new DIDError(\"Unknown DID type: \" + did);\n    }\n\n    let response = await fetch(url);\n    let text = await response.text();\n    let json = text.trim().length > 0 ? JSON.parse(text) : undefined;\n\n    if (response.status == 200) {\n      let service = (json.service || []).find(s => s.id == '#atproto_pds');\n      if (service) {\n        return service.serviceEndpoint.replace('https://', '');\n      } else {\n        throw new DIDError(\"Missing #atproto_pds service definition\");\n      }\n    } else {\n      throw new APIError(response.status, json);\n    }\n  }\n\n  /**\n   * @typedef {object} MiniskyOptions\n   * @prop {boolean} [sendAuthHeaders]\n   * @prop {boolean} [autoManageTokens]\n   *\n   * @typedef {object} MiniskyConfig\n   * @prop {json | null | undefined} user\n   * @prop {() => void} save\n   *\n   * @param {string | undefined} host\n   * @param {MiniskyConfig | null | undefined} [config]\n   * @param {MiniskyOptions} [options]\n   */\n\n  constructor(host, config, options) {\n    this.host = host;\n    this.config = config;\n    this.user = /** @type {json} */ (config?.user);\n\n    this.sendAuthHeaders = !!this.user;\n    this.autoManageTokens = !!this.user;\n\n    if (options) {\n      Object.assign(this, options);\n    }\n  }\n\n  /** @returns {string} */\n\n  get baseURL() {\n    if (this.host) {\n      let host = (this.host.includes('://')) ? this.host : `https://${this.host}`;\n      return host + '/xrpc';\n    } else {\n      throw new RequestError('Hostname not set');\n    }\n  }\n\n  /** @returns {boolean} */\n\n  get isLoggedIn() {\n    return !!(this.user && this.user.accessToken && this.user.refreshToken && this.user.did && this.user.pdsEndpoint);\n  }\n\n  /**\n   * @typedef {object} MiniskyRequestOptions\n   * @prop {string | boolean} [auth]\n   * @prop {Record<string, string>} [headers]\n   *\n   * @param {string} method, @param {json | null} [params], @param {MiniskyRequestOptions} [options]\n   * @returns {Promise<json>}\n   */\n\n  async getRequest(method, params, options) {\n    let url = new URL(`${this.baseURL}/${method}`);\n    let auth = options && ('auth' in options) ? options.auth : this.sendAuthHeaders;\n\n    if (this.autoManageTokens && auth === true) {\n      await this.checkAccess();\n    }\n\n    if (params) {\n      for (let p in params) {\n        if (params[p] instanceof Array) {\n          params[p].forEach(x => url.searchParams.append(p, x));\n        } else {\n          url.searchParams.append(p, params[p]);\n        }\n      }\n    }\n\n    let headers = this.authHeaders(auth);\n\n    if (options && options.headers) {\n      Object.assign(headers, options.headers);\n    }\n\n    let response = await fetch(url, { headers: headers });\n    return await this.parseResponse(response);\n  }\n\n  /**\n   * @param {string} method, @param {json | null} [data], @param {MiniskyRequestOptions} [options]\n   * @returns Promise<json>\n   */\n\n  async postRequest(method, data, options) {\n    let url = `${this.baseURL}/${method}`;\n    let auth = options && ('auth' in options) ? options.auth : this.sendAuthHeaders;\n\n    if (this.autoManageTokens && auth === true) {\n      await this.checkAccess();\n    }\n\n    let request = { method: 'POST', headers: this.authHeaders(auth) };\n\n    if (data) {\n      request.body = JSON.stringify(data);\n      request.headers['Content-Type'] = 'application/json';\n    }\n\n    if (options && options.headers) {\n      Object.assign(request.headers, options.headers);\n    }\n\n    let response = await fetch(url, request);\n    return await this.parseResponse(response);\n  }\n\n  /**\n   * @typedef {MiniskyOptions & {\n   *   field: string,\n   *   params?: json,\n   *   breakWhen?: (obj: json) => boolean,\n   *   keepLastPage?: boolean | undefined,\n   *   onPageLoad?: FetchAllOnPageLoad | undefined\n   * }} FetchAllOptions\n   *\n   * @param {string} method\n   * @param {FetchAllOptions} [options]\n   * @returns {Promise<json[]>}\n   */\n\n  async fetchAll(method, options) {\n    if (!options || !options.field) {\n      throw new RequestError(\"'field' option is required\");\n    }\n\n    let data = [];\n    let reqParams = options.params ?? {};\n    let reqOptions = this.sliceOptions(options, ['auth', 'headers']);\n\n    for (;;) {\n      let response = await this.getRequest(method, reqParams, reqOptions);\n\n      let items = response[options.field];\n      let cursor = response.cursor;\n\n      if (options.breakWhen) {\n        let test = options.breakWhen;\n\n        if (items.some(x => test(x))) {\n          if (!options.keepLastPage) {\n            items = items.filter(x => !test(x));\n          }\n\n          cursor = null;\n        }\n      }\n\n      data = data.concat(items);\n      reqParams.cursor = cursor;\n\n      if (options.onPageLoad) {\n        let result = options.onPageLoad(items);\n\n        if (result?.cancel) {\n          break;\n        }\n      }\n\n      if (!cursor) {\n        break;\n      }\n    }\n\n    return data;\n  }\n\n  /** @param {string | boolean} auth, @returns {Record<string, string>} */\n\n  authHeaders(auth) {\n    if (typeof auth == 'string') {\n      return { 'Authorization': `Bearer ${auth}` };\n    } else if (auth) {\n      if (this.user?.accessToken) {\n        return { 'Authorization': `Bearer ${this.user.accessToken}` };\n      } else {\n        throw new AuthError(\"Can't send auth headers, access token is missing\");\n      }\n    } else {\n      return {};\n    }\n  }\n\n  /** @param {json} options, @param {string[]} list, @returns {json} */\n\n  sliceOptions(options, list) {\n    let newOptions = {};\n\n    for (let i of list) {\n      if (i in options) {\n        newOptions[i] = options[i];\n      }\n    }\n\n    return newOptions;\n  }\n\n  /** @param {string} token, @returns {number} */\n\n  tokenExpirationTimestamp(token) {\n    let parts = token.split('.');\n    if (parts.length != 3) {\n      throw new AuthError(\"Invalid access token format\");\n    }\n\n    let payload = JSON.parse(atob(parts[1]));\n    let exp = payload.exp;\n\n    if (!(exp && typeof exp == 'number' && exp > 0)) {\n      throw new AuthError(\"Invalid token expiry data\");\n    }\n\n    return exp * 1000;\n  }\n\n  /** @param {Response} response, @param {json} json, @returns {boolean} */\n\n  isInvalidToken(response, json) {\n    return (response.status == 400) && !!json && ['InvalidToken', 'ExpiredToken'].includes(json.error);\n  }\n\n  /** @param {Response} response, @returns {Promise<json>} */\n\n  async parseResponse(response) {\n    let text = await response.text();\n    let json = text.trim().length > 0 ? JSON.parse(text) : undefined;\n\n    if (response.status >= 200 && response.status < 300) {\n      return json;\n    } else {\n      throw new APIError(response.status, json);\n    }\n  }\n\n  /** @returns {Promise<void>} */\n\n  async checkAccess() {\n    if (!this.isLoggedIn) {\n      throw new AuthError(\"Not logged in\");\n    }\n\n    let expirationTimestamp = this.tokenExpirationTimestamp(this.user.accessToken);\n\n    if (expirationTimestamp < new Date().getTime() + 60 * 1000) {\n      await this.performTokenRefresh();\n    }\n  }\n\n  /** @param {string} handle, @param {string} password, @returns {Promise<json>} */\n\n  async logIn(handle, password) {\n    if (!this.config || !this.config.user) {\n      throw new AuthError(\"Missing user configuration object\");\n    }\n\n    let params = { identifier: handle, password: password };\n    let json = await this.postRequest('com.atproto.server.createSession', params, { auth: false });\n\n    this.saveTokens(json);\n    return json;\n  }\n\n  /** @returns {Promise<json>} */\n\n  async performTokenRefresh() {\n    if (!this.isLoggedIn) {\n      throw new AuthError(\"Not logged in\");\n    }\n\n    console.log('Refreshing access token…');\n    let json = await this.postRequest('com.atproto.server.refreshSession', null, { auth: this.user.refreshToken });\n    this.saveTokens(json);\n    return json;\n  }\n\n  /** @param {json} json */\n\n  saveTokens(json) {\n    if (!this.config || !this.config.user) {\n      throw new AuthError(\"Missing user configuration object\");\n    }\n\n    this.user.accessToken = json['accessJwt'];\n    this.user.refreshToken = json['refreshJwt'];\n    this.user.did = json['did'];\n\n    if (json.didDoc?.service) {\n      let service = json.didDoc.service.find(s => s.id == '#atproto_pds');\n      this.host = service.serviceEndpoint.replace('https://', '');\n    }\n\n    this.user.pdsEndpoint = this.host;\n    this.config.save();\n  }\n\n  resetTokens() {\n    if (!this.config || !this.config.user) {\n      throw new AuthError(\"Missing user configuration object\");\n    }\n\n    delete this.user.accessToken;\n    delete this.user.refreshToken;\n    delete this.user.did;\n    delete this.user.pdsEndpoint;\n    this.config.save();\n  }\n}\n",
    "import { atURI, castToInt } from './utils.js';\n\n/**\n * Thrown when parsing post JSON fails.\n */\n\nclass PostDataError extends Error {\n\n  /** @param {string} message */\n  constructor(message) {\n    super(message);\n  }\n}\n\n\n/**\n * Generic record type, base class for all records or record view objects.\n */\n\nexport class ATProtoRecord {\n\n  /** @param {json} data, @param {json} [extra] */\n  constructor(data, extra) {\n    this.data = data;\n    Object.assign(this, extra ?? {});\n  }\n\n  /** @returns {string} */\n  get uri() {\n    return this.data.uri;\n  }\n\n  /** @returns {string} */\n  get cid() {\n    return this.data.cid;\n  }\n\n  /** @returns {string} */\n  get rkey() {\n    return atURI(this.uri).rkey;\n  }\n\n  /** @returns {string} */\n  get type() {\n    return this.data.$type;\n  }\n}\n\n\n/**\n * Standard Bluesky post record.\n */\n\nexport class Post extends ATProtoRecord {\n  /**\n   * Post object which is the direct parent of this post.\n   * @type {ATProtoRecord | undefined}\n   */\n  parent;\n\n  /**\n   * Post object which is the root of the whole thread (as specified in the post record).\n   * @type {ATProtoRecord | undefined}\n   */\n  threadRoot;\n\n  /**\n   * Post which is at the top of the (sub)thread currently loaded on the page (might not be the same as threadRoot).\n   * @type {Post | undefined}\n   */\n  pageRoot;\n\n  /**\n   * Info about the author of the \"grandparent\" post. Included only in feedPost views, for the purposes\n   * of feed filtering algorithm.\n   * @type {json | undefined}\n   */\n  grandparentAuthor;\n\n  /**\n   * Depth of the post in the getPostThread response it was loaded from, starting from 0. May be negative.\n   * @type {number | undefined}\n   */\n  level;\n\n  /**\n   * Depth of the post in the whole tree visible on the page (pageRoot's absoluteLevel is 0). May be negative.\n   * @type {number | undefined}\n   */\n  absoluteLevel;\n\n  /**\n   * For posts in feeds and timelines - specifies e.g. that a post was reposted by someone.\n   * @type {object | undefined}\n   */\n  reason;\n\n  /**\n   * True if the post was extracted from inner embed of a quote, not from a #postView.\n   * @type {boolean | undefined}\n   */\n  isEmbed;\n\n  /**\n   * View of a post as part of a thread, as returned from getPostThread.\n   * Expected to be #threadViewPost, but may be blocked or missing.\n   *\n   * @param {json} json\n   * @param {Post?} [pageRoot]\n   * @param {number} [level]\n   * @param {number} [absoluteLevel]\n   * @returns {AnyPost}\n   */\n\n  static parseThreadPost(json, pageRoot = null, level = 0, absoluteLevel = 0) {\n    switch (json.$type) {\n    case 'app.bsky.feed.defs#threadViewPost':\n      let post = new Post(json.post, { level: level, absoluteLevel: absoluteLevel });\n\n      post.pageRoot = pageRoot ?? post;\n\n      if (json.replies) {\n        let replies = json.replies.map(x => Post.parseThreadPost(x, post.pageRoot, level + 1, absoluteLevel + 1));\n        post.setReplies(replies);\n      }\n\n      if (absoluteLevel <= 0 && json.parent) {\n        post.parent = Post.parseThreadPost(json.parent, post.pageRoot, level - 1, absoluteLevel - 1);\n      }\n\n      return post;\n\n    case 'app.bsky.feed.defs#notFoundPost':\n      return new MissingPost(json);\n\n    case 'app.bsky.feed.defs#blockedPost':\n      return new BlockedPost(json);\n\n    default:\n      throw new PostDataError(`Unexpected record type: ${json.$type}`);\n    }\n  }\n\n  /**\n   * View of a post embedded as a quote.\n   * Expected to be app.bsky.embed.record#viewRecord, but may be blocked, missing or a different type of record\n   * (e.g. a list or a feed generator). For unknown record embeds, we fall back to generic ATProtoRecord.\n   *\n   * @param {json} json, @returns {ATProtoRecord}\n   */\n\n  static parseViewRecord(json) {\n    switch (json.$type) {\n    case 'app.bsky.embed.record#viewRecord':\n      return new Post(json, { isEmbed: true });\n\n    case 'app.bsky.embed.record#viewNotFound':\n      return new MissingPost(json);\n\n    case 'app.bsky.embed.record#viewBlocked':\n      return new BlockedPost(json);\n\n    case 'app.bsky.embed.record#viewDetached':\n      return new DetachedQuotePost(json);\n\n    case 'app.bsky.feed.defs#generatorView':\n      return new FeedGeneratorRecord(json);\n\n    case 'app.bsky.graph.defs#listView':\n      return new UserListRecord(json);\n\n    case 'app.bsky.graph.defs#starterPackViewBasic':\n      return new StarterPackRecord(json);\n\n    default:\n      console.warn('Unknown record type:', json.$type);\n      return new ATProtoRecord(json);\n    }\n  }\n\n  /**\n   * View of a post as part of a feed (e.g. a profile feed, home timeline or a custom feed). It should be an\n   * app.bsky.feed.defs#feedViewPost - blocked or missing posts don't appear here, they just aren't included.\n   *\n   * @param {json} json, @returns {Post}\n   */\n\n  static parseFeedPost(json) {\n    let post = new Post(json.post);\n\n    if (json.reply) {\n      post.parent = Post.parsePostView(json.reply.parent);\n      post.threadRoot = Post.parsePostView(json.reply.root);\n\n      if (json.reply.grandparentAuthor) {\n        post.grandparentAuthor = json.reply.grandparentAuthor;\n      }\n    }\n\n    if (json.reason) {\n      post.reason = json.reason;\n    }\n\n    return post;\n  }\n\n /**\n  * Parses a #postView - the inner post object that includes the actual post - but still checks if it's not\n  * a blocked or missing post. The #postView must include a $type.\n  * (This is used for e.g. parent/root of a #feedViewPost.)\n  *\n  * @param {json} json, @returns {AnyPost}\n  */\n\n  static parsePostView(json) {\n    switch (json.$type) {\n    case 'app.bsky.feed.defs#postView':\n      return new Post(json);\n\n    case 'app.bsky.feed.defs#notFoundPost':\n      return new MissingPost(json);\n\n    case 'app.bsky.feed.defs#blockedPost':\n      return new BlockedPost(json);\n\n    default:\n      throw new PostDataError(`Unexpected record type: ${json.$type}`);\n    }\n  }\n\n  /** @param {json} data, @param {json} [extra] */\n\n  constructor(data, extra) {\n    super(data);\n    Object.assign(this, extra ?? {});\n\n    if (this.absoluteLevel === 0) {\n      this.pageRoot = this;\n    }\n\n    this.record = this.isPostView ? data.record : data.value;\n\n    if (this.isPostView && data.embed) {\n      this.embed = Embed.parseInlineEmbed(data.embed);\n    } else if (this.isEmbed && data.embeds && data.embeds[0]) {\n      this.embed = Embed.parseInlineEmbed(data.embeds[0]);\n    } else if (this.record.embed) {\n      this.embed = Embed.parseRawEmbed(this.record.embed);\n    }\n\n    this.author = this.author ?? data.author;\n    this.replies = [];\n\n    this.viewerData = data.viewer;\n    this.viewerLike = data.viewer?.like;\n\n    if (this.author) {\n      api.cacheProfile(this.author);\n    }\n  }\n\n  /** @param {Post} post */\n\n  updateDataFromPost(post) {\n    this.record = post.record;\n    this.embed = post.embed;\n    this.author = post.author;\n    this.replies = post.replies;\n    this.viewerData = post.viewerData;\n    this.viewerLike = post.viewerLike;\n    this.level = post.level;\n    this.absoluteLevel = post.absoluteLevel;\n  }\n\n  /** @param {AnyPost[]} replies */\n\n  setReplies(replies) {\n    this.replies = replies;\n    this.replies.sort(this.sortReplies.bind(this));\n  }\n\n  /** @param {AnyPost} a, @param {AnyPost} b, @returns {-1 | 0 | 1} */\n\n  sortReplies(a, b) {\n    if (a instanceof Post && b instanceof Post) {\n      if (a.author.did == this.author.did && b.author.did != this.author.did) {\n        return -1;\n      } else if (a.author.did != this.author.did && b.author.did == this.author.did) {\n        return 1;\n      } else if (a.text != \"📌\" && b.text == \"📌\") {\n        return -1;\n      } else if (a.text == \"📌\" && b.text != \"📌\") {\n        return 1;\n      } else if (a.createdAt.getTime() < b.createdAt.getTime()) {\n        return -1;\n      } else if (a.createdAt.getTime() > b.createdAt.getTime()) {\n        return 1;\n      } else {\n        return 0;\n      }\n    } else if (a instanceof Post) {\n      return -1;\n    } else if (b instanceof Post) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  /** @returns {boolean} */\n  get isPostView() {\n    return !this.isEmbed;\n  }\n\n  /** @returns {boolean} */\n  get isFediPost() {\n    return this.author?.handle.endsWith('.ap.brid.gy');\n  }\n\n  /** @returns {string | undefined} */\n  get originalFediContent() {\n    return this.record.bridgyOriginalText;\n  }\n\n  /** @returns {string | undefined} */\n  get originalFediURL() {\n    return this.record.bridgyOriginalUrl;\n  }\n\n  /** @returns {boolean} */\n  get isRoot() {\n    // I AM ROOOT\n    return (this.pageRoot === this);\n  }\n\n  /** @returns {string} */\n  get authorFediHandle() {\n    if (this.isFediPost) {\n      return this.author.handle.replace(/\\.ap\\.brid\\.gy$/, '').replace('.', '@');\n    } else {\n      throw \"Not a Fedi post\";\n    }\n  }\n\n  /** @returns {string} */\n  get text() {\n    return this.record.text;\n  }\n\n  /** @returns {string} */\n  get lowercaseText() {\n    if (!this._lowercaseText) {\n      this._lowercaseText = this.record.text.toLowerCase();\n    }\n\n    return this._lowercaseText;\n  }\n\n  /** @returns {json} */\n  get facets() {\n    return this.record.facets;\n  }\n\n  /** @returns {string[] | undefined} */\n  get tags() {\n    return this.record.tags;\n  }\n\n  /** @returns {Date} */\n  get createdAt() {\n    return new Date(this.record.createdAt);\n  }\n\n  /** @returns {number} */\n  get likeCount() {\n    return castToInt(this.data.likeCount);\n  }\n\n  /** @returns {number} */\n  get replyCount() {\n    return castToInt(this.data.replyCount);\n  }\n\n  /** @returns {number} */\n  get quoteCount() {\n    return castToInt(this.data.quoteCount);\n  }\n\n  /** @returns {boolean} */\n  get hasMoreReplies() {\n    let shouldHaveMoreReplies = (this.replyCount !== undefined && this.replyCount > this.replies.length);\n\n    return shouldHaveMoreReplies && (this.replies.length === 0) && (this.level !== undefined && this.level > 4);\n  }\n\n  /** @returns {boolean} */\n  get hasHiddenReplies() {\n    let shouldHaveMoreReplies = (this.replyCount !== undefined && this.replyCount > this.replies.length);\n\n    return shouldHaveMoreReplies && (this.replies.length > 0 || (this.level !== undefined && this.level <= 4));\n  }\n\n  /** @returns {boolean} */\n  get isRestrictingReplies() {\n    return !!(this.data.threadgate && this.data.threadgate.record.allow);\n  }\n\n  /** @returns {number} */\n  get repostCount() {\n    return castToInt(this.data.repostCount);\n  }\n\n  /** @returns {boolean} */\n  get liked() {\n    return (this.viewerLike !== undefined);\n  }\n\n  /** @returns {boolean | undefined} */\n  get muted() {\n    return this.author.viewer?.muted;\n  }\n\n  /** @returns {string | undefined} */\n  get muteList() {\n    return this.author.viewer?.mutedByList?.name;\n  }\n\n  /** @returns {boolean} */\n  get hasViewerInfo() {\n    return (this.viewerData !== undefined);\n  }\n\n  /** @returns {ATProtoRecord | undefined} */\n  get parentReference() {\n    return this.record.reply?.parent && new ATProtoRecord(this.record.reply?.parent);\n  }\n\n  /** @returns {ATProtoRecord | undefined} */\n  get rootReference() {\n    return this.record.reply?.root && new ATProtoRecord(this.record.reply?.root);\n  }\n}\n\n\n/**\n * Post which is blocked for some reason (the author is blocked, the author has blocked you, or there is a block\n * between the post author and the parent author). It only includes a reference, but no post content.\n */\n\nexport class BlockedPost extends ATProtoRecord {\n\n  /** @param {json} data */\n  constructor(data) {\n    super(data);\n    this.author = data.author;\n  }\n\n  /** @returns {boolean} */\n  get blocksUser() {\n    return !!this.author.viewer?.blocking;\n  }\n\n  /** @returns {boolean} */\n  get blockedByUser() {\n    return this.author.viewer?.blockedBy;\n  }\n}\n\n\n/**\n * Stub of a post which was deleted or hidden.\n */\n\nexport class MissingPost extends ATProtoRecord {}\n\n\n/**\n * Stub of a quoted post which was un-quoted by the original author.\n */\n\nexport class DetachedQuotePost extends ATProtoRecord {}\n\n\n/**\n * Record representing a feed generator.\n */\n\nexport class FeedGeneratorRecord extends ATProtoRecord {\n\n  /** @param {json} data */\n  constructor(data) {\n    super(data);\n    this.author = data.creator;\n  }\n\n  /** @returns {string | undefined} */\n  get title() {\n    return this.data.displayName;\n  }\n\n  /** @returns {string | undefined} */\n  get description() {\n    return this.data.description;\n  }\n\n  /** @returns {number} */\n  get likeCount() {\n    return castToInt(this.data.likeCount);\n  }\n\n  /** @returns {string | undefined} */\n  get avatar() {\n    return this.data.avatar;\n  }\n}\n\n\n/**\n * Record representing a user list or moderation list.\n */\n\nexport class UserListRecord extends ATProtoRecord {\n\n  /** @param {json} data */\n  constructor(data) {\n    super(data);\n    this.author = data.creator;\n  }\n\n  /** @returns {string | undefined} */\n  get title() {\n    return this.data.name;\n  }\n\n  /** @returns {string | undefined} */\n  get purpose() {\n    return this.data.purpose;\n  }\n\n  /** @returns {string | undefined} */\n  get description() {\n    return this.data.description;\n  }\n\n  /** @returns {string | undefined} */\n  get avatar() {\n    return this.data.avatar;\n  }\n}\n\n\n/**\n * Record representing a starter pack.\n */\n\nexport class StarterPackRecord extends ATProtoRecord {\n\n  /** @param {json} data */\n  constructor(data) {\n    super(data);\n    this.author = data.creator;\n  }\n\n  /** @returns {string | undefined} */\n  get title() {\n    return this.data.record.name;\n  }\n\n  /** @returns {string | undefined} */\n  get description() {\n    return this.data.record.description;\n  }\n}\n\n\n/**\n * Base class for embed objects.\n */\n\nexport class Embed {\n\n  /**\n   * More hydrated view of an embed, taken from a full post view (#postView).\n   *\n   * @param {json} json, @returns {Embed}\n   */\n\n  static parseInlineEmbed(json) {\n    switch (json.$type) {\n    case 'app.bsky.embed.record#view':\n      return new InlineRecordEmbed(json);\n\n    case 'app.bsky.embed.recordWithMedia#view':\n      return new InlineRecordWithMediaEmbed(json);\n\n    case 'app.bsky.embed.images#view':\n      return new InlineImageEmbed(json);\n\n    case 'app.bsky.embed.external#view':\n      return new InlineLinkEmbed(json);\n\n    case 'app.bsky.embed.video#view':\n      return new InlineVideoEmbed(json);\n\n    default:\n      if (location.protocol == 'file:') {\n        throw new PostDataError(`Unexpected embed type: ${json.$type}`);\n      } else {\n        console.warn('Unexpected embed type:', json.$type);\n        return new Embed(json);\n      }\n    }\n  }\n\n  /**\n    * Raw embed extracted from raw record data of a post. Does not include quoted post contents.\n    *\n    * @param {json} json, @returns {Embed}\n    */\n\n  static parseRawEmbed(json) {\n    switch (json.$type) {\n    case 'app.bsky.embed.record':\n      return new RawRecordEmbed(json);\n\n    case 'app.bsky.embed.recordWithMedia':\n      return new RawRecordWithMediaEmbed(json);\n\n    case 'app.bsky.embed.images':\n      return new RawImageEmbed(json);\n\n    case 'app.bsky.embed.external':\n      return new RawLinkEmbed(json);\n\n    case 'app.bsky.embed.video':\n      return new RawVideoEmbed(json);\n\n    default:\n      if (location.protocol == 'file:') {\n        throw new PostDataError(`Unexpected embed type: ${json.$type}`);\n      } else {\n        console.warn('Unexpected embed type:', json.$type);\n        return new Embed(json);\n      }\n    }\n  }\n\n  /** @param {json} json */\n  constructor(json) {\n    this.json = json;\n  }\n\n  /** @returns {string} */\n  get type() {\n    return this.json.$type;\n  }\n}\n\nexport class RawImageEmbed extends Embed {\n\n  /** @param {json} json */\n  constructor(json) {\n    super(json);\n    this.images = json.images;\n  }\n}\n\nexport class RawLinkEmbed extends Embed {\n\n  /** @param {json} json */\n  constructor(json) {\n    super(json);\n\n    this.url = json.external.uri;\n    this.title = json.external.title;\n    this.thumb = json.external.thumb;\n  }\n}\n\nexport class RawVideoEmbed extends Embed {\n\n  /** @param {json} json */\n  constructor(json) {\n    super(json);\n    this.video = json.video;\n  }\n}\n\nexport class RawRecordEmbed extends Embed {\n\n  /** @param {json} json */\n  constructor(json) {\n    super(json);\n    this.record = new ATProtoRecord(json.record);\n  }\n}\n\nexport class RawRecordWithMediaEmbed extends Embed {\n\n  /** @param {json} json */\n  constructor(json) {\n    super(json);\n    this.record = new ATProtoRecord(json.record.record);\n    this.media = Embed.parseRawEmbed(json.media);\n  }\n}\n\nexport class InlineRecordEmbed extends Embed {\n\n  /**\n   * app.bsky.embed.record#view\n   * @param {json} json\n   */\n  constructor(json) {\n    super(json);\n    this.post = Post.parseViewRecord(json.record);\n  }\n}\n\nexport class InlineRecordWithMediaEmbed extends Embed {\n\n  /**\n   * app.bsky.embed.recordWithMedia#view\n   * @param {json} json\n   */\n  constructor(json) {\n    super(json);\n    this.post = Post.parseViewRecord(json.record.record);\n    this.media = Embed.parseInlineEmbed(json.media);\n  }\n}\n\nexport class InlineLinkEmbed extends Embed {\n\n  /**\n   * app.bsky.embed.external#view\n   * @param {json} json\n   */\n  constructor(json) {\n    super(json);\n\n    this.url = json.external.uri;\n    this.title = json.external.title;\n    this.description = json.external.description;\n    this.thumb = json.external.thumb;\n  }\n}\n\nexport class InlineImageEmbed extends Embed {\n\n  /**\n   * app.bsky.embed.images#view\n   * @param {json} json\n   */\n  constructor(json) {\n    super(json);\n    this.images = json.images;\n  }\n}\n\nexport class InlineVideoEmbed extends Embed {\n\n  /**\n   * app.bsky.embed.video#view\n   * @param {json} json\n   */\n  constructor(json) {\n    super(json);\n    this.playlistURL = json.playlist;\n    this.alt = json.alt;\n  }\n}\n",
    "import { AuthError, Minisky } from './minisky.js';\nimport { atURI, feedPostTime } from './utils.js';\nimport { Post } from './models.js';\n\n/**\n * Thrown when the response is technically a \"success\" one, but the returned data is not what it should be.\n */\n\nexport class ResponseDataError extends Error {}\n\n\n/**\n * Thrown when the passed URL is not a supported post URL on bsky.app.\n */\n\nexport class URLError extends Error {\n\n  /** @param {string} message */\n  constructor(message) {\n    super(message);\n  }\n}\n\n\n/**\n * Caches the mapping of handles to DIDs to avoid unnecessary API calls to resolveHandle or getProfile.\n */\n\nclass HandleCache {\n  prepareCache() {\n    if (!this.cache) {\n      this.cache = JSON.parse(localStorage.getItem('handleCache') ?? '{}');\n    }\n  }\n\n  saveCache() {\n    localStorage.setItem('handleCache', JSON.stringify(this.cache));\n  }\n\n  /** @param {string} handle, @returns {string | undefined}  */\n\n  getHandleDid(handle) {\n    this.prepareCache();\n    return this.cache[handle];\n  }\n\n  /** @param {string} handle, @param {string} did */\n\n  setHandleDid(handle, did) {\n    this.prepareCache();\n    this.cache[handle] = did;\n    this.saveCache();\n  }\n\n  /** @param {string} did, @returns {string | undefined}  */\n\n  findHandleByDid(did) {\n    this.prepareCache();\n    let found = Object.entries(this.cache).find((e) => e[1] == did);\n    return found ? found[0] : undefined;\n  }\n}\n\n\n/**\n * Stores user's access tokens and data in local storage after they log in.\n */\n\nclass LocalStorageConfig {\n  constructor() {\n    let data = localStorage.getItem('userData');\n    this.user = data ? JSON.parse(data) : {};\n  }\n\n  save() {\n    if (this.user) {\n      localStorage.setItem('userData', JSON.stringify(this.user));\n    } else {\n      localStorage.removeItem('userData');\n    }\n  }\n}\n\n\n/**\n * API client for connecting to the Bluesky XRPC API (authenticated or not).\n */\n\nexport class BlueskyAPI extends Minisky {\n\n  /** @param {string | undefined} host, @param {boolean} useAuthentication */\n  constructor(host, useAuthentication) {\n    super(host, useAuthentication ? new LocalStorageConfig() : undefined);\n\n    this.handleCache = new HandleCache();\n    this.profiles = {};\n  }\n\n  /** @param {json} author */\n\n  cacheProfile(author) {\n    this.profiles[author.did] = author;\n    this.profiles[author.handle] = author;\n    this.handleCache.setHandleDid(author.handle, author.did);\n  }\n\n  /** @param {string} did, @returns {string | undefined} */\n\n  findHandleByDid(did) {\n    return this.handleCache.findHandleByDid(did);\n  }\n\n  /** @param {string} did, @returns {Promise<string>} */\n\n  async fetchHandleForDid(did) {\n    let cachedHandle = this.handleCache.findHandleByDid(did);\n\n    if (cachedHandle) {\n      return cachedHandle;\n    } else {\n      let author = await this.loadUserProfile(did);\n      return author.handle;\n    }\n  }\n\n  /** @param {string} string, @returns {[string, string]} */\n\n  static parsePostURL(string) {\n    let url;\n\n    try {\n      url = new URL(string);\n    } catch (error) {\n      throw new URLError(`${error}`);\n    }\n\n    if (url.protocol != 'https:' && url.protocol != 'http:') {\n      throw new URLError('URL must start with http(s)://');\n    }\n\n    let parts = url.pathname.split('/');\n\n    if (parts.length < 5 || parts[1] != 'profile' || parts[3] != 'post') {\n      throw new URLError('This is not a valid thread URL');\n    }\n\n    let handle = parts[2];\n    let postId = parts[4];\n\n    return [handle, postId];\n  }\n\n  /** @param {string} handle, @returns {Promise<string>} */\n\n  async resolveHandle(handle) {\n    let cachedDid = this.handleCache.getHandleDid(handle);\n\n    if (cachedDid) {\n      return cachedDid;\n    } else {\n      let json = await this.getRequest('com.atproto.identity.resolveHandle', { handle }, { auth: false });\n      let did = json['did'];\n\n      if (did) {\n        this.handleCache.setHandleDid(handle, did);\n        return did;\n      } else {\n        throw new ResponseDataError('Missing DID in response: ' + JSON.stringify(json));\n      }\n    }\n  }\n\n  /** @param {string} url, @returns {Promise<json>} */\n\n  async loadThreadByURL(url) {\n    let [handle, postId] = BlueskyAPI.parsePostURL(url);\n    return await this.loadThreadById(handle, postId);\n  }\n\n  /** @param {string} author, @param {string} postId, @returns {Promise<json>} */\n\n  async loadThreadById(author, postId) {\n    let did = author.startsWith('did:') ? author : await this.resolveHandle(author);\n    let postURI = `at://${did}/app.bsky.feed.post/${postId}`;\n    return await this.loadThreadByAtURI(postURI);\n  }\n\n  /** @param {string} uri, @returns {Promise<json>} */\n\n  async loadThreadByAtURI(uri) {\n    return await this.getRequest('app.bsky.feed.getPostThread', { uri: uri, depth: 10 });\n  }\n\n  /** @param {string} handle, @returns {Promise<json>} */\n\n  async loadUserProfile(handle) {\n    if (this.profiles[handle]) {\n      return this.profiles[handle];\n    } else {\n      let profile = await this.getRequest('app.bsky.actor.getProfile', { actor: handle });\n      this.cacheProfile(profile);\n      return profile;\n    }\n  }\n\n  /** @param {string} query, @returns {Promise<json[]>} */\n\n  async autocompleteUsers(query) {\n    let json = await this.getRequest('app.bsky.actor.searchActorsTypeahead', { q: query });\n    return json.actors;\n  }\n\n  /** @returns {Promise<json | undefined>} */\n\n  async getCurrentUserAvatar() {\n    let json = await this.getRequest('com.atproto.repo.getRecord', {\n      repo: this.user.did,\n      collection: 'app.bsky.actor.profile',\n      rkey: 'self'\n    });\n\n    return json.value.avatar;\n  }\n\n  /** @returns {Promise<string?>} */\n\n  async loadCurrentUserAvatar() {\n    if (!this.config || !this.config.user) {\n      throw new AuthError(\"User isn't logged in\");\n    }\n\n    let avatar = await this.getCurrentUserAvatar();\n\n    if (avatar) {\n      let url = `https://cdn.bsky.app/img/avatar/plain/${this.user.did}/${avatar.ref.$link}@jpeg`;\n      this.config.user.avatar = url;\n      this.config.save();\n      return url;\n    } else {\n      return null;\n    }\n  }\n\n  /** @param {string} uri, @returns {Promise<string[]>} */\n\n  async getReplies(uri) {\n    let json = await this.getRequest('blue.feeds.post.getReplies', { uri });\n    return json.replies;\n  }\n\n  /** @param {string} uri, @returns {Promise<number>} */\n\n  async getQuoteCount(uri) {\n    let json = await this.getRequest('blue.feeds.post.getQuoteCount', { uri });\n    return json.quoteCount;\n  }\n\n  /** @param {string} url, @param {string | undefined} cursor, @returns {Promise<json>} */\n\n  async getQuotes(url, cursor = undefined) {\n    let postURI;\n\n    if (url.startsWith('at://')) {\n      postURI = url;\n    } else {\n      let [handle, postId] = BlueskyAPI.parsePostURL(url);\n      let did = handle.startsWith('did:') ? handle : await appView.resolveHandle(handle);\n      postURI = `at://${did}/app.bsky.feed.post/${postId}`;\n    }\n\n    let params = { uri: postURI };\n\n    if (cursor) {\n      params['cursor'] = cursor;\n    }\n\n    return await this.getRequest('blue.feeds.post.getQuotes', params);\n  }\n\n  /** @param {string} hashtag, @param {string | undefined} cursor, @returns {Promise<json>} */\n\n  async getHashtagFeed(hashtag, cursor = undefined) {\n    let params = { q: '#' + hashtag, limit: 50, sort: 'latest' };\n\n    if (cursor) {\n      params['cursor'] = cursor;\n    }\n\n    return await this.getRequest('app.bsky.feed.searchPosts', params);\n  }\n\n  /** @param {json} [params], @returns {Promise<json>} */\n\n  async loadNotifications(params) {\n    return await this.getRequest('app.bsky.notification.listNotifications', params || {});\n  }\n\n  /**\n   * @param {string} [cursor]\n   * @returns {Promise<{ cursor: string | undefined, posts: json[] }>}\n   */\n\n  async loadMentions(cursor) {\n    let response = await this.loadNotifications({ cursor: cursor ?? '', limit: 100, reasons: ['reply', 'mention'] });\n    let uris = response.notifications.map(x => x.uri);\n    let batches = [];\n\n    for (let i = 0; i < uris.length; i += 25) {\n      let batch = this.loadPosts(uris.slice(i, i + 25));\n      batches.push(batch);\n    }\n\n    let postGroups = await Promise.all(batches);\n\n    return { cursor: response.cursor, posts: postGroups.flat() };\n  }\n\n  /**\n   * @param {number} days\n   * @param {{ onPageLoad?: FetchAllOnPageLoad, keepLastPage?: boolean }} [options]\n   * @returns {Promise<json[]>}\n   */\n\n  async loadHomeTimeline(days, options = {}) {\n    let now = new Date();\n    let timeLimit = now.getTime() - days * 86400 * 1000;\n\n    return await this.fetchAll('app.bsky.feed.getTimeline', {\n      params: { limit: 100 },\n      field: 'feed',\n      breakWhen: (x) => (feedPostTime(x) < timeLimit),\n      onPageLoad: options.onPageLoad,\n      keepLastPage: options.keepLastPage\n    });\n  }\n\n  /**\n    @typedef\n    {'posts_with_replies' | 'posts_no_replies' | 'posts_and_author_threads' | 'posts_with_media' | 'posts_with_video'}\n    AuthorFeedFilter\n\n    Filters:\n    - posts_with_replies: posts, replies and reposts (default)\n    - posts_no_replies: posts and reposts (no replies)\n    - posts_and_author_threads: posts, reposts, and replies in your own threads\n    - posts_with_media: posts and replies, but only with images (no reposts)\n    - posts_with_video: posts and replies, but only with videos (no reposts)\n  */\n\n  /**\n   * @param {string} did\n   * @param {number} days\n   * @param {{ filter: AuthorFeedFilter, onPageLoad?: FetchAllOnPageLoad, keepLastPage?: boolean }} options\n   * @returns {Promise<json[]>}\n   */\n\n  async loadUserTimeline(did, days, options) {\n    let now = new Date();\n    let timeLimit = now.getTime() - days * 86400 * 1000;\n\n    return await this.fetchAll('app.bsky.feed.getAuthorFeed', {\n      params: {\n        actor: did,\n        filter: options.filter,\n        limit: 100\n      },\n      field: 'feed',\n      breakWhen: (x) => (feedPostTime(x) < timeLimit),\n      onPageLoad: options.onPageLoad,\n      keepLastPage: options.keepLastPage\n    });\n  }\n\n  /** @returns {Promise<json[]>} */\n\n  async loadUserLists() {\n    let lists = await this.fetchAll('app.bsky.graph.getLists', {\n      params: {\n        actor: this.user.did,\n        limit: 100\n      },\n      field: 'lists'\n    });\n\n    return lists.filter(x => x.purpose == \"app.bsky.graph.defs#curatelist\");\n  }\n\n  /**\n   * @param {string} list\n   * @param {number} days\n   * @param {{ onPageLoad?: FetchAllOnPageLoad, keepLastPage?: boolean }} [options]\n   * @returns {Promise<json[]>}\n   */\n\n  async loadListTimeline(list, days, options = {}) {\n    let now = new Date();\n    let timeLimit = now.getTime() - days * 86400 * 1000;\n\n    return await this.fetchAll('app.bsky.feed.getListFeed', {\n      params: {\n        list: list,\n        limit: 100\n      },\n      field: 'feed',\n      breakWhen: (x) => (feedPostTime(x) < timeLimit),\n      onPageLoad: options.onPageLoad,\n      keepLastPage: options.keepLastPage\n    });\n  }\n\n  /** @param {string} postURI, @returns {Promise<json>} */\n\n  async loadPost(postURI) {\n    let posts = await this.loadPosts([postURI]);\n\n    if (posts.length == 1) {\n      return posts[0];\n    } else {\n      throw new ResponseDataError('Post not found');\n    }\n  }\n\n  /** @param {string} postURI, @returns {Promise<json | undefined>} */\n\n  async loadPostIfExists(postURI) {\n    let posts = await this.loadPosts([postURI]);\n    return posts[0];\n  }\n\n  /** @param {string[]} uris, @returns {Promise<object[]>} */\n\n  async loadPosts(uris) {\n    if (uris.length > 0) {\n      let response = await this.getRequest('app.bsky.feed.getPosts', { uris });\n      return response.posts;\n    } else {\n      return [];\n    }\n  }\n\n  /** @param {Post} post, @returns {Promise<json>} */\n\n  async likePost(post) {\n    return await this.postRequest('com.atproto.repo.createRecord', {\n      repo: this.user.did,\n      collection: 'app.bsky.feed.like',\n      record: {\n        subject: {\n          uri: post.uri,\n          cid: post.cid\n        },\n        createdAt: new Date().toISOString()\n      }\n    });\n  }\n\n  /** @param {string} uri, @returns {Promise<void>} */\n\n  async removeLike(uri) {\n    let { rkey } = atURI(uri);\n\n    await this.postRequest('com.atproto.repo.deleteRecord', {\n      repo: this.user.did,\n      collection: 'app.bsky.feed.like',\n      rkey: rkey\n    });\n  }\n\n  resetTokens() {\n    delete this.user.avatar;\n    super.resetTokens();\n  }\n}\n",
    "// @ts-nocheck\n/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */\n\nconst {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor\n} = Object;\nlet {\n  freeze,\n  seal,\n  create\n} = Object; // eslint-disable-line import/no-mutable-exports\nlet {\n  apply,\n  construct\n} = typeof Reflect !== 'undefined' && Reflect;\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\nif (!apply) {\n  apply = function apply(func, thisArg) {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n    return func.apply(thisArg, args);\n  };\n}\nif (!construct) {\n  construct = function construct(Func) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n    return new Func(...args);\n  };\n}\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySplice = unapply(Array.prototype.splice);\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\nconst regExpTest = unapply(RegExp.prototype.test);\nconst typeErrorCreate = unconstruct(TypeError);\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return function (thisArg) {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n    return apply(func, thisArg, args);\n  };\n}\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(Func) {\n  return function () {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n    return construct(Func, args);\n  };\n}\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(set, array) {\n  let transformCaseFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n        element = lcElement;\n      }\n    }\n    set[element] = true;\n  }\n  return set;\n}\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n  return array;\n}\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (value && typeof value === 'object' && value.constructor === Object) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n  return newObject;\n}\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n    object = getPrototypeOf(object);\n  }\n  function fallbackValue() {\n    return null;\n  }\n  return fallbackValue;\n}\n\nconst html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'search', 'section', 'select', 'shadow', 'slot', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\nconst svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'enterkeyhint', 'exportparts', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'inputmode', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'part', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nconst svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nconst svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nconst mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']);\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nconst mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nconst text = freeze(['#text']);\n\nconst html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'exportparts', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inert', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'part', 'pattern', 'placeholder', 'playsinline', 'popover', 'popovertarget', 'popovertargetaction', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'slot', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'wrap', 'xmlns', 'slot']);\nconst svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'amplitude', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'exponent', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'intercept', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'mask-type', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'slope', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'tablevalues', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nconst mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nconst xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n// eslint-disable-next-line unicorn/better-regex\nconst MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nconst ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nconst TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nconst DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nconst ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nconst IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nconst IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nconst ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nconst DOCTYPE_NAME = seal(/^html$/i);\nconst CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n\nvar EXPRESSIONS = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ARIA_ATTR: ARIA_ATTR,\n  ATTR_WHITESPACE: ATTR_WHITESPACE,\n  CUSTOM_ELEMENT: CUSTOM_ELEMENT,\n  DATA_ATTR: DATA_ATTR,\n  DOCTYPE_NAME: DOCTYPE_NAME,\n  ERB_EXPR: ERB_EXPR,\n  IS_ALLOWED_URI: IS_ALLOWED_URI,\n  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n  MUSTACHE_EXPR: MUSTACHE_EXPR,\n  TMPLIT_EXPR: TMPLIT_EXPR\n});\n\n/* eslint-disable @typescript-eslint/indent */\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5,\n  // Deprecated\n  entityNode: 6,\n  // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12 // Deprecated\n};\nconst getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  }\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\nconst _createHooksMap = function _createHooksMap() {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: []\n  };\n};\nfunction createDOMPurify() {\n  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n  const DOMPurify = root => createDOMPurify(root);\n  DOMPurify.version = '3.3.0';\n  DOMPurify.removed = [];\n  if (!window || !window.document || window.document.nodeType !== NODE_TYPE.document || !window.Element) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n  let {\n    document\n  } = window;\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes\n  } = window;\n  const ElementPrototype = Element.prototype;\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName\n  } = document;\n  const {\n    importNode\n  } = originalDocument;\n  let hooks = _createHooksMap();\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT\n  } = EXPRESSIONS;\n  let {\n    IS_ALLOWED_URI: IS_ALLOWED_URI$1\n  } = EXPRESSIONS;\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n  /* Config object to store ADD_TAGS/ADD_ATTR functions (when used as functions) */\n  const EXTRA_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    }\n  }));\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n  const formElement = document.createElement('form');\n  const isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function _parseConfig() {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE =\n    // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS') ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR') ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES') ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR') ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR, transformCaseFunc) : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS') ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS, transformCaseFunc) : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS') ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS') ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : clone({});\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR') ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : clone({});\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES') ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS = cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS = cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (typeof cfg.ADD_TAGS === 'function') {\n        EXTRA_ELEMENT_HANDLING.tagCheck = cfg.ADD_TAGS;\n      } else {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n      }\n    }\n    if (cfg.ADD_ATTR) {\n      if (typeof cfg.ADD_ATTR === 'function') {\n        EXTRA_ELEMENT_HANDLING.attributeCheck = cfg.ADD_ATTR;\n      } else {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n      }\n    }\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n      }\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n      }\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n      }\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n    CONFIG = cfg;\n  };\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);\n  const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function _checkValidNamespace(element) {\n    let parent = getParentNode(element);\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template'\n      };\n    }\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      }\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    }\n    // For XHTML and XML documents that support custom namespaces\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return true;\n    }\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function _removeAttribute(name, element) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element\n      });\n    }\n    element.removeAttribute(name);\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n    const body = doc.body || doc.documentElement;\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function _createNodeIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root,\n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION, null);\n  };\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function _isClobbered(element) {\n    return element instanceof HTMLFormElement && (typeof element.nodeName !== 'string' || typeof element.textContent !== 'string' || typeof element.removeChild !== 'function' || !(element.attributes instanceof NamedNodeMap) || typeof element.removeAttribute !== 'function' || typeof element.setAttribute !== 'function' || typeof element.namespaceURI !== 'string' || typeof element.insertBefore !== 'function' || typeof element.hasChildNodes !== 'function');\n  };\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function _isNode(value) {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n  function _executeHooks(hooks, currentNode, data) {\n    arrayForEach(hooks, hook => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function _sanitizeElements(currentNode) {\n    let content = null;\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (SAFE_FOR_XML && currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\\w!]/g, currentNode.innerHTML) && regExpTest(/<[/\\w!]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any kind of possibly harmful comments */\n    if (SAFE_FOR_XML && currentNode.nodeType === NODE_TYPE.comment && regExpTest(/<[/\\w]/g, currentNode.data)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove element if anything forbids its presence */\n    if (!(EXTRA_ELEMENT_HANDLING.tagCheck instanceof Function && EXTRA_ELEMENT_HANDLING.tagCheck(tagName)) && (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName])) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {\n          return false;\n        }\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {\n          return false;\n        }\n      }\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        content = stringReplace(content, expr, ' ');\n      });\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n    return false;\n  };\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (EXTRA_ELEMENT_HANDLING.attributeCheck instanceof Function && EXTRA_ELEMENT_HANDLING.attributeCheck(lcName, lcTag)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n      // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName, lcTag)) ||\n      // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n      return false;\n    } else ;\n    return true;\n  };\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function _isBasicCustomElement(tagName) {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n    const {\n      attributes\n    } = currentNode;\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined\n    };\n    let l = attributes.length;\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const {\n        name,\n        namespaceURI,\n        value: attrValue\n      } = attr;\n      const lcName = transformCaseFunc(name);\n      const initValue = attrValue;\n      let value = name === 'value' ? initValue : stringTrim(initValue);\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n      /* Work around a security issue with comments inside attributes */\n      if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\\/(style|title|textarea)/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Make sure we cannot easily use animated hrefs, even if animations are allowed */\n      if (lcName === 'attributename' && stringMatch(value, 'href')) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Handle attributes that require Trusted Types */\n      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              {\n                value = trustedTypesPolicy.createHTML(value);\n                break;\n              }\n            case 'TrustedScriptURL':\n              {\n                value = trustedTypesPolicy.createScriptURL(value);\n                break;\n              }\n          }\n        }\n      }\n      /* Handle invalid data-* attribute set by try-catching it */\n      if (value !== initValue) {\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n          if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n          } else {\n            arrayPop(DOMPurify.removed);\n          }\n        } catch (_) {\n          _removeAttribute(name, currentNode);\n        }\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty) {\n    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === NODE_TYPE.element && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n      // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n    /* Now start iterating over the created document */\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n      return returnNode;\n    }\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    /* Serialize doctype if allowed */\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n  DOMPurify.setConfig = function () {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n  DOMPurify.removeHook = function (entryPoint, hookFunction) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n      return index === -1 ? undefined : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n    return arrayPop(hooks[entryPoint]);\n  };\n  DOMPurify.removeHooks = function (entryPoint) {\n    hooks[entryPoint] = [];\n  };\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n  return DOMPurify;\n}\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.mjs.map\n",
    "import { URLError } from './api.js';\nimport DOMPurify from './lib/purify.es.mjs';\nimport { Post } from './models.js';\n\nexport class AtURI {\n  /** @param {string} uri */\n  constructor(uri) {\n    if (!uri.startsWith('at://')) {\n      throw new URLError(`Not an at:// URI: ${uri}`);\n    }\n\n    let parts = uri.split('/');\n\n    if (parts.length != 5) {\n      throw new URLError(`Invalid at:// URI: ${uri}`);\n    }\n\n    this.repo = parts[2];\n    this.collection = parts[3];\n    this.rkey = parts[4];\n  }\n}\n\n/**\n * @typedef {object} PaginatorType\n * @property {(callback: (boolean) => void) => void} loadInPages\n * @property {(() => void)=} scrollHandler\n * @property {ResizeObserver=} resizeObserver\n */\n\nexport const Paginator = {\n  loadInPages(callback) {\n    if (this.scrollHandler) {\n      document.removeEventListener('scroll', this.scrollHandler);\n    }\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n    }\n\n    let loadIfNeeded = () => {\n      if (window.pageYOffset + window.innerHeight > document.body.offsetHeight - 500) {\n        callback(loadIfNeeded);\n      }\n    };\n\n    callback(loadIfNeeded);\n\n    document.addEventListener('scroll', loadIfNeeded);\n    const resizeObserver = new ResizeObserver(loadIfNeeded);\n    resizeObserver.observe(document.body);\n\n    this.scrollHandler = loadIfNeeded;\n    this.resizeObserver = resizeObserver;\n  }\n};\n\n/**\n * @template {HTMLElement} T\n * @param {string} name\n * @param {new (...args: any[]) => T} [type]\n * @returns {T}\n */\n\nexport function $id(name, type) {\n  return /** @type {T} */ (document.getElementById(name));\n}\n\n/**\n * @template {HTMLElement} T\n * @param {Node | EventTarget | null} element\n * @param {new (...args: any[]) => T} [type]\n * @returns {T}\n */\n\nexport function $(element, type) {\n  return /** @type {T} */ (element);\n}\n\n/** @param {string} uri, @returns {AtURI} */\n\nexport function atURI(uri) {\n  return new AtURI(uri);\n}\n\nexport function castToInt(value) {\n  if (value === undefined || value === null || typeof value == \"number\") {\n    return value;\n  } else {\n    return parseInt(value, 10);\n  }\n}\n\n/** @param {string} html, @returns {string} */\n\nexport function escapeHTML(html) {\n  return html.replace(/&/g, '&amp;')\n             .replace(/</g, '&lt;')\n             .replace(/>/g,'&gt;');\n}\n\n/** @param {json} feedPost, @returns {number} */\n\nexport function feedPostTime(feedPost) {\n  let timestamp = feedPost.reason ? feedPost.reason.indexedAt : feedPost.post.record.createdAt;\n  return Date.parse(timestamp);\n}\n\n/** @param {string} html, @returns {string} */\n\nexport function sanitizeHTML(html) {\n  return DOMPurify.sanitize(html, {\n    ALLOWED_TAGS: [\n      'a', 'b', 'blockquote', 'br', 'code', 'dd', 'del', 'div', 'dl', 'dt', 'em', 'font',\n      'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'li', 'ol', 'p', 'q', 'pre', 's', 'span', 'strong',\n      'sub', 'sup', 'u', 'wbr', '#text'\n    ],\n    ALLOWED_ATTR: [\n      'align', 'alt', 'class', 'clear', 'color', 'dir', 'href', 'lang', 'rel', 'title', 'translate'\n    ]\n  });\n}\n\n/** @returns {string} */\n\nexport function getLocation() {\n  return location.origin + location.pathname;\n}\n\n/** @param {object} error */\n\nexport function showError(error) {\n  console.log(error);\n  alert(error);\n}\n\n/** @param {Date} date1, @param {Date} date2, @returns {boolean} */\n\nexport function sameDay(date1, date2) {\n  return (\n    date1.getDate() == date2.getDate() &&\n    date1.getMonth() == date2.getMonth() &&\n    date1.getFullYear() == date2.getFullYear()\n  );\n}\n\n/** @param {Post} post, @returns {string} */\n\nexport function linkToPostThread(post) {\n  return linkToPostById(post.author.handle, post.rkey);\n}\n\n/** @param {string} handle, @param {string} postId, @returns {string} */\n\nexport function linkToPostById(handle, postId) {\n  let url = new URL(getLocation());\n  url.searchParams.set('author', handle);\n  url.searchParams.set('post', postId);\n  return url.toString();\n}\n",
    "export function $tag<T extends HTMLElement>(\n  tag: string,\n  params?: string | object | (new (...args: any[]) => T),\n  type?: new (...args: any[]) => T\n): T {\n  let element;\n  let parts = tag.split('.');\n\n  if (parts.length > 1) {\n    let tagName = parts[0];\n    element = document.createElement(tagName);\n    element.className = parts.slice(1).join(' ');\n  } else {\n    element = document.createElement(tag);\n  }\n\n  if (typeof params === 'string') {\n    element.className = element.className + ' ' + params;\n  } else if (params) {\n    for (let key in params) {\n      if (key == 'text') {\n        element.innerText = params[key];\n      } else if (key == 'html') {\n        element.innerHTML = params[key];\n      } else {\n        element[key] = params[key];\n      }\n    }\n  }\n\n  return element;\n}\n",
    "import { atURI } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { PostComponent } from './post_component.js';\n\nimport {\n  Post, BlockedPost, MissingPost, DetachedQuotePost, Embed,\n  RawRecordEmbed, RawRecordWithMediaEmbed, RawImageEmbed, RawLinkEmbed, RawVideoEmbed,\n  InlineRecordEmbed, InlineRecordWithMediaEmbed, InlineImageEmbed, InlineLinkEmbed, InlineVideoEmbed,\n  FeedGeneratorRecord, StarterPackRecord, UserListRecord\n} from './models.js';\n\n/**\n * Renders an embed (e.g. image or quoted post) inside the post view.\n */\n\nexport class EmbedComponent {\n\n  /** @param {Post} post, @param {Embed} embed */\n  constructor(post, embed) {\n    this.post = post;\n    this.embed = embed;\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildElement() {\n    if (this.embed instanceof RawRecordEmbed) {\n      let quoteView = this.quotedPostPlaceholder();\n      this.loadQuotedPost(this.embed.record.uri, quoteView);\n      return quoteView;\n\n    } else if (this.embed instanceof RawRecordWithMediaEmbed) {\n      let wrapper = $tag('div');\n\n      let mediaView = new EmbedComponent(this.post, this.embed.media).buildElement();\n      let quoteView = this.quotedPostPlaceholder();\n      this.loadQuotedPost(this.embed.record.uri, quoteView);\n\n      wrapper.append(mediaView, quoteView);\n      return wrapper;\n\n    } else if (this.embed instanceof InlineRecordEmbed) {\n      return this.buildQuotedPostElement(this.embed);\n\n    } else if (this.embed instanceof InlineRecordWithMediaEmbed) {\n      let wrapper = $tag('div');\n\n      let mediaView = new EmbedComponent(this.post, this.embed.media).buildElement();\n      let quoteView = this.buildQuotedPostElement(this.embed);\n\n      wrapper.append(mediaView, quoteView);\n      return wrapper;\n\n    } else if (this.embed instanceof RawImageEmbed || this.embed instanceof InlineImageEmbed) {\n      return this.buildImagesComponent(this.embed);\n\n    } else if (this.embed instanceof RawLinkEmbed || this.embed instanceof InlineLinkEmbed) {\n      return this.buildLinkComponent(this.embed);\n\n    } else if (this.embed instanceof RawVideoEmbed || this.embed instanceof InlineVideoEmbed) {\n      return this.buildVideoComponent(this.embed);\n\n    } else {\n      return $tag('p', { text: `[${this.embed.type}]` });\n    }\n  }\n\n  /** @returns {HTMLElement} */\n\n  quotedPostPlaceholder() {\n    return $tag('div.quote-embed', {\n      html: '<p class=\"post placeholder\">Loading quoted post...</p>'\n    });\n  }\n\n  /** @param {InlineRecordEmbed | InlineRecordWithMediaEmbed} embed, @returns {HTMLElement} */\n\n  buildQuotedPostElement(embed) {\n    let div = $tag('div.quote-embed');\n\n    if ([Post, BlockedPost, MissingPost, DetachedQuotePost].some(c => embed.post instanceof c)) {\n      let postView = new PostComponent(embed.post, 'quote').buildElement();\n      div.appendChild(postView);\n\n    } else if (embed.post instanceof FeedGeneratorRecord) {\n      return this.buildFeedGeneratorView(embed.post);\n\n    } else if (embed.post instanceof UserListRecord) {\n      return this.buildUserListView(embed.post);\n\n    } else if (embed.post instanceof StarterPackRecord) {\n      return this.buildStarterPackView(embed.post);\n\n    } else {\n      let p = $tag('p', { text: `[${embed.post.type}]` });\n      div.appendChild(p);\n    }\n\n    return div;\n  }\n\n  /** @params {RawLinkEmbed | InlineLinkEmbed} embed, @returns {HTMLElement} */\n\n  buildLinkComponent(embed) {\n    let hostname;\n\n    try {\n      hostname = new URL(embed.url).hostname;\n    } catch (error) {\n      console.log(\"Invalid URL:\" + error);\n\n      let a = $tag('a', { href: embed.url, text: embed.title || embed.url });\n      let p = $tag('p');\n      p.append('[Link: ', a, ']');\n      return p;\n    }\n\n    let a = $tag('a.link-card', { href: embed.url, target: '_blank' });\n    let box = $tag('div');\n\n    let domain = $tag('p.domain', { text: hostname });\n    let title = $tag('h2', { text: embed.title || embed.url });\n    box.append(domain, title);\n\n    if (embed.description) {\n      let text;\n\n      if (embed.description.length <= 300) {\n        text = embed.description;\n      } else {\n        text = embed.description.slice(0, 300) + '…';\n      }\n\n      box.append($tag('p.description', { text: text }));\n    }\n\n    a.append(box);\n\n    if (hostname == 'media.tenor.com') {\n      a.addEventListener('click', (e) => {\n        e.preventDefault();\n        this.displayGIFInline(a, embed);\n      });\n    }\n\n    return a;\n  }\n\n  /** @param {HTMLElement} a, @param {RawLinkEmbed | InlineLinkEmbed} embed */\n\n  displayGIFInline(a, embed) {\n    let gifDiv = $tag('div.gif');\n    let img = $tag('img', { src: embed.url }, HTMLImageElement);\n    img.style.opacity = '0';\n    img.style.maxHeight = '200px';\n    gifDiv.append(img);\n    a.replaceWith(gifDiv);\n\n    img.addEventListener('load', (e) => {\n      if (img.naturalWidth > img.naturalHeight) {\n        img.style.maxHeight = '200px';\n      } else {\n        img.style.maxWidth = '200px';\n        img.style.maxHeight = '400px';\n      }\n\n      img.style.opacity = '';\n    });\n\n    let staticPic;\n\n    if (typeof embed.thumb == 'string') {\n      staticPic = embed.thumb;\n    } else {\n      staticPic = `https://cdn.bsky.app/img/avatar/plain/${this.post.author.did}/${embed.thumb.ref.$link}@jpeg`;\n    }\n\n    img.addEventListener('click', (e) => {\n      if (img.classList.contains('static')) {\n        img.src = embed.url;\n        img.classList.remove('static');\n      } else {\n        img.src = staticPic;\n        img.classList.add('static');\n      }\n    });\n  }\n\n  /** @param {FeedGeneratorRecord} feedgen, @returns {HTMLElement} */\n\n  buildFeedGeneratorView(feedgen) {\n    let link = this.linkToFeedGenerator(feedgen);\n\n    let a = $tag('a.link-card.record', { href: link, target: '_blank' });\n    let box = $tag('div');\n\n    if (feedgen.avatar) {\n      let avatar = $tag('img.avatar', HTMLImageElement);\n      avatar.src = feedgen.avatar;\n      box.append(avatar);\n    }\n\n    let title = $tag('h2', { text: feedgen.title });\n    title.append($tag('span.handle', { text: `• Feed by @${feedgen.author.handle}` }));\n    box.append(title);\n\n    if (feedgen.description) {\n      let description = $tag('p.description', { text: feedgen.description });\n      box.append(description);\n    }\n\n    let stats = $tag('p.stats');\n    stats.append($tag('i', 'fa-solid fa-heart'), ' ');\n    stats.append($tag('output', { text: feedgen.likeCount }));\n    box.append(stats);\n\n    a.append(box);\n    return a;\n  }\n\n  /** @param {FeedGeneratorRecord} feedgen, @returns {string} */\n\n  linkToFeedGenerator(feedgen) {\n    let { repo, rkey } = atURI(feedgen.uri);\n    return `https://bsky.app/profile/${repo}/feed/${rkey}`;\n  }\n\n  /** @param {UserListRecord} list, @returns {HTMLElement} */\n\n  buildUserListView(list) {\n    let link = this.linkToUserList(list);\n\n    let a = $tag('a.link-card.record', { href: link, target: '_blank' });\n    let box = $tag('div');\n\n    if (list.avatar) {\n      let avatar = $tag('img.avatar', HTMLImageElement);\n      avatar.src = list.avatar;\n      box.append(avatar);\n    }\n\n    let listType;\n\n    switch (list.purpose) {\n    case 'app.bsky.graph.defs#curatelist':\n      listType = \"User list\";\n      break;\n    case 'app.bsky.graph.defs#modlist':\n      listType = \"Mute list\";\n      break;\n    default:\n      listType = \"List\";\n    }\n\n    let title = $tag('h2', { text: list.title });\n    title.append($tag('span.handle', { text: `• ${listType} by @${list.author.handle}` }));\n    box.append(title);\n\n    if (list.description) {\n      let description = $tag('p.description', { text: list.description });\n      box.append(description);\n    }\n\n    a.append(box);\n    return a;\n  }\n\n  /** @param {StarterPackRecord} pack, @returns {HTMLElement} */\n\n  buildStarterPackView(pack) {\n    let { repo, rkey } = atURI(pack.uri);\n    let link = `https://bsky.app/starter-pack/${repo}/${rkey}`;\n\n    let a = $tag('a.link-card.record', { href: link, target: '_blank' });\n    let box = $tag('div');\n\n    let title = $tag('h2', { text: pack.title });\n    title.append($tag('span.handle', { text: `• Starter pack by @${pack.author.handle}` }));\n    box.append(title);\n\n    if (pack.description) {\n      let description = $tag('p.description', { text: pack.description });\n      box.append(description);\n    }\n\n    a.append(box);\n    return a;\n  }\n\n  /** @param {UserListRecord} list, @returns {string} */\n\n  linkToUserList(list) {\n    let { repo, rkey } = atURI(list.uri);\n    return `https://bsky.app/profile/${repo}/lists/${rkey}`;\n  }\n\n  /** @params {RawImageEmbed | InlineImageEmbed} embed, @returns {HTMLElement} */\n\n  buildImagesComponent(embed) {\n    let wrapper = $tag('div');\n\n    for (let image of embed.images) {\n      let p = $tag('p');\n      p.append('[');\n\n      // TODO: load image\n      let a = $tag('a', { text: \"Image\" }, HTMLLinkElement);\n\n      if (image.fullsize) {\n        a.href = image.fullsize;\n      } else {\n        let cid = image.image.ref['$link'];\n        a.href = `https://cdn.bsky.app/img/feed_fullsize/plain/${this.post.author.did}/${cid}@jpeg`;\n      }\n\n      p.append(a);\n      p.append('] ');\n      wrapper.append(p);\n\n      if (image.alt) {\n        let details = $tag('details.image-alt');\n        details.append(\n          $tag('summary', { text: 'Show alt' }),\n          image.alt\n        );\n        wrapper.appendChild(details);\n      }\n    }\n\n    return wrapper;\n  }\n\n  /** @params {RawVideoEmbed | InlineVideoEmbed} embed, @returns {HTMLElement} */\n\n  buildVideoComponent(embed) {\n    let wrapper = $tag('div');\n\n    // TODO: load thumbnail\n    let a = $tag('a', { text: \"Video\" }, HTMLLinkElement);\n\n    if (embed.playlistURL) {\n      a.href = embed.playlistURL;\n    } else {\n      let cid = embed.video.ref['$link'];\n      a.href = `https://video.bsky.app/watch/${this.post.author.did}/${cid}/playlist.m3u8`;\n    }\n\n    let p = $tag('p');\n    p.append('[', a, ']');\n    wrapper.append(p);\n\n    if (embed.alt) {\n      let details = $tag('details.image-alt');\n      details.append(\n        $tag('summary', { text: 'Show alt' }),\n        embed.alt\n      );\n      wrapper.appendChild(details);\n    }\n\n    return wrapper;\n  }\n\n  /** @param {string} uri, @param {HTMLElement} div, @returns Promise<void> */\n\n  async loadQuotedPost(uri, div) {\n    let record = await api.loadPostIfExists(uri);\n\n    if (record) {\n      let post = new Post(record);\n      let postView = new PostComponent(post, 'quote').buildElement();\n      div.replaceChildren(postView);\n    } else {\n      let post = new MissingPost(this.embed.record);\n      let postView = new PostComponent(post, 'quote').buildElement();\n      div.replaceChildren(postView);\n    }\n  }\n}\n",
    "/*\n  Extracted from https://github.com/bluesky-social/atproto/\n\n  Copyright (c) 2022-2024 Bluesky PBC, and Contributors\n  MIT License\n\n  Permission is hereby granted, free of charge, to any person obtaining a copy\n  of this software and associated documentation files (the \"Software\"), to deal\n  in the Software without restriction, including without limitation the rights\n  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the Software is\n  furnished to do so, subject to the following conditions:\n\n  The above copyright notice and this permission notice shall be included in all\n  copies or substantial portions of the Software.\n\n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n  SOFTWARE.\n*/\n\n// packages/api/src/rich-text/rich-text.ts\n\nclass RichTextSegment {\n  /** @param {string} text, @param {json} [facet] */\n  constructor(text, facet) {\n    this.text = text;\n    this.facet = facet;\n  }\n\n  /** @returns {object | undefined} */\n  get link() {\n    return this.facet?.features?.find(v => v.$type === 'app.bsky.richtext.facet#link');\n  }\n\n  /** @returns {object | undefined} */\n  get mention() {\n    return this.facet?.features?.find(v => v.$type === 'app.bsky.richtext.facet#mention');\n  }\n\n  /** @returns {object | undefined} */\n  get tag() {\n    return this.facet?.features?.find(v => v.$type === 'app.bsky.richtext.facet#tag');\n  }\n}\n\nexport class RichText {\n  /** @params {json} props */\n  constructor(props) {\n    this.unicodeText = new UnicodeString(props.text);\n    this.facets = props.facets;\n\n    if (this.facets) {\n      this.facets.sort((a, b) => a.index.byteStart - b.index.byteStart);\n    }\n  }\n\n  /** @returns {string} */\n  get text() {\n    return this.unicodeText.toString();\n  }\n\n  /** @returns {number} */\n  get length() {\n    return this.unicodeText.length;\n  }\n\n  /** @returns {number} */\n  get graphemeLength() {\n    return this.unicodeText.graphemeLength;\n  }\n\n  *segments() {\n    const facets = this.facets || [];\n\n    if (facets.length == 0) {\n      yield new RichTextSegment(this.unicodeText.utf16);\n      return;\n    }\n\n    let textCursor = 0;\n    let facetCursor = 0;\n\n    do {\n      const currFacet = facets[facetCursor];\n\n      if (textCursor < currFacet.index.byteStart) {\n        yield new RichTextSegment(this.unicodeText.slice(textCursor, currFacet.index.byteStart));\n      } else if (textCursor > currFacet.index.byteStart) {\n        facetCursor++;\n        continue;\n      }\n\n      if (currFacet.index.byteStart < currFacet.index.byteEnd) {\n        const subtext = this.unicodeText.slice(currFacet.index.byteStart, currFacet.index.byteEnd);\n\n        if (subtext.trim().length == 0) {\n          yield new RichTextSegment(subtext);\n        } else {\n          yield new RichTextSegment(subtext, currFacet);\n        }\n      }\n\n      textCursor = currFacet.index.byteEnd;\n      facetCursor++;\n\n    } while (facetCursor < facets.length);\n\n    if (textCursor < this.unicodeText.length) {\n      yield new RichTextSegment(this.unicodeText.slice(textCursor, this.unicodeText.length));\n    }\n  }\n}\n\n\n// packages/api/src/rich-text/unicode.ts\n\n/**\n * Javascript uses utf16-encoded strings while most environments and specs\n * have standardized around utf8 (including JSON).\n *\n * After some lengthy debated we decided that richtext facets need to use\n * utf8 indices. This means we need tools to convert indices between utf8\n * and utf16, and that's precisely what this library handles.\n */\n\nclass UnicodeString {\n  static encoder = new TextEncoder();\n  static decoder = new TextDecoder();\n  static segmenter = window.Intl && Intl.Segmenter && new Intl.Segmenter();\n\n  /** @param {string} utf16 */\n  constructor(utf16) {\n    this.utf16 = utf16;\n    this.utf8 = UnicodeString.encoder.encode(utf16);\n  }\n\n  /** @returns number */\n  get length() {\n    return this.utf8.byteLength;\n  }\n\n  /** @returns number */\n  get graphemeLength() {\n    return Array.from(UnicodeString.segmenter.segment(this.utf16)).length;\n  }\n\n  /** @param {number} start, @param {number} end, @returns string */\n  slice(start, end) {\n    return UnicodeString.decoder.decode(this.utf8.slice(start, end));\n  }\n\n  /** @returns string */\n  toString() {\n    return this.utf16;\n  }\n}\n",
    "import {\n  $, $id,\n  atURI,\n  escapeHTML,\n  getLocation,\n  linkToPostById,\n  linkToPostThread,\n  sameDay,\n  sanitizeHTML,\n  showError\n} from './utils.js';\n\nimport { $tag } from './utils_ts.js';\nimport { Post, BlockedPost, MissingPost, DetachedQuotePost, InlineLinkEmbed } from './models.js';\nimport { APIError } from './minisky.js';\nimport { EmbedComponent } from './embed_component.js';\nimport { RichText } from './rich_text_lite.js';\nimport { showDialog } from './skythread.js';\n\n/**\n * Renders a post/thread view and its subviews.\n */\n\nexport class PostComponent {\n  /**\n   * Post component's root HTML element, if built.\n   * @type {HTMLElement | undefined}\n   */\n  _rootElement;\n\n  /**\n    Contexts:\n    - thread - a post in the thread tree\n    - parent - parent reference above the thread root\n    - quote - a quote embed\n    - quotes - a post on the quotes page\n    - feed - a post on the hashtag feed page\n\n    @typedef {'thread' | 'parent' | 'quote' | 'quotes' | 'feed'} PostContext\n    @param {AnyPost} post, @param {PostContext} context\n  */\n  constructor(post, context) {\n    this.post = /** @type {Post}, TODO */ (post);\n    this.context = context;\n  }\n\n  /**\n   * @returns {HTMLElement}\n   */\n  get rootElement() {\n    if (!this._rootElement) {\n      throw new Error(\"rootElement not initialized\");\n    }\n\n    return this._rootElement;\n  }\n\n  /** @returns {boolean} */\n  get isRoot() {\n    return this.post.isRoot;\n  }\n\n  /** @returns {string} */\n  get linkToAuthor() {\n    if (this.post.author.handle != 'handle.invalid') {\n      return 'https://bsky.app/profile/' + this.post.author.handle;\n    } else {\n      return 'https://bsky.app/profile/' + this.post.author.did;\n    }\n  }\n\n  /** @returns {string} */\n  get linkToPost() {\n    return this.linkToAuthor + '/post/' + this.post.rkey;\n  }\n\n  /** @returns {string} */\n  get didLinkToAuthor() {\n    let { repo } = atURI(this.post.uri);\n    return `https://bsky.app/profile/${repo}`;\n  }\n\n  /** @returns {string} */\n  get didLinkToPost() {\n    let { repo, rkey } = atURI(this.post.uri);\n    return `https://bsky.app/profile/${repo}/post/${rkey}`;\n  }\n\n  /** @returns {string} */\n  get authorName() {\n    if (this.post.author.displayName) {\n      return this.post.author.displayName;\n    } else if (this.post.author.handle.endsWith('.bsky.social')) {\n      return this.post.author.handle.replace(/\\.bsky\\.social$/, '');\n    } else {\n      return this.post.author.handle;\n    }\n  }\n\n  /** @returns {json} */\n  get timeFormatForTimestamp() {\n    if (this.context == 'quotes' || this.context == 'feed') {\n      return { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric', hour: 'numeric', minute: 'numeric' };\n    } else if (this.isRoot || this.context != 'thread') {\n      return { day: 'numeric', month: 'short', year: 'numeric', hour: 'numeric', minute: 'numeric' };\n    } else if (this.post.pageRoot && !sameDay(this.post.createdAt, this.post.pageRoot.createdAt)) {\n      return { day: 'numeric', month: 'short', hour: 'numeric', minute: 'numeric' };\n    } else {\n      return { hour: 'numeric', minute: 'numeric' };\n    }\n  }\n\n  /** @param {HTMLElement} nodeToUpdate */\n  installIntoElement(nodeToUpdate) {\n    let view = this.buildElement();\n\n    let oldContent = $(nodeToUpdate.querySelector('.content'));\n    let newContent = $(view.querySelector('.content'));\n    oldContent.replaceWith(newContent);\n\n    this._rootElement = nodeToUpdate;\n  }\n\n  /** @returns {HTMLElement} */\n  buildElement() {\n    if (this._rootElement) {\n      return this._rootElement;\n    }\n\n    let div = $tag('div.post', `post-${this.context}`);\n    this._rootElement = div;\n\n    if (this.post.muted) {\n      div.classList.add('muted');\n    }\n\n    if (this.post instanceof BlockedPost) {\n      this.buildBlockedPostElement(div);\n      return div;\n    } else if (this.post instanceof DetachedQuotePost) {\n      this.buildDetachedQuoteElement(div);\n      return div;\n    } else if (this.post instanceof MissingPost) {\n      this.buildMissingPostElement(div);\n      return div;\n    }\n\n    let header = this.buildPostHeader();\n    div.appendChild(header);\n\n    let content = $tag('div.content');\n\n    if (this.context == 'thread' && !this.isRoot) {\n      let edgeMargin = this.buildEdgeMargin();\n      div.appendChild(edgeMargin);\n    }\n\n    let wrapper;\n\n    if (this.post.muted) {\n      let details = $tag('details');\n\n      let summary = $tag('summary');\n      summary.innerText = this.post.muteList ? `Muted (${this.post.muteList})` : 'Muted - click to show';\n      details.appendChild(summary);\n\n      content.appendChild(details);\n      wrapper = details;\n    } else {\n      wrapper = content;\n    }\n\n    let p = this.buildPostBody();\n    wrapper.appendChild(p);\n\n    if (this.post.tags) {\n      let tagsRow = this.buildTagsRow(this.post.tags);\n      wrapper.appendChild(tagsRow);\n    }\n\n    if (this.post.embed) {\n      let embed = new EmbedComponent(this.post, this.post.embed).buildElement();\n      wrapper.appendChild(embed);\n\n      if (this.post.originalFediURL) {\n        if (this.post.embed instanceof InlineLinkEmbed && this.post.embed.title.startsWith('Original post on ')) {\n          embed.remove();\n        }\n      }\n    }\n\n    if (this.post.originalFediURL) {\n      let link = this.buildFediSourceLink(this.post.originalFediURL);\n      if (link) {\n        wrapper.appendChild(link);\n      }\n    }\n\n    if (this.post.likeCount !== undefined && this.post.repostCount !== undefined) {\n      let stats = this.buildStatsFooter();\n      wrapper.appendChild(stats);\n    }\n\n    if (this.post.replyCount == 1 && this.post.replies[0]?.author?.did == this.post.author.did) {\n      let component = new PostComponent(this.post.replies[0], 'thread');\n      let element = component.buildElement();\n      element.classList.add('flat');\n      content.appendChild(element);\n    } else {\n      for (let reply of this.post.replies) {\n        if (reply instanceof MissingPost) { continue }\n        if (reply instanceof BlockedPost && window.biohazardEnabled === false) { continue }\n\n        let component = new PostComponent(reply, 'thread');\n        content.appendChild(component.buildElement());\n      }\n    }\n\n    if (this.context == 'thread') {\n      if (this.post.hasMoreReplies) {\n        let loadMore = this.buildLoadMoreLink();\n        content.appendChild(loadMore);\n      } else if (this.post.hasHiddenReplies && window.biohazardEnabled !== false) {\n        let loadMore = this.buildHiddenRepliesLink();\n        content.appendChild(loadMore);\n      }\n    }\n\n    div.appendChild(content);\n\n    return div;\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildPostHeader() {\n    let timeFormat = this.timeFormatForTimestamp;\n    let formattedTime = this.post.createdAt.toLocaleString(window.dateLocale, timeFormat);\n    let isoTime = this.post.createdAt.toISOString();\n\n    let h = $tag('h2');\n\n    h.innerHTML = `${escapeHTML(this.authorName)} `;\n\n    if (this.post.isFediPost) {\n      let handle = `@${this.post.authorFediHandle}`;\n      h.innerHTML += `<a class=\"handle\" href=\"${this.linkToAuthor}\" target=\"_blank\">${handle}</a> ` +\n        `<img src=\"icons/mastodon.svg\" class=\"mastodon\"> `;\n    } else {\n      let handle = (this.post.author.handle != 'handle.invalid') ? `@${this.post.author.handle}` : '[invalid handle]';\n      h.innerHTML += `<a class=\"handle\" href=\"${this.linkToAuthor}\" target=\"_blank\">${handle}</a> `;\n    }\n\n    h.innerHTML += `<span class=\"separator\">&bull;</span> ` +\n      `<a class=\"time\" href=\"${this.linkToPost}\" target=\"_blank\" title=\"${isoTime}\">${formattedTime}</a> `;\n\n    if (this.post.replyCount > 0 && !this.isRoot || ['quote', 'quotes', 'feed'].includes(this.context)) {\n      h.innerHTML +=\n        `<span class=\"separator\">&bull;</span> ` +\n        `<a href=\"${linkToPostThread(this.post)}\" class=\"action\" title=\"Load this subtree\">` +\n        `<i class=\"fa-solid fa-arrows-split-up-and-left fa-rotate-180\"></i></a> `;\n    }\n\n    if (this.post.muted) {\n      h.prepend($tag('i', 'missing fa-regular fa-circle-user fa-2x'));\n    } else if (this.post.author.avatar) {\n      h.prepend(this.buildUserAvatar(this.post.author.avatar));\n    } else {\n      h.prepend($tag('i', 'missing fa-regular fa-face-smile fa-2x'));\n    }\n\n    return h;\n  }\n\n  buildEdgeMargin() {\n    let div = $tag('div.margin');\n\n    let edge = $tag('div.edge');\n    let line = $tag('div.line');\n    edge.appendChild(line);\n    div.appendChild(edge);\n\n    let plus = $tag('img.plus', { src: 'icons/subtract-square.png' });\n    div.appendChild(plus);\n\n    [edge, plus].forEach(x => {\n      x.addEventListener('click', (e) => {\n        e.preventDefault();\n        this.toggleSectionFold();\n      });\n    });\n\n    return div;\n  }\n\n  /** @param {string} url, @returns {HTMLImageElement} */\n\n  buildUserAvatar(url) {\n    let avatar = $tag('img.avatar', { loading: 'lazy' }, HTMLImageElement); // needs to be set before src!\n    avatar.src = url;\n    window.avatarPreloader.observe(avatar);\n    return avatar;\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildPostBody() {\n    if (this.post.originalFediContent) {\n      return $tag('div.body', { html: sanitizeHTML(this.post.originalFediContent) });\n    }\n\n    let p = $tag('p.body');\n    let richText = new RichText({ text: this.post.text, facets: this.post.facets });\n\n    for (let seg of richText.segments()) {\n      if (seg.mention) {\n        p.append($tag('a', { href: `https://bsky.app/profile/${seg.mention.did}`, text: seg.text }));\n      } else if (seg.link) {\n        p.append($tag('a', { href: seg.link.uri, text: seg.text }));\n      } else if (seg.tag) {\n        let url = new URL(getLocation());\n        url.searchParams.set('hash', seg.tag.tag);\n        p.append($tag('a', { href: url.toString(), text: seg.text }));\n      } else if (seg.text.includes(\"\\n\")) {\n        let span = $tag('span', { text: seg.text });\n        span.innerHTML = span.innerHTML.replaceAll(\"\\n\", \"<br>\");\n        p.append(span);\n      } else {\n        p.append(seg.text);\n      }\n    }\n\n    return p;\n  }\n\n  /** @param {string[]} terms */\n\n  highlightSearchResults(terms) {\n    let regexp = new RegExp(`\\\\b(${terms.join('|')})\\\\b`, 'gi');\n\n    let root = this.rootElement;\n    let body = $(root.querySelector(':scope > .content > .body, :scope > .content > details .body'));\n    let walker = document.createTreeWalker(body, NodeFilter.SHOW_TEXT);\n    let textNodes = [];\n\n    while (walker.nextNode()) {\n      textNodes.push(walker.currentNode);\n    }\n\n    for (let node of textNodes) {\n      if (!node.textContent) { continue; }\n\n      let markedText = document.createDocumentFragment();\n      let currentPosition = 0;\n\n      for (;;) {\n        let match = regexp.exec(node.textContent);\n        if (match === null) break;\n\n        if (match.index > currentPosition) {\n          let earlierText = node.textContent.slice(currentPosition, match.index);\n          markedText.appendChild(document.createTextNode(earlierText));\n        }\n\n        let span = $tag('span.highlight', { text: match[0] });\n        markedText.appendChild(span);\n\n        currentPosition = match.index + match[0].length;\n      }\n\n      if (currentPosition < node.textContent.length) {\n        let remainingText = node.textContent.slice(currentPosition);\n        markedText.appendChild(document.createTextNode(remainingText));\n      }\n\n      $(node.parentNode).replaceChild(markedText, node);\n    }\n  }\n\n  /** @param {string[]} tags, @returns {HTMLElement} */\n\n  buildTagsRow(tags) {\n    let p = $tag('p.tags');\n\n    for (let tag of tags) {\n      let url = new URL(getLocation());\n      url.searchParams.set('hash', tag);\n\n      let tagLink = $tag('a', { href: url.toString(), text: '# ' + tag });\n      p.append(tagLink);\n    }\n\n    return p;\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildStatsFooter() {\n    let stats = $tag('p.stats');\n\n    let span = $tag('span');\n    let heart = $tag('i', 'fa-solid fa-heart ' + (this.post.liked ? 'liked' : ''));\n    heart.addEventListener('click', (e) => this.onHeartClick(heart));\n\n    span.append(heart, ' ', $tag('output', { text: this.post.likeCount }));\n    stats.append(span);\n\n    if (this.post.repostCount > 0) {\n      let span = $tag('span', { html: `<i class=\"fa-solid fa-retweet\"></i> ${this.post.repostCount}` });\n      stats.append(span);\n    }\n\n    if (this.post.replyCount > 0 && (this.context == 'quotes' || this.context == 'feed')) {\n      let pluralizedCount = (this.post.replyCount > 1) ? `${this.post.replyCount} replies` : '1 reply';\n      let span = $tag('span', {\n        html: `<i class=\"fa-regular fa-message\"></i> <a href=\"${linkToPostThread(this.post)}\">${pluralizedCount}</a>`\n      });\n      stats.append(span);\n    }\n\n    if (!this.isRoot && this.context != 'quote' && this.post.quoteCount) {\n      let expanded = this.context == 'quotes' || this.context == 'feed';\n      let quotesLink = this.buildQuotesIconLink(this.post.quoteCount, expanded);\n      stats.append(quotesLink);\n    }\n\n    if (this.context == 'thread' && this.post.isRestrictingReplies) {\n      let span = $tag('span', { html: `<i class=\"fa-solid fa-ban\"></i> Limited replies` });\n      stats.append(span);\n    }\n\n    return stats;\n  }\n\n  /** @param {number} count, @param {boolean} expanded, @returns {HTMLElement} */\n\n  buildQuotesIconLink(count, expanded) {\n    let q = new URL(getLocation());\n    q.searchParams.set('quotes', this.linkToPost);\n\n    let url = q.toString();\n    let icon = `<i class=\"fa-regular fa-comments\"></i>`;\n\n    if (expanded) {\n      let span = $tag('span', { html: `${icon} ` });\n      let link = $tag('a', { text: (count > 1) ? `${count} quotes` : '1 quote', href: url });\n      span.append(link);\n      return span;\n    } else {\n      return $tag('a', { html: `${icon} ${count}`, href: url });\n    }\n  }\n\n  /** @param {number} quoteCount, @param {boolean} expanded */\n\n  appendQuotesIconLink(quoteCount, expanded) {\n    let stats = $(this.rootElement.querySelector(':scope > .content > p.stats'));\n    let quotesLink = this.buildQuotesIconLink(quoteCount, expanded);\n    stats.append(quotesLink);\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildLoadMoreLink() {\n    let loadMore = $tag('p');\n\n    let link = $tag('a', {\n      href: linkToPostThread(this.post),\n      text: \"Load more replies…\"\n    });\n\n    link.addEventListener('click', (e) => {\n      e.preventDefault();\n      loadMore.innerHTML = `<img class=\"loader\" src=\"icons/sunny.png\">`;\n      this.loadSubtree(this.post, this.rootElement);\n    });\n\n    loadMore.appendChild(link);\n    return loadMore;\n  }\n\n  /** @returns {HTMLElement} */\n\n  buildHiddenRepliesLink() {\n    let loadMore = $tag('p.hidden-replies');\n\n    let link = $tag('a', {\n      href: linkToPostThread(this.post),\n      text: \"Load hidden replies…\"\n    });\n\n    link.addEventListener('click', (e) => {\n      e.preventDefault();\n\n      if (window.biohazardEnabled === true) {\n        this.loadHiddenReplies(loadMore);\n      } else {\n        window.loadInfohazard = () => this.loadHiddenReplies(loadMore);\n        showDialog($id('biohazard_dialog'));\n      }\n    });\n\n    loadMore.append(\"☣️ \", link);\n    return loadMore;\n  }\n\n  /** @param {HTMLElement} loadMoreButton */\n\n  loadHiddenReplies(loadMoreButton) {\n    loadMoreButton.innerHTML = `<img class=\"loader\" src=\"icons/sunny.png\">`;\n    this.loadHiddenSubtree(this.post, this.rootElement);\n  }\n\n  /** @param {string} url, @returns {HTMLElement | undefined} */\n\n  buildFediSourceLink(url) {\n    try {\n      let hostname = new URL(url).hostname;\n      let a = $tag('a.fedi-link', { href: url, target: '_blank' });\n\n      let box = $tag('div', { html: `<i class=\"fa-solid fa-arrow-up-right-from-square fa-sm\"></i> View on ${hostname}` });\n      a.append(box);\n      return a;\n    } catch (error) {\n      console.log(\"Invalid Fedi URL:\" + error);\n      return undefined;\n    }\n  }\n\n  /** @param {HTMLLinkElement} authorLink */\n\n  loadReferencedPostAuthor(authorLink) {\n    let did = atURI(this.post.uri).repo;\n\n    api.fetchHandleForDid(did).then(handle => {\n      if (this.post.author) {\n        this.post.author.handle = handle;\n      } else {\n        this.post.author = { did, handle };\n      }\n\n      authorLink.href = this.linkToAuthor;\n      authorLink.innerText = `@${handle}`;\n    });\n  }\n\n  /** @param {HTMLElement} div, @returns {HTMLElement} */\n\n  buildBlockedPostElement(div) {\n    let p = $tag('p.blocked-header');\n    p.innerHTML = `<i class=\"fa-solid fa-ban\"></i> <span>Blocked post</span>`;\n\n    if (window.biohazardEnabled === false) {\n      div.appendChild(p);\n      div.classList.add('blocked');\n      return p;\n    }\n\n    let blockStatus = this.post.blockedByUser ? 'has blocked you' : this.post.blocksUser ? \"you've blocked them\" : '';\n    blockStatus = blockStatus ? `, ${blockStatus}` : '';\n\n    let authorLink = $tag('a', { href: this.didLinkToAuthor, target: '_blank', text: 'see author' }, HTMLLinkElement);\n    p.append(' (', authorLink, blockStatus, ') ');\n    div.appendChild(p);\n\n    this.loadReferencedPostAuthor(authorLink);\n\n    let loadPost = $tag('p.load-post');\n    let a = $tag('a', { href: '#', text: \"Load post…\" });\n\n    a.addEventListener('click', (e) => {\n      e.preventDefault();\n      loadPost.innerHTML = '&nbsp;';\n      this.loadBlockedPost(this.post.uri, div);\n    });\n\n    loadPost.appendChild(a);\n    div.appendChild(loadPost);\n    div.classList.add('blocked');\n    return div;\n  }\n\n  /** @param {HTMLElement} div, @returns {HTMLElement} */\n\n  buildDetachedQuoteElement(div) {\n    let p = $tag('p.blocked-header');\n    p.innerHTML = `<i class=\"fa-solid fa-ban\"></i> <span>Hidden quote</span>`;\n\n    if (window.biohazardEnabled === false) {\n      div.appendChild(p);\n      div.classList.add('blocked');\n      return p;\n    }\n\n    let authorLink = $tag('a', { href: this.didLinkToAuthor, target: '_blank', text: 'see author' }, HTMLLinkElement);\n    p.append(' (', authorLink, ') ');\n    div.appendChild(p);\n\n    this.loadReferencedPostAuthor(authorLink);\n\n    let loadPost = $tag('p.load-post');\n    let a = $tag('a', { href: '#', text: \"Load post…\" });\n\n    a.addEventListener('click', (e) => {\n      e.preventDefault();\n      loadPost.innerHTML = '&nbsp;';\n      this.loadBlockedPost(this.post.uri, div);\n    });\n\n    loadPost.appendChild(a);\n    div.appendChild(loadPost);\n    div.classList.add('blocked');\n    return div;\n  }\n\n  /** @param {HTMLElement} div, @returns {HTMLElement} */\n\n  buildMissingPostElement(div) {\n    let p = $tag('p.blocked-header');\n    p.innerHTML = `<i class=\"fa-solid fa-ban\"></i> <span>Deleted post</span>`;\n\n    let authorLink = $tag('a', { href: this.didLinkToAuthor, target: '_blank', text: 'see author' }, HTMLLinkElement);\n    p.append(' (', authorLink, ') ');\n\n    this.loadReferencedPostAuthor(authorLink);\n\n    div.appendChild(p);\n    div.classList.add('blocked');\n    return div;\n  }\n\n  /** @param {string} uri, @param {HTMLElement} div, @returns Promise<void> */\n\n  async loadBlockedPost(uri, div) {\n    let record = await appView.loadPostIfExists(this.post.uri);\n\n    if (!record) {\n      let post = new MissingPost({ uri: this.post.uri });\n      let postView = new PostComponent(post, 'quote').buildElement();\n      div.replaceWith(postView);\n      return;\n    }\n\n    this.post = new Post(record);\n\n    let userView = await api.getRequest('app.bsky.actor.getProfile', { actor: this.post.author.did });\n\n    if (!userView.viewer || !(userView.viewer.blockedBy || userView.viewer.blocking)) {\n      let { repo, rkey } = atURI(this.post.uri);\n\n      let a = $tag('a', {\n        href: linkToPostById(repo, rkey),\n        className: 'action',\n        title: \"Load thread\",\n        html: `<i class=\"fa-solid fa-arrows-split-up-and-left fa-rotate-180\"></i>`\n      });\n\n      let header = $(div.querySelector('p.blocked-header'));\n      let separator = $tag('span.separator', { html: '&bull;' });\n      header.append(separator, ' ', a);\n    }\n\n    let loadPost = $(div.querySelector('p.load-post'));\n    loadPost.remove();\n\n    if (this.isRoot && this.post.parentReference) {\n      let { repo, rkey } = atURI(this.post.parentReference.uri);\n      let url = linkToPostById(repo, rkey);\n\n      let handle = api.findHandleByDid(repo);\n      let link = handle ? `See parent post (@${handle})` : \"See parent post\";\n\n      let p = $tag('p.back', { html: `<i class=\"fa-solid fa-reply\"></i><a href=\"${url}\">${link}</a>` });\n      div.appendChild(p);\n    }\n\n    let p = this.buildPostBody();\n    div.appendChild(p);\n\n    if (this.post.embed) {\n      let embed = new EmbedComponent(this.post, this.post.embed).buildElement();\n      div.appendChild(embed);\n\n      // TODO\n      Array.from(div.querySelectorAll('a.link-card')).forEach(x => x.remove());\n    }\n  }\n\n  /** @param {Post} post, @param {HTMLElement} nodeToUpdate, @returns {Promise<void>} */\n\n  async loadSubtree(post, nodeToUpdate) {\n    try {\n      let json = await api.loadThreadByAtURI(post.uri);\n\n      let root = Post.parseThreadPost(json.thread, post.pageRoot, 0, post.absoluteLevel);\n      post.updateDataFromPost(root);\n      window.subtreeRoot = post;\n\n      let component = new PostComponent(post, 'thread');\n      component.installIntoElement(nodeToUpdate);\n    } catch (error) {\n      showError(error);\n    }\n  }\n\n\n  /** @param {Post} post, @param {HTMLElement} nodeToUpdate, @returns {Promise<void>} */\n\n  async loadHiddenSubtree(post, nodeToUpdate) {\n    let content = $(nodeToUpdate.querySelector('.content'));\n    let hiddenRepliesDiv = $(content.querySelector(':scope > .hidden-replies'));\n\n    try {\n      var expectedReplyURIs = await blueAPI.getReplies(post.uri);\n    } catch (error) {\n      hiddenRepliesDiv.remove();\n\n      if (error instanceof APIError && error.code == 404) {\n        let info = $tag('p.missing-replies-info', {\n          html: `<i class=\"fa-solid fa-ban\"></i> Hidden replies not available (post too old)`\n        });\n        content.append(info);\n      } else {\n        setTimeout(() => showError(error), 1);\n      }\n\n      return;\n    }\n\n    let missingReplyURIs = expectedReplyURIs.filter(r => !post.replies.some(x => x.uri === r));\n    let promises = missingReplyURIs.map(uri => api.loadThreadByAtURI(uri));\n\n    try {\n      // TODO\n      var responses = await Promise.allSettled(promises);\n    } catch (error) {\n      hiddenRepliesDiv.remove();\n      setTimeout(() => showError(error), 1);\n      return;\n    }\n\n    let replies = responses\n      .map(r => r.status == 'fulfilled' ? r.value : undefined)\n      .filter(v => v)\n      .map(json => Post.parseThreadPost(json.thread, post.pageRoot, 1, post.absoluteLevel + 1));\n\n    post.setReplies(replies);\n    hiddenRepliesDiv.remove();\n\n    for (let reply of post.replies) {\n      let component = new PostComponent(reply, 'thread');\n      let view = component.buildElement();\n      content.append(view);\n    }\n\n    if (replies.length < responses.length) {\n      let notFoundCount = responses.length - replies.length;\n      let pluralizedCount = (notFoundCount > 1) ? `${notFoundCount} replies are` : '1 reply is';\n\n      let info = $tag('p.missing-replies-info', {\n        html: `<i class=\"fa-solid fa-ban\"></i> ${pluralizedCount} missing (likely taken down by moderation)`\n      });\n      content.append(info);\n    }\n  }\n\n  /** @returns {boolean} */\n  isCollapsed() {\n    return this.rootElement.classList.contains('collapsed');\n  }\n\n  toggleSectionFold() {\n    let plus = $(this.rootElement.querySelector(':scope > .margin .plus'), HTMLImageElement);\n\n    if (this.isCollapsed()) {\n      this.rootElement.classList.remove('collapsed');\n      plus.src = 'icons/subtract-square.png'\n    } else {\n      this.rootElement.classList.add('collapsed');\n      plus.src = 'icons/add-square.png'\n    }\n  }\n\n  /** @param {HTMLElement} heart, @returns {Promise<void>} */\n\n  async onHeartClick(heart) {\n    try {\n      if (!this.post.hasViewerInfo) {\n        if (accountAPI.isLoggedIn) {\n          let data = await this.loadViewerInfo();\n\n          if (data) {\n            if (this.post.liked) {\n              heart.classList.add('liked');\n              return;\n            } else {\n              // continue down\n            }\n          } else {\n            this.showPostAsBlocked();\n            return;\n          }\n        } else {\n          // not logged in\n          showDialog(loginDialog);\n          return;\n        }\n      }\n\n      let countField = $(heart.nextElementSibling);\n      let likeCount = parseInt(countField.innerText, 10);\n\n      if (!heart.classList.contains('liked')) {\n        let like = await accountAPI.likePost(this.post);\n        this.post.viewerLike = like.uri;\n        heart.classList.add('liked');\n        countField.innerText = String(likeCount + 1);\n      } else {\n        await accountAPI.removeLike(this.post.viewerLike);\n        this.post.viewerLike = undefined;\n        heart.classList.remove('liked');\n        countField.innerText = String(likeCount - 1);\n      }\n    } catch (error) {\n      showError(error);\n    }\n  }\n\n  showPostAsBlocked() {\n    let stats = $(this.rootElement.querySelector(':scope > .content > p.stats'));\n\n    if (!stats.querySelector('.blocked-info')) {\n      let span = $tag('span.blocked-info', { text: '🚫 Post unavailable' });\n      stats.append(span);\n    }\n  }\n\n  /** @returns {Promise<json | undefined>} */\n\n  async loadViewerInfo() {\n    let data = await accountAPI.loadPostIfExists(this.post.uri);\n\n    if (data) {\n      this.post.author = data.author;\n      this.post.viewerData = data.viewer;\n      this.post.viewerLike = data.viewer?.like;\n    }\n\n    return data;\n  }\n}\n",
    "import { $, $id } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { logOut, showDialog } from './skythread.js';\n\nexport class Menu {\n  constructor() {\n    this.menuElement = $id('account_menu');\n    this.icon = $id('account');\n\n    this.setupEvents();\n  }\n\n  setupEvents() {\n    let html = $(document.body.parentNode);\n\n    html.addEventListener('click', (e) => {\n      this.menuElement.style.visibility = 'hidden';\n      this.icon.classList.remove('active');\n    });\n\n    let homeLink = $(this.menuElement.querySelector('a[href=\"?\"]'), HTMLLinkElement);\n    homeLink.href = location.origin + location.pathname;\n\n    this.icon.addEventListener('click', (e) => {\n      e.stopPropagation();\n      this.toggleAccountMenu();\n    });\n\n    this.menuElement.addEventListener('click', (e) => {\n      e.stopPropagation();\n    });\n\n    $(this.menuElement.querySelector('a[data-action=biohazard]')).addEventListener('click', (e) => {\n      e.preventDefault();\n\n      let hazards = document.querySelectorAll('p.hidden-replies, .content > .post.blocked, .blocked > .load-post');\n\n      if (window.biohazardEnabled === false) {\n        window.biohazardEnabled = true;\n        localStorage.setItem('biohazard', 'true');\n        this.toggleMenuButtonCheck('biohazard', true);\n        Array.from(hazards).forEach(p => { $(p).style.display = 'block' });\n      } else {\n        window.biohazardEnabled = false;\n        localStorage.setItem('biohazard', 'false');\n        this.toggleMenuButtonCheck('biohazard', false);\n        Array.from(hazards).forEach(p => { $(p).style.display = 'none' });\n      }\n    });\n\n    $(this.menuElement.querySelector('a[data-action=incognito]')).addEventListener('click', (e) => {\n      e.preventDefault();\n\n      if (window.isIncognito) {\n        localStorage.removeItem('incognito');\n      } else {\n        localStorage.setItem('incognito', '1');\n      }\n\n      location.reload();\n    });\n\n    $(this.menuElement.querySelector('a[data-action=login]')).addEventListener('click', (e) => {\n      e.preventDefault();\n\n      showDialog(loginDialog);\n      this.menuElement.style.visibility = 'hidden';\n    });\n\n    $(this.menuElement.querySelector('a[data-action=logout]')).addEventListener('click', (e) => {\n      e.preventDefault();\n      logOut();\n    });\n  }\n\n  toggleAccountMenu() {\n    let isVisible = (this.menuElement.style.visibility == 'visible');\n\n    this.menuElement.style.visibility = isVisible ? 'hidden' : 'visible';\n    this.icon.classList.toggle('active', !isVisible);\n  }\n\n  /** @param {string} buttonName */\n\n  showMenuButton(buttonName) {\n    let button = $(this.menuElement.querySelector(`a[data-action=${buttonName}]`));\n    let item = $(button.parentNode);\n    item.style.display = 'list-item';\n  }\n\n  /** @param {string} buttonName */\n\n  hideMenuButton(buttonName) {\n    let button = $(this.menuElement.querySelector(`a[data-action=${buttonName}]`));\n    let item = $(button.parentNode);\n    item.style.display = 'none';\n  }\n\n  /** @param {string} buttonName, @param {boolean} state */\n\n  toggleMenuButtonCheck(buttonName, state) {\n    let button = $(this.menuElement.querySelector(`a[data-action=${buttonName}]`));\n    let check = $(button.querySelector('.check'));\n    check.style.display = (state) ? 'inline' : 'none';\n  }\n\n  /** @param {boolean | 'incognito'} loggedIn, @param {string | undefined | null} [avatar] */\n\n  showLoggedInStatus(loggedIn, avatar) {\n    if (loggedIn === true && avatar) {\n      let button = $(this.icon.querySelector('i'));\n\n      let img = $tag('img.avatar', { src: avatar });\n      img.style.display = 'none';\n      img.addEventListener('load', () => {\n        button.remove();\n        img.style.display = 'inline';\n      });\n      img.addEventListener('error', () => {\n        this.showLoggedInStatus(true, null);\n      })\n\n      this.icon.append(img);\n    } else if (loggedIn === false) {\n      this.icon.innerHTML = `<i class=\"fa-regular fa-user-circle fa-xl\"></i>`;\n    } else if (loggedIn === 'incognito') {\n      this.icon.innerHTML = `<i class=\"fa-solid fa-user-secret fa-lg\"></i>`;\n    } else {\n      this.icon.innerHTML = `<i class=\"fa-solid fa-user-circle fa-xl\"></i>`;\n    }\n  }\n\n  /** @returns {Promise<void>} */\n\n  async loadCurrentUserAvatar() {\n    try {\n      let url = await api.loadCurrentUserAvatar();\n      this.showLoggedInStatus(true, url);\n    } catch (error) {\n      console.log(error);\n      this.showLoggedInStatus(true, null);\n    }\n  }\n}\n",
    "import { $, $id, atURI, linkToPostById, linkToPostThread, showError } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { Post, BlockedPost, MissingPost } from './models.js';\nimport { PostComponent } from './post_component.js';\nimport { setPageTitle, hideLoader } from './skythread.js';\n\n/**\n * Manages the page that displays a thread, as a whole.\n */\n\nexport class ThreadPage {\n\n  /** @param {AnyPost} post, @returns {HTMLElement} */\n\n  buildParentLink(post) {\n    let p = $tag('p.back');\n\n    if (post instanceof BlockedPost) {\n      let element = new PostComponent(post, 'parent').buildElement();\n      element.className = 'back';\n      let span = $(element.querySelector('p.blocked-header span'));\n      span.innerText = 'Parent post blocked';\n      return element;\n    } else if (post instanceof MissingPost) {\n      p.innerHTML = `<i class=\"fa-solid fa-ban\"></i> parent post has been deleted`;\n    } else {\n      let url = linkToPostThread(post);\n      p.innerHTML = `<i class=\"fa-solid fa-reply\"></i><a href=\"${url}\">See parent post (@${post.author.handle})</a>`;\n    }\n\n    return p;\n  }\n\n  /** @param {string} url, @returns {Promise<void>} */\n\n  async loadThreadByURL(url) {\n    try {\n      let json = url.startsWith('at://') ? await api.loadThreadByAtURI(url) : await api.loadThreadByURL(url);\n      this.displayThread(json);\n    } catch (error) {\n      hideLoader();\n      showError(error);\n    }\n  }\n\n  /** @param {string} author, @param {string} rkey, @returns {Promise<void>} */\n\n  async loadThreadById(author, rkey) {\n    try {\n      let json = await api.loadThreadById(author, rkey);\n      this.displayThread(json);\n    } catch (error) {\n      hideLoader();\n      showError(error);\n    }\n  }\n\n  /** @param {json} json */\n\n  displayThread(json) {\n    let root = Post.parseThreadPost(json.thread);\n    window.root = root;\n    window.subtreeRoot = root;\n\n    let loadQuoteCount;\n\n    if (root instanceof Post) {\n      setPageTitle(root);\n      loadQuoteCount = blueAPI.getQuoteCount(root.uri);\n\n      if (root.parent) {\n        let p = this.buildParentLink(root.parent);\n        $id('thread').appendChild(p);\n      } else if (root.parentReference) {\n        let { repo, rkey } = atURI(root.parentReference.uri);\n        let url = linkToPostById(repo, rkey);\n\n        let handle = api.findHandleByDid(repo);\n        let link = handle ? `See parent post (@${handle})` : \"See parent post\";\n\n        let p = $tag('p.back', { html: `<i class=\"fa-solid fa-reply\"></i><a href=\"${url}\">${link}</a>` });\n        $id('thread').appendChild(p);\n      }\n    }\n\n    let component = new PostComponent(root, 'thread');\n    let view = component.buildElement();\n    hideLoader();\n    $id('thread').appendChild(view);\n\n    loadQuoteCount?.then(count => {\n      if (count > 0) {\n        component.appendQuotesIconLink(count, true);\n      }\n    }).catch(error => {\n      console.warn(\"Couldn't load quote count: \" + error);\n    });\n  }\n}\n",
    "import { $, $id, feedPostTime } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { BlueskyAPI } from './api.js';\n\n/**\n * Manages the Posting Stats page.\n */\n\nexport class PostingStatsPage {\n\n  /** @type {number | undefined} */\n  scanStartTime;\n\n  /** @type {Record<string, { pages: number, progress: number }>} */\n  userProgress;\n\n  /** @type {number | undefined} */\n  autocompleteTimer;\n\n  /** @type {number} */\n  autocompleteIndex = -1;\n\n  /** @type {json[]} */\n  autocompleteResults = [];\n\n  /** @type {Record<string, json>} */\n  selectedUsers = {};\n\n  constructor() {\n    this.pageElement = $id('posting_stats_page');\n    this.form = $(this.pageElement.querySelector('form'), HTMLFormElement);\n\n    this.rangeInput = $(this.pageElement.querySelector('input[type=\"range\"]'), HTMLInputElement);\n    this.submitButton = $(this.pageElement.querySelector('input[type=\"submit\"]'), HTMLInputElement);\n    this.progressBar = $(this.pageElement.querySelector('input[type=submit] + progress'), HTMLProgressElement);\n    this.table = $(this.pageElement.querySelector('table.scan-result'));\n    this.tableHead = $(this.table.querySelector('thead'));\n    this.tableBody = $(this.table.querySelector('tbody'));\n    this.listSelect = $(this.pageElement.querySelector('.list-choice select'), HTMLSelectElement);\n    this.scanInfo = $(this.pageElement.querySelector('.scan-info'));\n    this.scanType = this.form.elements['scan_type'];\n\n    this.userField = $(this.pageElement.querySelector('.user-choice input'), HTMLInputElement);\n    this.userList = $(this.pageElement.querySelector('.selected-users'));\n    this.autocomplete = $(this.pageElement.querySelector('.autocomplete'));\n\n    this.userProgress = {};\n    this.appView = new BlueskyAPI('public.api.bsky.app', false);\n\n    this.setupEvents();\n  }\n\n  setupEvents() {\n    let html = $(document.body.parentNode);\n\n    html.addEventListener('click', (e) => {\n      this.hideAutocomplete();\n    });\n\n    this.form.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      if (!this.scanStartTime) {\n        this.scanPostingStats();\n      } else {\n        this.stopScan();\n      }\n    });\n\n    this.rangeInput.addEventListener('input', (e) => {\n      let days = parseInt(this.rangeInput.value, 10);\n      let label = $(this.pageElement.querySelector('input[type=range] + label'));\n      label.innerText = (days == 1) ? '1 day' : `${days} days`;\n    });\n\n    this.scanType.forEach(r => {\n      r.addEventListener('click', (e) => {\n        let value = $(r, HTMLInputElement).value;\n\n        $(this.pageElement.querySelector('.list-choice')).style.display = (value == 'list') ? 'block' : 'none';\n        $(this.pageElement.querySelector('.user-choice')).style.display = (value == 'users') ? 'block' : 'none';\n\n        if (value == 'users') {\n          this.userField.focus();\n        }\n\n        this.table.style.display = 'none';\n      });\n    });\n\n    this.userField.addEventListener('input', () => {\n      this.onUserInput();\n    });\n\n    this.userField.addEventListener('keydown', (e) => {\n      this.onUserKeyDown(e);\n    });\n  }\n\n  show() {\n    this.pageElement.style.display = 'block';\n    this.fetchLists();\n  }\n\n  /** @returns {number} */\n\n  selectedDaysRange() {\n    return parseInt(this.rangeInput.value, 10);\n  }\n\n  /** @returns {Promise<void>} */\n\n  async fetchLists() {\n    let lists = await accountAPI.loadUserLists();\n\n    let sorted = lists.sort((a, b) => {\n      let aName = a.name.toLocaleLowerCase();\n      let bName = b.name.toLocaleLowerCase();\n\n      return aName.localeCompare(bName);\n    });\n\n    for (let list of lists) {\n      this.listSelect.append(\n        $tag('option', { value: list.uri, text: list.name + ' ' })\n      );\n    }\n  }\n\n  onUserInput() {\n    if (this.autocompleteTimer) {\n      clearTimeout(this.autocompleteTimer);\n    }\n\n    let query = this.userField.value.trim();\n\n    if (query.length == 0) {\n      this.hideAutocomplete();\n      this.autocompleteTimer = undefined;\n      return;\n    }\n\n    this.autocompleteTimer = setTimeout(() => this.fetchAutocomplete(query), 100);\n  }\n\n  /** @param {KeyboardEvent} e */\n\n  onUserKeyDown(e) {\n    if (e.key == 'Enter') {\n      e.preventDefault();\n\n      if (this.autocompleteIndex >= 0) {\n        this.selectUser(this.autocompleteIndex);\n      }\n    } else if (e.key == 'Escape') {\n      this.hideAutocomplete();\n    } else if (e.key == 'ArrowDown' && this.autocompleteResults.length > 0) {\n      e.preventDefault();\n      this.moveAutocomplete(1);\n    } else if (e.key == 'ArrowUp' && this.autocompleteResults.length > 0) {\n      e.preventDefault();\n      this.moveAutocomplete(-1);\n    }\n  }\n\n  /** @param {string} query, @returns {Promise<void>} */\n\n  async fetchAutocomplete(query) {\n    let users = await accountAPI.autocompleteUsers(query);\n\n    let selectedDIDs = new Set(Object.keys(this.selectedUsers));\n    users = users.filter(u => !selectedDIDs.has(u.did));\n\n    this.autocompleteResults = users;\n    this.autocompleteIndex = -1;\n    this.showAutocomplete();\n  }\n\n  showAutocomplete() {\n    this.autocomplete.innerHTML = '';\n    this.autocomplete.scrollTop = 0;\n\n    if (this.autocompleteResults.length == 0) {\n      this.hideAutocomplete();\n      return;\n    }\n\n    for (let [i, user] of this.autocompleteResults.entries()) {\n      let row = this.makeUserRow(user);\n\n      row.addEventListener('mouseenter', () => {\n        this.highlightAutocomplete(i);\n      });\n\n      row.addEventListener('mousedown', (e) => {\n        e.preventDefault();\n        this.selectUser(i);\n      });\n\n      this.autocomplete.append(row);\n    };\n\n    this.autocomplete.style.top = this.userField.offsetHeight + 'px';\n    this.autocomplete.style.display = 'block';\n    this.highlightAutocomplete(0);\n  }\n\n  hideAutocomplete() {\n    this.autocomplete.style.display = 'none';\n    this.autocompleteResults = [];\n    this.autocompleteIndex = -1;\n  }\n\n  /** @param {number} change */\n\n  moveAutocomplete(change) {\n    if (this.autocompleteResults.length == 0) {\n      return;\n    }\n\n    let newIndex = this.autocompleteIndex + change;\n\n    if (newIndex < 0) {\n      newIndex = this.autocompleteResults.length - 1;\n    } else if (newIndex >= this.autocompleteResults.length) {\n      newIndex = 0;\n    }\n\n    this.highlightAutocomplete(newIndex);\n  }\n\n  /** @param {number} index */\n\n  highlightAutocomplete(index) {\n    this.autocompleteIndex = index;\n\n    let rows = this.autocomplete.querySelectorAll('.user-row');\n\n    rows.forEach((row, i) => {\n      row.classList.toggle('hover', i == index);\n    });\n  }\n\n  /** @param {number} index */\n\n  selectUser(index) {\n    let user = this.autocompleteResults[index];\n\n    if (!user) {\n      return;\n    }\n\n    this.selectedUsers[user.did] = user;\n\n    let row = this.makeUserRow(user, true);\n    this.userList.append(row);\n\n    this.userField.value = '';\n    this.hideAutocomplete();\n  }\n\n  /** @param {json} user, @param {boolean} [withRemove], @returns HTMLElement */\n\n  makeUserRow(user, withRemove = false) {\n    let row = $tag('div.user-row');\n    row.dataset.did = user.did;\n    row.append(\n      $tag('img.avatar', { src: user.avatar }),\n      $tag('span.name', { text: user.displayName || '–' }),\n      $tag('span.handle', { text: user.handle })\n    );\n\n    if (withRemove) {\n      let remove = $tag('a.remove', { href: '#', text: '✕' });\n\n      remove.addEventListener('click', (e) => {\n        e.preventDefault();\n        row.remove();\n        delete this.selectedUsers[user.did];\n      });\n\n      row.append(remove);\n    }\n\n    return row;\n  }\n\n  /** @returns {Promise<void>} */\n\n  async scanPostingStats() {\n    let startTime = new Date().getTime();\n    let requestedDays = this.selectedDaysRange();\n    let scanType = this.scanType.value;\n\n    /** @type {FetchAllOnPageLoad} */\n    let onPageLoad = (data) => {\n      if (this.scanStartTime != startTime) {\n        return { cancel: true };\n      }\n\n      this.updateProgress(data, startTime);\n    };\n\n    if (scanType == 'home') {\n      this.startScan(startTime, requestedDays);\n\n      let posts = await accountAPI.loadHomeTimeline(requestedDays, {\n        onPageLoad: onPageLoad,\n        keepLastPage: true\n      });\n\n      this.updateResultsTable(posts, startTime, requestedDays);\n    } else if (scanType == 'list') {\n      let list = this.listSelect.value;\n\n      if (!list) {\n        return;\n      }\n\n      this.startScan(startTime, requestedDays);\n\n      let posts = await accountAPI.loadListTimeline(list, requestedDays, {\n        onPageLoad: onPageLoad,\n        keepLastPage: true\n      });\n\n      this.updateResultsTable(posts, startTime, requestedDays, { showReposts: false });\n    } else if (scanType == 'users') {\n      let dids = Object.keys(this.selectedUsers);\n\n      if (dids.length == 0) {\n        return;\n      }\n\n      this.startScan(startTime, requestedDays);\n      this.resetUserProgress(dids);\n\n      let requests = dids.map(did => this.appView.loadUserTimeline(did, requestedDays, {\n        filter: 'posts_and_author_threads',\n        onPageLoad: (data) => {\n          if (this.scanStartTime != startTime) {\n            return { cancel: true };\n          }\n\n          this.updateUserProgress(did, data, startTime, requestedDays);\n        },\n        keepLastPage: true\n      }));\n\n      let datasets = await Promise.all(requests);\n      let posts = datasets.flat();\n\n      this.updateResultsTable(posts, startTime, requestedDays, {\n        showTotal: false,\n        showPercentages: false,\n        countFetchedDays: false,\n        users: Object.values(this.selectedUsers)\n      });\n    } else {\n      this.startScan(startTime, requestedDays);\n\n      let posts = await accountAPI.loadUserTimeline(accountAPI.user.did, requestedDays, {\n        filter: 'posts_no_replies',\n        onPageLoad: onPageLoad,\n        keepLastPage: true\n      });\n\n      this.updateResultsTable(posts, startTime, requestedDays, { showTotal: false, showPercentages: false });\n    }\n  }\n\n  /** @param {json[]} dataPage, @param {number} startTime */\n\n  updateProgress(dataPage, startTime) {\n    let last = dataPage.at(-1);\n\n    if (!last) { return }\n\n    let lastDate = feedPostTime(last);\n    let daysBack = (startTime - lastDate) / 86400 / 1000;\n\n    this.progressBar.value = daysBack;\n  }\n\n  /** @param {string[]} dids */\n\n  resetUserProgress(dids) {\n    this.userProgress = {};\n\n    for (let did of dids) {\n      this.userProgress[did] = { pages: 0, progress: 0 };\n    }\n  }\n\n  /** @param {string} did, @param {json[]} dataPage, @param {number} startTime, @param {number} requestedDays */\n\n  updateUserProgress(did, dataPage, startTime, requestedDays) {\n    let last = dataPage.at(-1);\n\n    if (!last) { return }\n\n    let lastDate = feedPostTime(last);\n    let daysBack = (startTime - lastDate) / 86400 / 1000;\n\n    this.userProgress[did].pages += 1;\n    this.userProgress[did].progress = Math.min(daysBack / requestedDays, 1.0);\n\n    let expectedPages = Object.values(this.userProgress).map(x => x.pages / x.progress);\n    let known = expectedPages.filter(x => !isNaN(x));\n    let expectedTotalPages = known.reduce((a, b) => a + b) / known.length * expectedPages.length;\n    let fetchedPages = Object.values(this.userProgress).map(x => x.pages).reduce((a, b) => a + b);\n\n    this.progressBar.value = Math.max(this.progressBar.value, (fetchedPages / expectedTotalPages) * requestedDays);\n  }\n\n  /** @param {json} a, @param {json} b, @returns {number} */\n\n  sortUserRows(a, b) {\n    let asum = a.own + a.reposts;\n    let bsum = b.own + b.reposts;\n\n    if (asum < bsum) {\n      return 1;\n    } else if (asum > bsum) {\n      return -1;\n    } else {\n      return 0;\n    }\n  }\n\n  /**\n   * @param {json[]} posts\n   * @param {number} startTime\n   * @param {number} requestedDays\n   * @param {{\n   *   showTotal?: boolean,\n   *   showPercentages?: boolean,\n   *   showReposts?: boolean,\n   *   countFetchedDays?: boolean,\n   *   users?: json[]\n   * }} [options]\n   * @returns {Promise<void>}\n   */\n\n  async updateResultsTable(posts, startTime, requestedDays, options = {}) {\n    if (this.scanStartTime != startTime) {\n      return;\n    }\n\n    let now = new Date().getTime();\n\n    if (now - startTime < 100) {\n      // artificial UI delay in case scan finishes immediately\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n\n    let users = {};\n    let total = 0;\n    let allReposts = 0;\n    let allNormalPosts = 0;\n\n    let last = posts.at(-1);\n\n    if (!last) {\n      this.stopScan();\n      return;\n    }\n\n    let daysBack;\n\n    if (options.countFetchedDays !== false) {\n      let lastDate = feedPostTime(last);\n      let fetchedDays = (startTime - lastDate) / 86400 / 1000;\n\n      if (Math.ceil(fetchedDays) < requestedDays) {\n        this.scanInfo.innerText = `🕓 Showing data from ${Math.round(fetchedDays)} days (the timeline only goes that far):`;\n        this.scanInfo.style.display = 'block';\n      }\n\n      daysBack = Math.min(requestedDays, fetchedDays);\n    } else {\n      daysBack = requestedDays;\n    }\n\n    let timeLimit = startTime - requestedDays * 86400 * 1000;\n    posts = posts.filter(x => (feedPostTime(x) > timeLimit));\n    posts.reverse();\n\n    if (options.users) {\n      for (let user of options.users) {\n        users[user.handle] = { handle: user.handle, own: 0, reposts: 0, avatar: user.avatar };\n      }\n    }\n\n    let ownThreads = new Set();\n\n    for (let item of posts) {\n      if (item.reply) {\n        if (!ownThreads.has(item.reply.parent.uri)) {\n          continue;\n        }\n      }\n\n      let user = item.reason ? item.reason.by : item.post.author;\n      let handle = user.handle;\n      users[handle] = users[handle] ?? { handle: handle, own: 0, reposts: 0, avatar: user.avatar };\n      total += 1;\n\n      if (item.reason) {\n        users[handle].reposts += 1;\n        allReposts += 1;\n      } else {\n        users[handle].own += 1;\n        allNormalPosts += 1;\n        ownThreads.add(item.post.uri);\n      }\n    }\n\n    let headRow = $tag('tr');\n\n    if (options.showReposts !== false) {\n      headRow.append(\n        $tag('th', { text: '#' }),\n        $tag('th', { text: 'Handle' }),\n        $tag('th', { text: 'All posts /d' }),\n        $tag('th', { text: 'Own posts /d' }),\n        $tag('th', { text: 'Reposts /d' })\n      );\n    } else {\n      headRow.append(\n        $tag('th', { text: '#' }),\n        $tag('th', { text: 'Handle' }),\n        $tag('th', { text: 'Posts /d' }),\n      );\n    }\n\n    if (options.showPercentages !== false) {\n      headRow.append($tag('th', { text: '% of timeline' }));\n    }\n\n    this.tableHead.append(headRow);\n\n    if (options.showTotal !== false) {\n      let tr = $tag('tr.total');\n\n      tr.append(\n        $tag('td.no', { text: '' }),\n        $tag('td.handle', { text: 'Total:' }),\n\n        (options.showReposts !== false) ?\n          $tag('td', { text: (total / daysBack).toFixed(1) }) : '',\n\n        $tag('td', { text: (allNormalPosts / daysBack).toFixed(1) }),\n\n        (options.showReposts !== false) ?\n          $tag('td', { text: (allReposts / daysBack).toFixed(1) }) : ''\n      );\n\n      if (options.showPercentages !== false) {\n        tr.append($tag('td.percent', { text: '' }));\n      }\n\n      this.tableBody.append(tr);\n    }\n\n    let sorted = Object.values(users).sort(this.sortUserRows);\n\n    for (let i = 0; i < sorted.length; i++) {\n      let user = sorted[i];\n      let tr = $tag('tr');\n\n      tr.append(\n        $tag('td.no', { text: i + 1 }),\n        $tag('td.handle', {\n          html: `<img class=\"avatar\" src=\"${user.avatar}\"> ` +\n                `<a href=\"https://bsky.app/profile/${user.handle}\" target=\"_blank\">${user.handle}</a>`\n        }),\n\n        (options.showReposts !== false) ?\n          $tag('td', { text: ((user.own + user.reposts) / daysBack).toFixed(1) }) : '',\n\n        $tag('td', { text: user.own > 0 ? (user.own / daysBack).toFixed(1) : '–' }),\n\n        (options.showReposts !== false) ?\n          $tag('td', { text: user.reposts > 0 ? (user.reposts / daysBack).toFixed(1) : '–' }) : ''\n      );\n\n      if (options.showPercentages !== false) {\n        tr.append($tag('td.percent', { text: ((user.own + user.reposts) * 100 / total).toFixed(1) + '%' }));\n      }\n\n      this.tableBody.append(tr);\n    }\n\n    this.table.style.display = 'table';\n    this.stopScan();\n  }\n\n  /** @param {number} startTime, @param {number} requestedDays */\n\n  startScan(startTime, requestedDays) {\n    this.submitButton.value = 'Cancel';\n\n    this.progressBar.max = requestedDays;\n    this.progressBar.value = 0;\n    this.progressBar.style.display = 'inline';\n\n    this.table.style.display = 'none';\n    this.tableHead.innerHTML = '';\n    this.tableBody.innerHTML = '';\n\n    this.scanStartTime = startTime;\n    this.scanInfo.style.display = 'none';\n  }\n\n  stopScan() {\n    this.submitButton.value = 'Start scan';\n    this.scanStartTime = undefined;\n    this.progressBar.style.display = 'none';\n  }\n}\n",
    "import { showLoader, hideLoader } from './skythread.js';\nimport { $id, atURI, linkToPostById } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { PostComponent } from './post_component.js';\nimport { Post } from './models.js';\n\nexport class NotificationsPage {\n\n  constructor() {\n    this.pageElement = $id('thread');\n  }\n\n  show() {\n    document.title = `Notifications - Skythread`;\n    showLoader();\n\n    let isLoading = false;\n    let firstPageLoaded = false;\n    let finished = false;\n    let cursor;\n\n    Paginator.loadInPages((next) => {\n      if (isLoading || finished) { return; }\n      isLoading = true;\n\n      accountAPI.loadMentions(cursor).then(data => {\n        let posts = data.posts.map(x => new Post(x));\n\n        if (posts.length > 0) {\n          if (!firstPageLoaded) {\n            hideLoader();\n            firstPageLoaded = true;\n\n            let header = $tag('header');\n            let h2 = $tag('h2', { text: \"Replies & Mentions:\" });\n            header.append(h2);\n\n            this.pageElement.appendChild(header);\n            this.pageElement.classList.add('notifications');\n          }\n\n          for (let post of posts) {\n            if (post.parentReference) {\n              let p = $tag('p.back');\n              p.innerHTML = `<i class=\"fa-solid fa-reply\"></i> `;\n\n              let { repo, rkey } = atURI(post.parentReference.uri);\n              let url = linkToPostById(repo, rkey);\n              let parentLink = $tag('a', { href: url });\n              p.append(parentLink);\n\n              if (repo == accountAPI.user.did) {\n                parentLink.innerText = 'Reply to you';\n              } else {\n                parentLink.innerText = 'Reply';\n                api.fetchHandleForDid(repo).then(handle => {\n                  parentLink.innerText = `Reply to @${handle}`;\n                });\n              }\n\n              this.pageElement.appendChild(p);\n            }\n\n            let postView = new PostComponent(post, 'feed').buildElement();\n            this.pageElement.appendChild(postView);\n          }\n        }\n\n        isLoading = false;\n        cursor = data.cursor;\n\n        if (!cursor) {\n          finished = true;\n        } else if (posts.length == 0) {\n          next();\n        }\n      }).catch(error => {\n        hideLoader();\n        console.log(error);\n        isLoading = false;\n      });\n    });\n  }\n}\n",
    "import { $, $id, atURI, feedPostTime } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { BlueskyAPI } from './api.js';\n\nexport class LikeStatsPage {\n\n  /** @type {number | undefined} */\n  scanStartTime;\n\n  constructor() {\n    this.pageElement = $id('like_stats_page');\n\n    this.rangeInput = $(this.pageElement.querySelector('input[type=\"range\"]'), HTMLInputElement);\n    this.submitButton = $(this.pageElement.querySelector('input[type=\"submit\"]'), HTMLInputElement);\n    this.progressBar = $(this.pageElement.querySelector('input[type=submit] + progress'), HTMLProgressElement);\n\n    this.receivedTable = $(this.pageElement.querySelector('.received-likes'), HTMLTableElement);\n    this.givenTable = $(this.pageElement.querySelector('.given-likes'), HTMLTableElement);\n\n    this.appView = new BlueskyAPI('public.api.bsky.app', false);\n\n    this.setupEvents();\n\n    this.progressPosts = 0;\n    this.progressLikeRecords = 0;\n    this.progressPostLikes = 0;\n  }\n\n  setupEvents() {\n    $(this.pageElement.querySelector('form')).addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      if (!this.scanStartTime) {\n        this.findLikes();\n      } else {\n        this.stopScan();\n      }\n    });\n\n    this.rangeInput.addEventListener('input', (e) => {\n      let days = parseInt(this.rangeInput.value, 10);\n      let label = $(this.pageElement.querySelector('input[type=range] + label'));\n      label.innerText = (days == 1) ? '1 day' : `${days} days`;\n    });\n  }\n\n  /** @returns {number} */\n\n  selectedDaysRange() {\n    return parseInt(this.rangeInput.value, 10);\n  }\n\n  show() {\n    this.pageElement.style.display = 'block';\n  }\n\n  /** @returns {Promise<void>} */\n\n  async findLikes() {\n    this.submitButton.value = 'Cancel';\n\n    let requestedDays = this.selectedDaysRange();\n\n    this.resetProgress();\n    this.progressBar.style.display = 'inline';\n\n    let startTime = new Date().getTime();\n    this.scanStartTime = startTime;\n\n    this.receivedTable.style.display = 'none';\n    this.givenTable.style.display = 'none';\n\n    let fetchGivenLikes = this.fetchGivenLikes(requestedDays);\n\n    let receivedLikes = await this.fetchReceivedLikes(requestedDays);\n    let receivedStats = this.sumUpReceivedLikes(receivedLikes);\n    let topReceived = this.getTopEntries(receivedStats);\n\n    await this.renderResults(topReceived, this.receivedTable);\n\n    let givenLikes = await fetchGivenLikes;\n    let givenStats = this.sumUpGivenLikes(givenLikes);\n    let topGiven = this.getTopEntries(givenStats);\n\n    let profileInfo = await appView.getRequest('app.bsky.actor.getProfiles', { actors: topGiven.map(x => x.did) });\n\n    for (let profile of profileInfo.profiles) {\n      let user = /** @type {LikeStat} */ (topGiven.find(x => x.did == profile.did));\n      user.handle = profile.handle;\n      user.avatar = profile.avatar;\n    }\n\n    await this.renderResults(topGiven, this.givenTable);\n\n    this.receivedTable.style.display = 'table';\n    this.givenTable.style.display = 'table';\n\n    this.submitButton.value = 'Start scan';\n    this.progressBar.style.display = 'none';\n    this.scanStartTime = undefined;\n  }\n\n  /** @param {number} requestedDays, @returns {Promise<json[]>} */\n\n  async fetchGivenLikes(requestedDays) {\n    let startTime = /** @type {number} */ (this.scanStartTime);\n\n    return await accountAPI.fetchAll('com.atproto.repo.listRecords', {\n      params: {\n        repo: accountAPI.user.did,\n        collection: 'app.bsky.feed.like',\n        limit: 100\n      },\n      field: 'records',\n      breakWhen: (x) => Date.parse(x['value']['createdAt']) < startTime - 86400 * requestedDays * 1000,\n      onPageLoad: (data) => {\n        let last = data.at(-1);\n\n        if (!last) { return }\n\n        let lastDate = Date.parse(last.value.createdAt);\n        let daysBack = (startTime - lastDate) / 86400 / 1000;\n\n        this.updateProgress({ likeRecords: Math.min(1.0, daysBack / requestedDays) });\n      }\n    });\n  }\n\n  /** @param {number} requestedDays, @returns {Promise<json[]>} */\n\n  async fetchReceivedLikes(requestedDays) {\n    let startTime = /** @type {number} */ (this.scanStartTime);\n\n    let myPosts = await this.appView.loadUserTimeline(accountAPI.user.did, requestedDays, {\n      filter: 'posts_with_replies',\n      onPageLoad: (data) => {\n        let last = data.at(-1);\n\n        if (!last) { return }\n\n        let lastDate = feedPostTime(last);\n        let daysBack = (startTime - lastDate) / 86400 / 1000;\n\n        this.updateProgress({ posts: Math.min(1.0, daysBack / requestedDays) });\n      }\n    });\n\n    let likedPosts = myPosts.filter(x => !x['reason'] && x['post']['likeCount'] > 0);\n\n    let results = [];\n\n    for (let i = 0; i < likedPosts.length; i += 10) {\n      let batch = likedPosts.slice(i, i + 10);\n      this.updateProgress({ postLikes: i / likedPosts.length });\n\n      let fetchBatch = batch.map(x => {\n        return this.appView.fetchAll('app.bsky.feed.getLikes', {\n          params: {\n            uri: x['post']['uri'],\n            limit: 100\n          },\n          field: 'likes'\n        });\n      });\n\n      let batchResults = await Promise.all(fetchBatch);\n      results = results.concat(batchResults);\n    }\n\n    this.updateProgress({ postLikes: 1.0 });\n\n    return results.flat();\n  }\n\n  /**\n   * @typedef {{ handle?: string, did?: string, avatar?: string, count: number }} LikeStat\n   * @typedef {Record<string, LikeStat>} LikeStatHash\n   */\n\n  /** @param {json[]} likes, @returns {LikeStatHash} */\n\n  sumUpReceivedLikes(likes) {\n    /** @type {LikeStatHash} */\n    let stats = {};\n\n    for (let like of likes) {\n      let handle = like.actor.handle;\n\n      if (!stats[handle]) {\n        stats[handle] = { handle: handle, count: 0, avatar: like.actor.avatar };\n      }\n\n      stats[handle].count += 1;\n    }\n\n    return stats;\n  }\n\n  /** @param {json[]} likes, @returns {LikeStatHash} */\n\n  sumUpGivenLikes(likes) {\n    /** @type {LikeStatHash} */\n    let stats = {};\n\n    for (let like of likes) {\n      let did = atURI(like.value.subject.uri).repo;\n\n      if (!stats[did]) {\n        stats[did] = { did: did, count: 0 };\n      }\n\n      stats[did].count += 1;\n    }\n\n    return stats;\n  }\n\n  /** @param {LikeStatHash} counts, @returns {LikeStat[]} */\n\n  getTopEntries(counts) {\n    return Object.entries(counts).sort(this.sortResults).map(x => x[1]).slice(0, 25);\n  }\n\n  /** @param {LikeStat[]} topUsers, @param {HTMLTableElement} table, @returns {Promise<void>} */\n\n  async renderResults(topUsers, table) {\n    let tableBody = $(table.querySelector('tbody'));\n    tableBody.innerHTML = '';\n\n    for (let [i, user] of topUsers.entries()) {\n      let tr = $tag('tr');\n      tr.append(\n        $tag('td.no', { text: i + 1 }),\n        $tag('td.handle', {\n          html: `<img class=\"avatar\" src=\"${user.avatar}\"> ` +\n                `<a href=\"https://bsky.app/profile/${user.handle}\" target=\"_blank\">${user.handle}</a>`\n        }),\n        $tag('td.count', { text: user.count })\n      );\n\n      tableBody.append(tr);\n    };\n  }\n\n  resetProgress() {\n    this.progressBar.value = 0;\n    this.progressPosts = 0;\n    this.progressLikeRecords = 0;\n    this.progressPostLikes = 0;\n  }\n\n  /** @param {{ posts?: number, likeRecords?: number, postLikes?: number }} data */\n\n  updateProgress(data) {\n    if (data.posts) {\n      this.progressPosts = data.posts;\n    }\n\n    if (data.likeRecords) {\n      this.progressLikeRecords = data.likeRecords;\n    }\n\n    if (data.postLikes) {\n      this.progressPostLikes = data.postLikes;\n    }\n\n    let totalProgress = (\n      0.1 * this.progressPosts +\n      0.65 * this.progressLikeRecords +\n      0.25 * this.progressPostLikes\n    );\n\n    this.progressBar.value = totalProgress;\n  }\n\n  /** @param {[string, LikeStat]} a, @param {[string, LikeStat]} b, @returns {-1|1|0} */\n\n  sortResults(a, b) {\n    if (a[1].count < b[1].count) {\n      return 1;\n    } else if (a[1].count > b[1].count) {\n      return -1;\n    } else {\n      return 0;\n    }\n  }\n\n  stopScan() {\n    this.submitButton.value = 'Start scan';\n    this.progressBar.style.display = 'none';\n    this.scanStartTime = undefined;\n  }\n}\n",
    "import { $, $id, feedPostTime } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { PostComponent } from './post_component.js';\nimport { Post } from './models.js';\nimport { BlueskyAPI } from './api.js';\n\nexport class PrivateSearchPage {\n\n  /** @type {number | undefined} */\n  fetchStartTime;\n\n  /** @type {number | undefined} */\n  importTimer;\n\n  /** @type {string | undefined} */\n  lycanImportStatus;\n\n  constructor() {\n    this.pageElement = $id('private_search_page');\n\n    this.header = $(this.pageElement.querySelector('h2'));\n\n    this.rangeInput = $(this.pageElement.querySelector('input[type=\"range\"]'), HTMLInputElement);\n    this.submitButton = $(this.pageElement.querySelector('input[type=\"submit\"]'), HTMLInputElement);\n    this.progressBar = $(this.pageElement.querySelector('input[type=\"submit\"] + progress'), HTMLProgressElement);\n    this.archiveStatus = $(this.pageElement.querySelector('.archive-status'));\n\n    this.searchLine = $(this.pageElement.querySelector('.search'));\n    this.searchField = $(this.pageElement.querySelector('.search-query'), HTMLInputElement);\n    this.searchForm = $(this.pageElement.querySelector('.search-form'), HTMLFormElement);\n    this.results = $(this.pageElement.querySelector('.results'));\n\n    this.timelineSearch = $(this.pageElement.querySelector('.timeline-search'));\n    this.timelineSearchForm = $(this.pageElement.querySelector('.timeline-search form'), HTMLFormElement);\n    this.searchCollections = $(this.pageElement.querySelector('.search-collections'));\n\n    this.lycanImportSection = $(this.pageElement.querySelector('.lycan-import'));\n    this.lycanImportForm = $(this.pageElement.querySelector('.lycan-import form'), HTMLFormElement);\n    this.importProgress = $(this.pageElement.querySelector('.import-progress'));\n    this.importProgressBar = $(this.pageElement.querySelector('.import-progress progress'), HTMLProgressElement);\n    this.importStatusLabel = $(this.pageElement.querySelector('.import-status'));\n    this.importStatusPosition = $(this.pageElement.querySelector('.import-progress output'));\n\n    this.isCheckingStatus = false;\n    this.timelinePosts = [];\n\n    this.setupEvents();\n\n    let params = new URLSearchParams(location.search);\n    this.mode = params.get('mode');\n    this.lycanMode = params.get('lycan');\n\n    if (this.lycanMode == 'local') {\n      this.localLycan = new BlueskyAPI('http://localhost:3000', false);\n    }\n  }\n\n  setupEvents() {\n    this.timelineSearchForm.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      if (!this.fetchStartTime) {\n        this.fetchTimeline();\n      } else {\n        this.stopFetch();\n      }\n    });\n\n    this.rangeInput.addEventListener('input', (e) => {\n      let days = parseInt(this.rangeInput.value, 10);\n      let label = $(this.pageElement.querySelector('input[type=range] + label'));\n      label.innerText = (days == 1) ? '1 day' : `${days} days`;\n    });\n\n    this.searchField.addEventListener('keydown', (e) => {\n      if (e.key == 'Enter') {\n        e.preventDefault();\n\n        let query = this.searchField.value.trim().toLowerCase();\n\n        if (this.mode == 'likes') {\n          this.searchInLycan(query);\n        } else {\n          this.searchInTimeline(query);\n        }\n      }\n    });\n\n    this.lycanImportForm.addEventListener('submit', (e) => {\n      e.preventDefault();\n      this.startLycanImport();\n    });\n  }\n\n  /** @returns {number} */\n\n  selectedDaysRange() {\n    return parseInt(this.rangeInput.value, 10);\n  }\n\n  show() {\n    this.pageElement.style.display = 'block';\n\n    if (this.mode == 'likes') {\n      this.header.innerText = 'Archive search';\n      this.timelineSearch.style.display = 'none';\n      this.searchCollections.style.display = 'block';\n      this.searchLine.style.display = 'block';\n      this.lycanImportSection.style.display = 'none';\n      this.checkLycanImportStatus();\n    } else {\n      this.header.innerText = 'Timeline search';\n      this.timelineSearch.style.display = 'block';\n      this.searchCollections.style.display = 'none';\n      this.lycanImportSection.style.display = 'none';\n    }\n  }\n\n  /** @returns {Promise<void>} */\n\n  async checkLycanImportStatus() {\n    if (this.isCheckingStatus) {\n      return;\n    }\n\n    this.isCheckingStatus = true;\n\n    try {\n      let response = await this.getImportStatus();\n      this.showImportStatus(response);\n    } catch (error) {\n      this.showImportError(`Couldn't check import status: ${error}`);\n    } finally {\n      this.isCheckingStatus = false;\n    }\n  }\n\n  /** @returns {Promise<json>} */\n\n  async getImportStatus() {\n    if (this.localLycan) {\n      return await this.localLycan.getRequest('blue.feeds.lycan.getImportStatus', { user: accountAPI.user.did });\n    } else {\n      return await accountAPI.getRequest('blue.feeds.lycan.getImportStatus', null, {\n        headers: { 'atproto-proxy': 'did:web:lycan.feeds.blue#lycan' }\n      });\n    }\n  }\n\n  /** @param {json} info */\n\n  showImportStatus(info) {\n    console.log(info);\n\n    if (!info.status) {\n      this.showImportError(\"Error checking import status\");\n      return;\n    }\n\n    this.lycanImportStatus = info.status;\n\n    if (info.status == 'not_started') {\n      this.lycanImportSection.style.display = 'block';\n      this.lycanImportForm.style.display = 'block';\n      this.importProgress.style.display = 'none';\n      this.searchField.disabled = true;\n\n      this.stopImportTimer();\n    } else if (info.status == 'in_progress' || info.status == 'scheduled' || info.status == 'requested') {\n      this.lycanImportSection.style.display = 'block';\n      this.lycanImportForm.style.display = 'none';\n      this.importProgress.style.display = 'block';\n      this.searchField.disabled = true;\n\n      this.showImportProgress(info);\n      this.startImportTimer();\n    } else if (info.status == 'finished') {\n      this.lycanImportForm.style.display = 'none';\n      this.importProgress.style.display = 'block';\n      this.searchField.disabled = false;\n\n      this.showImportProgress({ status: 'finished', progress: 1.0 });\n      this.stopImportTimer();\n    } else {\n      this.showImportError(\"Error checking import status\");\n      this.stopImportTimer();\n    }\n  }\n\n  /** @param {json} info */\n\n  showImportProgress(info) {\n    let progress = Math.max(0, Math.min(info.progress || 0));\n    this.importProgressBar.value = progress;\n    this.importProgressBar.style.display = 'inline';\n\n    let percent = Math.round(progress * 100);\n    this.importStatusPosition.innerText = `${percent}%`;\n\n    if (info.progress == 1.0) {\n      this.importStatusLabel.innerText = `Import complete ✓`;\n    } else if (info.position) {\n      let date = new Date(info.position).toLocaleString(window.dateLocale, { day: 'numeric', month: 'short', year: 'numeric' });\n      this.importStatusLabel.innerText = `Downloaded data until: ${date}`;\n    } else if (info.status == 'requested') {\n      this.importStatusLabel.innerText = 'Requesting import…';\n    } else {\n      this.importStatusLabel.innerText = 'Import started…';\n    }\n  }\n\n  /** @param {string} message */\n\n  showImportError(message) {\n    this.lycanImportSection.style.display = 'block';\n    this.lycanImportForm.style.display = 'none';\n    this.importProgress.style.display = 'block';\n    this.searchField.disabled = true;\n\n    this.importStatusLabel.innerText = message;\n    this.stopImportTimer();\n  }\n\n  startImportTimer() {\n    if (this.importTimer) {\n      return;\n    }\n\n    this.importTimer = setInterval(() => {\n      this.checkLycanImportStatus();\n    }, 3000);\n  }\n\n  stopImportTimer() {\n    if (this.importTimer) {\n      clearInterval(this.importTimer);\n      this.importTimer = undefined;\n    }\n  }\n\n  /** @returns {Promise<void>} */\n\n  async startLycanImport() {\n    this.showImportStatus({ status: 'requested' });\n\n    try {\n      if (this.localLycan) {\n        await this.localLycan.postRequest('blue.feeds.lycan.startImport', {\n          user: accountAPI.user.did\n        });\n      } else {\n        await accountAPI.postRequest('blue.feeds.lycan.startImport', null, {\n          headers: { 'atproto-proxy': 'did:web:lycan.feeds.blue#lycan' }\n        });\n      }\n\n      this.startImportTimer();\n    } catch (err) {\n      console.error('Failed to start Lycan import', err);\n      this.showImportError(`Import failed: ${err}`);\n    }\n  }\n\n  /** @returns {Promise<void>} */\n\n  async fetchTimeline() {\n    this.submitButton.value = 'Cancel';\n\n    let requestedDays = this.selectedDaysRange();\n\n    this.progressBar.max = requestedDays;\n    this.progressBar.value = 0;\n    this.progressBar.style.display = 'inline';\n\n    let startTime = new Date().getTime();\n    this.fetchStartTime = startTime;\n\n    let timeline = await accountAPI.loadHomeTimeline(requestedDays, {\n      onPageLoad: (data) => {\n        if (this.fetchStartTime != startTime) {\n          return { cancel: true };\n        }\n\n        this.updateProgress(data, startTime);\n      }\n    });\n\n    if (this.fetchStartTime != startTime) {\n      return;\n    }\n\n    let last = timeline.at(-1);\n    let daysBack;\n\n    if (last) {\n      let lastDate = feedPostTime(last);\n      daysBack = Math.round((startTime - lastDate) / 86400 / 1000);\n    } else {\n      daysBack = 0;\n    }\n\n    this.timelinePosts = timeline;\n\n    this.archiveStatus.innerText = \"Timeline archive fetched: \" + ((daysBack == 1) ? '1 day' : `${daysBack} days`);\n    this.searchLine.style.display = 'block';\n\n    this.submitButton.value = 'Fetch timeline';\n    this.progressBar.style.display = 'none';\n    this.fetchStartTime = undefined;\n  }\n\n  /** @param {string} query */\n\n  searchInTimeline(query) {\n    this.results.innerHTML = '';\n\n    if (query.length == 0) {\n      return;\n    }\n\n    let matching = this.timelinePosts\n      .filter(x => x.post.record.text.toLowerCase().includes(query))\n      .map(x => Post.parseFeedPost(x));\n\n    for (let post of matching) {\n      let postView = new PostComponent(post, 'feed').buildElement();\n      this.results.appendChild(postView);\n    }\n  }\n\n  /** @param {string} query */\n\n  searchInLycan(query) {\n    if (query.length == 0 || this.lycanImportStatus != 'finished') {\n      return;\n    }\n\n    this.results.innerHTML = '';\n    this.lycanImportSection.style.display = 'none';\n\n    let collection = this.searchForm.elements['collection'].value;\n\n    let loading = $tag('p', { text: \"...\" });\n    this.results.append(loading);\n\n    let isLoading = false;\n    let firstPageLoaded = false;\n    let cursor;\n    let finished = false;\n\n    Paginator.loadInPages(async () => {\n      if (isLoading || finished) { return; }\n      isLoading = true;\n\n      let response;\n\n      if (this.localLycan) {\n        let params = { collection, query, user: accountAPI.user.did };\n        if (cursor) params.cursor = cursor;\n\n        response = await this.localLycan.getRequest('blue.feeds.lycan.searchPosts', params);\n      } else {\n        let params = { collection, query };\n        if (cursor) params.cursor = cursor;\n\n        response = await accountAPI.getRequest('blue.feeds.lycan.searchPosts', params, {\n          headers: { 'atproto-proxy': 'did:web:lycan.feeds.blue#lycan' }\n        });\n      }\n\n      if (response.posts.length == 0) {\n        let p = $tag('p.results-end', { text: firstPageLoaded ? \"No more results.\" : \"No results.\" });\n        loading.remove();\n        this.results.append(p);\n\n        isLoading = false;\n        finished = true;\n        return;\n      }\n\n      let records = await accountAPI.loadPosts(response.posts);\n      let posts = records.map(x => new Post(x));\n\n      if (!firstPageLoaded) {\n        loading.remove();\n        firstPageLoaded = true;\n      }\n\n      for (let post of posts) {\n        let component = new PostComponent(post, 'feed');\n        let postView = component.buildElement();\n        this.results.appendChild(postView);\n\n        component.highlightSearchResults(response.terms);\n      }\n\n      isLoading = false;\n      cursor = response.cursor;\n\n      if (!cursor) {\n        finished = true;\n        this.results.append(\"No more results.\");\n      }\n    });\n  }\n\n  /** @param {json[]} dataPage, @param {number} startTime */\n\n  updateProgress(dataPage, startTime) {\n    let last = dataPage.at(-1);\n\n    if (!last) { return }\n\n    let lastDate = feedPostTime(last);\n    let daysBack = (startTime - lastDate) / 86400 / 1000;\n\n    this.progressBar.value = daysBack;\n  }\n\n  stopFetch() {\n    this.submitButton.value = 'Fetch timeline';\n    this.progressBar.style.display = 'none';\n    this.fetchStartTime = undefined;\n  }\n}\n",
    "import { $, $id } from './utils.js';\nimport { $tag } from './utils_ts.js';\nimport { getLocation, linkToPostById } from './utils.js';\nimport { BlueskyAPI } from './api.js';\nimport { Minisky } from './minisky.js';\nimport { Post } from './models.js';\nimport { PostComponent } from './post_component.js';\nimport { Menu } from './menu.js';\nimport { ThreadPage } from './thread_page.js';\nimport { PostingStatsPage } from './posting_stats_page.js';\nimport { NotificationsPage } from './notifications_page.js';\nimport { LikeStatsPage } from './like_stats_page.js';\nimport { PrivateSearchPage } from './private_search_page.js';\n\nfunction init() {\n  window.dateLocale = localStorage.getItem('locale') || undefined;\n  window.isIncognito = !!localStorage.getItem('incognito');\n  window.biohazardEnabled = JSON.parse(localStorage.getItem('biohazard') ?? 'null');\n\n  window.loginDialog = $(document.querySelector('#login'));\n\n  window.avatarPreloader = buildAvatarPreloader();\n\n  window.accountMenu = new Menu();\n  window.threadPage = new ThreadPage();\n  window.postingStatsPage = new PostingStatsPage();\n  window.likeStatsPage = new LikeStatsPage();\n  window.notificationsPage = new NotificationsPage();\n  window.privateSearchPage = new PrivateSearchPage();\n\n  $(document.querySelector('#search form')).addEventListener('submit', (e) => {\n    e.preventDefault();\n    submitSearch();\n  });\n\n  for (let dialog of document.querySelectorAll('.dialog')) {\n    let close = $(dialog.querySelector('.close'));\n\n    dialog.addEventListener('click', (e) => {\n      if (e.target === e.currentTarget && close && close.offsetHeight > 0) {\n        hideDialog(dialog);\n      } else {\n        e.stopPropagation();\n      }\n    });\n\n    close?.addEventListener('click', (e) => {\n      hideDialog(dialog);\n    });\n  }\n\n  $(document.querySelector('#login .info a')).addEventListener('click', (e) => {\n    e.preventDefault();\n    toggleLoginInfo();\n  });\n\n  $(document.querySelector('#login form')).addEventListener('submit', (e) => {\n    e.preventDefault();\n    submitLogin();\n  });\n\n  $(document.querySelector('#biohazard_show')).addEventListener('click', (e) => {\n    e.preventDefault();\n\n    window.biohazardEnabled = true;\n    localStorage.setItem('biohazard', 'true');\n\n    if (window.loadInfohazard) {\n      window.loadInfohazard();\n      window.loadInfohazard = undefined;\n    }\n\n    let target = $(e.target);\n\n    hideDialog(target.closest('.dialog'));\n  });\n\n  $(document.querySelector('#biohazard_hide')).addEventListener('click', (e) => {\n    e.preventDefault();\n\n    window.biohazardEnabled = false;\n    localStorage.setItem('biohazard', 'false');\n    accountMenu.toggleMenuButtonCheck('biohazard', false);\n\n    for (let p of document.querySelectorAll('p.hidden-replies, .content > .post.blocked, .blocked > .load-post')) {\n      $(p).style.display = 'none';\n    }\n\n    let target = $(e.target);\n\n    hideDialog(target.closest('.dialog'));\n  });\n\n  window.appView = new BlueskyAPI('api.bsky.app', false);\n  window.blueAPI = new BlueskyAPI('blue.mackuba.eu', false);\n  window.accountAPI = new BlueskyAPI(undefined, true);\n\n  if (accountAPI.isLoggedIn) {\n    accountAPI.host = accountAPI.user.pdsEndpoint;\n    accountMenu.hideMenuButton('login');\n\n    if (!isIncognito) {\n      window.api = accountAPI;\n      accountMenu.showLoggedInStatus(true, api.user.avatar);\n    } else {\n      window.api = appView;\n      accountMenu.showLoggedInStatus('incognito');\n      accountMenu.toggleMenuButtonCheck('incognito', true);\n    }\n  } else {\n    window.api = appView;\n    accountMenu.hideMenuButton('logout');\n    accountMenu.hideMenuButton('incognito');\n  }\n\n  accountMenu.toggleMenuButtonCheck('biohazard', window.biohazardEnabled !== false);\n\n  parseQueryParams();\n}\n\nfunction parseQueryParams() {\n  let params = new URLSearchParams(location.search);\n  let { q, author, post, quotes, hash, page } = Object.fromEntries(params);\n\n  if (quotes) {\n    showLoader();\n    loadQuotesPage(decodeURIComponent(quotes));\n  } else if (hash) {\n    showLoader();\n    loadHashtagPage(decodeURIComponent(hash));\n  } else if (q) {\n    showLoader();\n    threadPage.loadThreadByURL(decodeURIComponent(q));\n  } else if (author && post) {\n    showLoader();\n    threadPage.loadThreadById(decodeURIComponent(author), decodeURIComponent(post));\n  } else if (page) {\n    openPage(page);\n  } else {\n    showSearch();\n  }\n}\n\n/** @returns {IntersectionObserver} */\n\nfunction buildAvatarPreloader() {\n  return new IntersectionObserver((entries, observer) => {\n    for (const entry of entries) {\n      if (entry.isIntersecting) {\n        const img = entry.target;\n        img.removeAttribute('lazy');\n        observer.unobserve(img);\n      }\n    }\n  }, {\n    rootMargin: '1000px 0px'\n  });\n}\n\nfunction showLoader() {\n  $id('loader').style.display = 'block';\n}\n\nfunction hideLoader() {\n  $id('loader').style.display = 'none';\n}\n\nfunction showSearch() {\n  let search = $id('search');\n  let searchField = $(search.querySelector('input[type=text]'));\n\n  search.style.visibility = 'visible';\n  searchField.focus();\n}\n\nfunction hideSearch() {\n  $id('search').style.visibility = 'hidden';\n}\n\nfunction showDialog(dialog) {\n  dialog.style.visibility = 'visible';\n  $id('thread').classList.add('overlay');\n\n  dialog.querySelector('input[type=text]')?.focus();\n}\n\nfunction hideDialog(dialog) {\n  dialog.style.visibility = 'hidden';\n  dialog.classList.remove('expanded');\n  $id('thread').classList.remove('overlay');\n\n  for (let field of dialog.querySelectorAll('input[type=text]')) {\n    field.value = '';\n  }\n}\n\nfunction toggleDialog(dialog) {\n  if (dialog.style.visibility == 'visible') {\n    hideDialog(dialog);\n  } else {\n    showDialog(dialog);\n  }\n}\n\nfunction toggleLoginInfo() {\n  $id('login').classList.toggle('expanded');\n}\n\nfunction submitLogin() {\n  let handleField = $id('login_handle', HTMLInputElement);\n  let passwordField = $id('login_password', HTMLInputElement);\n  let submit = $id('login_submit');\n  let cloudy = $id('cloudy');\n  let close = $(loginDialog.querySelector('.close'));\n\n  if (submit.style.display == 'none') { return }\n\n  handleField.blur();\n  passwordField.blur();\n\n  submit.style.display = 'none';\n  cloudy.style.display = 'inline-block';\n\n  let handle = handleField.value.trim();\n  let password = passwordField.value.trim();\n\n  logIn(handle, password).then((pds) => {\n    window.api = pds;\n    window.accountAPI = pds;\n\n    hideDialog(loginDialog);\n    submit.style.display = 'inline';\n    cloudy.style.display = 'none';\n    close.style.display = 'inline';\n\n    accountMenu.loadCurrentUserAvatar();\n\n    accountMenu.showMenuButton('logout');\n    accountMenu.showMenuButton('incognito');\n    accountMenu.hideMenuButton('login');\n\n    let params = new URLSearchParams(location.search);\n    let page = params.get('page');\n    if (page) {\n      openPage(page);\n    }\n  })\n  .catch((error) => {\n    submit.style.display = 'inline';\n    cloudy.style.display = 'none';\n    console.log(error);\n\n    if (error.code == 401 && error.json.error == 'AuthFactorTokenRequired') {\n      alert(\"Please log in using an \\\"app password\\\" if you have 2FA enabled.\");\n    } else {\n      window.setTimeout(() => alert(error), 10);\n    }\n  });\n}\n\n/** @param {string} identifier, @param {string} password, @returns {Promise<BlueskyAPI>} */\n\nasync function logIn(identifier, password) {\n  let pdsEndpoint;\n\n  if (identifier.match(/^did:/)) {\n    pdsEndpoint = await Minisky.pdsEndpointForDid(identifier);\n  } else if (identifier.match(/^[^@]+@[^@]+$/)) {\n    pdsEndpoint = 'bsky.social';\n  } else if (identifier.match(/^@?[\\w\\-]+(\\.[\\w\\-]+)+$/)) {\n    identifier = identifier.replace(/^@/, '');\n    let did = await appView.resolveHandle(identifier);\n    pdsEndpoint = await Minisky.pdsEndpointForDid(did);\n  } else {\n    throw 'Please enter your handle or DID.';\n  }\n\n  let pds = new BlueskyAPI(pdsEndpoint, true);\n  await pds.logIn(identifier, password);\n  return pds;\n}\n\nfunction logOut() {\n  accountAPI.resetTokens();\n  localStorage.removeItem('incognito');\n  location.reload();\n}\n\nfunction submitSearch() {\n  let search = $id('search');\n  let searchField = $(search.querySelector('input[name=q]'), HTMLInputElement);\n  let url = searchField.value.trim();\n\n  if (!url) { return }\n\n  if (url.startsWith('at://')) {\n    let target = new URL(getLocation());\n    target.searchParams.set('q', url);\n    location.assign(target.toString());\n    return;\n  }\n\n  if (url.match(/^#?((\\p{Letter}|\\p{Number})+)$/u)) {\n    let target = new URL(getLocation());\n    target.searchParams.set('hash', encodeURIComponent(url.replace(/^#/, '')));\n    location.assign(target.toString());\n    return;\n  }\n\n  try {\n    let [handle, postId] = BlueskyAPI.parsePostURL(url);\n\n    let newURL = linkToPostById(handle, postId);\n    location.assign(newURL);\n  } catch (error) {\n    console.log(error);\n    alert(error.message || \"This is not a valid URL or hashtag\");\n  }\n}\n\n/** @param {string} page */\n\nfunction openPage(page) {\n  if (!accountAPI.isLoggedIn) {\n    showDialog(loginDialog);\n    $(loginDialog.querySelector('.close')).style.display = 'none';\n    return;\n  }\n\n  if (page == 'notif') {\n    window.notificationsPage.show();\n  } else if (page == 'posting_stats') {\n    window.postingStatsPage.show();\n  } else if (page == 'like_stats') {\n    window.likeStatsPage.show();\n  } else if (page == 'search') {\n    window.privateSearchPage.show();\n  }\n}\n\n/** @param {Post} post */\n\nfunction setPageTitle(post) {\n  document.title = `${post.author.displayName}: \"${post.text}\" - Skythread`;\n}\n\n/** @param {string} hashtag */\n\nfunction loadHashtagPage(hashtag) {\n  hashtag = hashtag.replace(/^\\#/, '');\n  document.title = `#${hashtag} - Skythread`;\n\n  let isLoading = false;\n  let firstPageLoaded = false;\n  let finished = false;\n  let cursor;\n\n  Paginator.loadInPages(() => {\n    if (isLoading || finished) { return; }\n    isLoading = true;\n\n    api.getHashtagFeed(hashtag, cursor).then(data => {\n      let posts = data.posts.map(j => new Post(j));\n\n      if (!firstPageLoaded) {\n        hideLoader();\n\n        let header = $tag('header');\n        let h2 = $tag('h2', {\n          text: (posts.length > 0) ? `Posts tagged: #${hashtag}` : `No posts tagged #${hashtag}.`\n        });\n        header.append(h2);\n\n        $id('thread').appendChild(header);\n        $id('thread').classList.add('hashtag');\n      }\n\n      for (let post of posts) {\n        let postView = new PostComponent(post, 'feed').buildElement();\n        $id('thread').appendChild(postView);\n      }\n\n      isLoading = false;\n      firstPageLoaded = true;\n      cursor = data.cursor;\n\n      if (!cursor || posts.length == 0) {\n        finished = true;\n      }\n    }).catch(error => {\n      hideLoader();\n      console.log(error);\n      isLoading = false;\n    });\n  });\n}\n\n/** @param {string} url */\n\nfunction loadQuotesPage(url) {\n  let isLoading = false;\n  let firstPageLoaded = false;\n  let cursor;\n  let finished = false;\n\n  Paginator.loadInPages(() => {\n    if (isLoading || finished) { return; }\n    isLoading = true;\n\n    blueAPI.getQuotes(url, cursor).then(data => {\n      api.loadPosts(data.posts).then(jsons => {\n        let posts = jsons.map(j => new Post(j));\n\n        if (!firstPageLoaded) {\n          hideLoader();\n\n          let header = $tag('header');\n          let h2;\n\n          if (data.quoteCount > 1) {\n            h2 = $tag('h2', { text: `${data.quoteCount} quotes:` });\n          } else if (data.quoteCount == 1) {\n            h2 = $tag('h2', { text: '1 quote:' });\n          } else {\n            h2 = $tag('h2', { text: 'No quotes found.' });\n          }\n\n          header.append(h2);\n          $id('thread').appendChild(header);\n          $id('thread').classList.add('quotes');\n        }\n\n        for (let post of posts) {\n          let postView = new PostComponent(post, 'quotes').buildElement();\n          $id('thread').appendChild(postView);\n        }\n\n        isLoading = false;\n        firstPageLoaded = true;\n        cursor = data.cursor;\n\n        if (!cursor || posts.length == 0) {\n          finished = true;\n        }\n      }).catch(error => {\n        hideLoader();\n        console.log(error);\n        isLoading = false;\n      })\n    }).catch(error => {\n      hideLoader();\n      console.log(error);\n      isLoading = false;\n    });\n  });\n}\n\nwindow.init = init;\nwindow.BlueskyAPI = BlueskyAPI;\n\nexport { setPageTitle, showDialog, showLoader, hideLoader, logOut };\n"
  ],
  "mappings": "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",
  "debugId": "214CA55974B1DB5F64756E2164756E21",
  "names": []
}