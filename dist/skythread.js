(()=>{var m=!1;var H5=Array.isArray,aJ=Array.prototype.indexOf,U5=Array.prototype.includes,o6=Array.from,D7=Object.keys,V1=Object.defineProperty,S1=Object.getOwnPropertyDescriptor,Mz=Object.getOwnPropertyDescriptors,R7=Object.prototype,rJ=Array.prototype,M6=Object.getPrototypeOf,A7=Object.isExtensible;function C6(z){return typeof z==="function"}var J5=()=>{};function N7(z){return typeof z?.then==="function"}function nJ(z){return z()}function a6(z){for(var J=0;J<z.length;J++)z[J]()}function Cz(){var z,J,Q=new Promise((K,X)=>{z=K,J=X});return{promise:Q,resolve:z,reject:J}}var v0=2,O6=4,t5=8,P6=16777216,h1=16,k1=32,Q5=64,L6=128,j1=512,u0=1024,g0=2048,w1=4096,D1=8192,b1=16384,V5=32768,T1=65536,I6=131072,r6=262144,I5=524288,k7=1048576,S5=33554432,K5=32768,Oz=2097152,f5=4194304,Z5=8388608,e0=Symbol("$state"),n6=Symbol("legacy props"),tJ=Symbol(""),Pz=Symbol("proxy path"),j5=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};var t6=3,R1=8;function Lz(z){if(m){let J=Error(`lifecycle_outside_component
\`${z}(...)\` can only be used during component initialisation
https://svelte.dev/e/lifecycle_outside_component`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/lifecycle_outside_component")}function eJ(){if(m){let z=Error(`missing_context
Context was not set in a parent component
https://svelte.dev/e/missing_context`);throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/missing_context")}function zQ(){if(m){let z=Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/async_derived_orphan")}function b7(){if(m){let z=Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/bind_invalid_checkbox_value")}function JQ(){if(m){let z=Error(`derived_references_self
A derived value cannot reference itself recursively
https://svelte.dev/e/derived_references_self`);throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/derived_references_self")}function QQ(z){if(m){let J=Error(`effect_in_teardown
\`${z}\` cannot be used inside an effect cleanup function
https://svelte.dev/e/effect_in_teardown`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/effect_in_teardown")}function KQ(){if(m){let z=Error("effect_in_unowned_derived\nEffect cannot be created inside a `$derived` value that was not itself created inside an effect\nhttps://svelte.dev/e/effect_in_unowned_derived");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/effect_in_unowned_derived")}function ZQ(z){if(m){let J=Error(`effect_orphan
\`${z}\` can only be used inside an effect (e.g. during component initialisation)
https://svelte.dev/e/effect_orphan`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/effect_orphan")}function XQ(){if(m){let z=Error(`effect_update_depth_exceeded
Maximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state
https://svelte.dev/e/effect_update_depth_exceeded`);throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wQ(){if(m){let z=Error(`hydration_failed
Failed to hydrate the application
https://svelte.dev/e/hydration_failed`);throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/hydration_failed")}function WQ(){if(m){let z=Error("invalid_snippet\nCould not `{@render}` snippet due to the expression being `null` or `undefined`. Consider using optional chaining `{@render snippet?.()}`\nhttps://svelte.dev/e/invalid_snippet");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/invalid_snippet")}function YQ(z){if(m){let J=Error(`props_invalid_value
Cannot do \`bind:${z}={undefined}\` when \`${z}\` has a fallback value
https://svelte.dev/e/props_invalid_value`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/props_invalid_value")}function GQ(z){if(m){let J=Error(`props_rest_readonly
Rest element properties of \`$props()\` such as \`${z}\` are readonly
https://svelte.dev/e/props_rest_readonly`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/props_rest_readonly")}function BQ(z){if(m){let J=Error(`rune_outside_svelte
The \`${z}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files
https://svelte.dev/e/rune_outside_svelte`);throw J.name="Svelte error",J}else throw Error("https://svelte.dev/e/rune_outside_svelte")}function HQ(){if(m){let z=Error("set_context_after_init\n`setContext` must be called when a component first initializes, not in a subsequent effect or after an `await` expression\nhttps://svelte.dev/e/set_context_after_init");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/set_context_after_init")}function UQ(){if(m){let z=Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/state_descriptors_fixed")}function VQ(){if(m){let z=Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/state_prototype_fixed")}function qQ(){if(m){let z=Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/state_unsafe_mutation")}function FQ(){if(m){let z=Error("svelte_boundary_reset_onerror\nA `<svelte:boundary>` `reset` function cannot be called while an error is still being handled\nhttps://svelte.dev/e/svelte_boundary_reset_onerror");throw z.name="Svelte error",z}else throw Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}var xQ=1,MQ=2,T7=4,CQ=8,OQ=16,PQ=1,LQ=2,IQ=4,SQ=8,jQ=16;var DQ=1,RQ=2;var b8="[",q5="[!",S6="]",D5={};var b0=Symbol(),m1=Symbol("filename"),AQ=Symbol("hmr"),NQ="http://www.w3.org/1999/xhtml";var E7="@attach";var $5="font-weight: bold",u5="font-weight: normal";function kQ(z,J){if(m)console.warn(`%c[svelte] await_waterfall
%cAn async derived, \`${z}\` (${J}) was not read immediately after it resolved. This often indicates an unnecessary waterfall, which can slow down your app
https://svelte.dev/e/await_waterfall`,$5,u5);else console.warn("https://svelte.dev/e/await_waterfall")}function bQ(z,J,Q){if(m)console.warn(`%c[svelte] hydration_attribute_changed
%cThe \`${z}\` attribute on \`${J}\` changed its value between server and client renders. The client value, \`${Q}\`, will be ignored in favour of the server value
https://svelte.dev/e/hydration_attribute_changed`,$5,u5);else console.warn("https://svelte.dev/e/hydration_attribute_changed")}function TQ(z){if(m)console.warn(`%c[svelte] hydration_html_changed
%c${z?`The value of an \`{@html ...}\` block ${z} changed between server and client renders. The client value will be ignored in favour of the server value`:"The value of an `{@html ...}` block changed between server and client renders. The client value will be ignored in favour of the server value"}
https://svelte.dev/e/hydration_html_changed`,$5,u5);else console.warn("https://svelte.dev/e/hydration_html_changed")}function e5(z){if(m)console.warn(`%c[svelte] hydration_mismatch
%c${z?`Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near ${z}`:"Hydration failed because the initial UI does not match what was rendered on the server"}
https://svelte.dev/e/hydration_mismatch`,$5,u5);else console.warn("https://svelte.dev/e/hydration_mismatch")}function EQ(){if(m)console.warn(`%c[svelte] lifecycle_double_unmount
%cTried to unmount a component that was not mounted
https://svelte.dev/e/lifecycle_double_unmount`,$5,u5);else console.warn("https://svelte.dev/e/lifecycle_double_unmount")}function yQ(){if(m)console.warn("%c[svelte] select_multiple_invalid_value\n%cThe `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\nhttps://svelte.dev/e/select_multiple_invalid_value",$5,u5);else console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Iz(z){if(m)console.warn(`%c[svelte] state_proxy_equality_mismatch
%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${z}\` will produce unexpected results
https://svelte.dev/e/state_proxy_equality_mismatch`,$5,u5);else console.warn("https://svelte.dev/e/state_proxy_equality_mismatch")}function vQ(){if(m)console.warn(`%c[svelte] state_proxy_unmount
%cTried to unmount a state proxy, rather than a component
https://svelte.dev/e/state_proxy_unmount`,$5,u5);else console.warn("https://svelte.dev/e/state_proxy_unmount")}function gQ(){if(m)console.warn("%c[svelte] svelte_boundary_reset_noop\n%cA `<svelte:boundary>` `reset` function only resets the boundary the first time it is called\nhttps://svelte.dev/e/svelte_boundary_reset_noop",$5,u5);else console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}var r=!1;function h0(z){r=z}var U0;function R0(z){if(z===null)throw e5(),D5;return U0=z}function s0(){return R0(o0(U0))}function C(z){if(!r)return;if(o0(U0)!==null)throw e5(),D5;U0=z}function z1(z=1){if(r){var J=z,Q=U0;while(J--)Q=o0(Q);U0=Q}}function R5(z=!0){var J=0,Q=U0;while(!0){if(Q.nodeType===R1){var K=Q.data;if(K===S6){if(J===0)return Q;J-=1}else if(K===b8||K===q5)J+=1}var X=o0(Q);if(z)Q.remove();Q=X}}function Sz(z){if(!z||z.nodeType!==R1)throw e5(),D5;return z.data}function jz(z){return z===this.v}function y7(z,J){return z!=z?J==J:z!==J||z!==null&&typeof z==="object"||typeof z==="function"}function Dz(z){return!y7(z,this.v)}var F1=!1,l5=!1,F5=!1;function hQ(){l5=!0}var T8=null;function f1(z,J){return z.label=J,Rz(z.v,J),z}function Rz(z,J){return z?.[Pz]?.(J),z}function A5(z){let J=Error(),Q=TK();if(Q.length===0)return null;return Q.unshift(`
`),V1(J,"stack",{value:Q.join(`
`)}),V1(J,"name",{value:z}),J}function TK(){let z=Error.stackTraceLimit;Error.stackTraceLimit=1/0;let J=Error().stack;if(Error.stackTraceLimit=z,!J)return[];let Q=J.split(`
`),K=[];for(let X=0;X<Q.length;X++){let Z=Q[X],w=Z.replaceAll("\\","/");if(Z.trim()==="Error")continue;if(Z.includes("validate_each_keys"))return[];if(w.includes("svelte/src/internal")||w.includes("node_modules/.vite"))continue;K.push(Z)}return K}var L0=null;function p5(z){L0=z}var x5=null;function e6(z){x5=z}var c1=null;function Az(z){c1=z}function g7(){let z={};return[()=>{if(!uQ(z))eJ();return fQ(z)},(J)=>$Q(z,J)]}function fQ(z){return h7("getContext").get(z)}function $Q(z,J){let Q=h7("setContext");if(F1){var K=Q0.f,X=!w0&&(K&k1)!==0&&!L0.i;if(!X)HQ()}return Q.set(z,J),J}function uQ(z){return h7("hasContext").has(z)}function _(z,J=!1,Q){if(L0={p:L0,i:!1,c:null,e:null,s:z,x:null,l:l5&&!J?{s:null,u:null,$:[]}:null},m)L0.function=Q,c1=Q}function c(z){var J=L0,Q=J.e;if(Q!==null){J.e=null;for(var K of Q)m7(K)}if(z!==void 0)J.x=z;if(J.i=!0,L0=J.p,m)c1=L0?.function??null;return z??{}}function s1(){return!l5||L0!==null&&L0.l===null}function h7(z){if(L0===null)Lz(z);return L0.c??=new Map(EK(L0)||void 0)}function EK(z){let J=z.p;while(J!==null){let Q=J.c;if(Q!==null)return Q;J=J.p}return null}var j6=[];function lQ(){var z=j6;j6=[],a6(z)}function m0(z){if(j6.length===0&&!J6){var J=j6;queueMicrotask(()=>{if(J===j6)lQ()})}j6.push(z)}function pQ(){while(j6.length>0)lQ()}var f7=new WeakMap;function Nz(z){var J=Q0;if(J===null)return w0.f|=Z5,z;if(m&&z instanceof Error&&!f7.has(z))f7.set(z,yK(z,J));if((J.f&V5)===0){if((J.f&L6)===0){if(m&&!J.parent&&z instanceof Error)dQ(z);throw z}J.b.error(z)}else N5(z,J)}function N5(z,J){while(J!==null){if((J.f&L6)!==0)try{J.b.error(z);return}catch(Q){z=Q}J=J.parent}if(m&&z instanceof Error)dQ(z);throw z}function yK(z,J){let Q=S1(z,"message");if(Q&&!Q.configurable)return;var K=E8?"  ":"\t",X=`
${K}in ${J.fn?.name||"<unknown>"}`,Z=J.ctx;while(Z!==null)X+=`
${K}in ${Z.function?.[m1].split("/").pop()}`,Z=Z.p;return{message:z.message+`
${X}
`,stack:z.stack?.split(`
`).filter((w)=>!w.includes("svelte/src/internal")).join(`
`)}}function dQ(z){let J=f7.get(z);if(J)V1(z,"message",{value:J.message}),V1(z,"stack",{value:J.stack})}var vK=~(g0|w1|u0);function E0(z,J){z.f=z.f&vK|J}function z8(z){if((z.f&j1)!==0||z.deps===null)E0(z,u0);else E0(z,w1)}function iQ(z){if(z===null)return;for(let J of z){if((J.f&v0)===0||(J.f&K5)===0)continue;J.f^=K5,iQ(J.deps)}}function kz(z,J,Q){if((z.f&g0)!==0)J.add(z);else if((z.f&w1)!==0)Q.add(z);iQ(z.deps),E0(z,u0)}var J8=new Set,F0=null,Q8=null,x1=null,o1=[],bz=null,$7=!1,J6=!1;class J1{committed=!1;current=new Map;previous=new Map;#z=new Set;#J=new Set;#Q=0;#Z=0;#w=null;#X=new Set;#K=new Set;skipped_effects=new Set;is_fork=!1;#W=!1;is_deferred(){return this.is_fork||this.#Z>0}process(z){o1=[],this.apply();var J=[],Q=[];for(let K of z)this.#Y(K,J,Q);if(this.is_deferred())this.#G(Q),this.#G(J);else{for(let K of this.#z)K();if(this.#z.clear(),this.#Q===0)this.#H();Q8=this,F0=null,_Q(Q),_Q(J),Q8=null,this.#w?.resolve()}x1=null}#Y(z,J,Q){z.f^=u0;var K=z.first,X=null;while(K!==null){var Z=K.f,w=(Z&(k1|Q5))!==0,G=w&&(Z&u0)!==0,H=G||(Z&D1)!==0||this.skipped_effects.has(K);if(F1&&X===null&&(Z&L6)!==0&&K.b?.is_pending)X=K;if(!H&&K.fn!==null){if(w)K.f^=u0;else if(X!==null&&(Z&(O6|t5|P6))!==0)X.b.defer_effect(K);else if((Z&O6)!==0)J.push(K);else if(F1&&(Z&(t5|P6))!==0)Q.push(K);else if(Z6(K)){if((Z&h1)!==0)this.#K.add(K);Q6(K)}var B=K.first;if(B!==null){K=B;continue}}var F=K.parent;K=K.next;while(K===null&&F!==null){if(F===X)X=null;K=F.next,F=F.parent}}}#G(z){for(var J=0;J<z.length;J+=1)kz(z[J],this.#X,this.#K)}capture(z,J){if(J!==b0&&!this.previous.has(z))this.previous.set(z,J);if((z.f&Z5)===0)this.current.set(z,z.v),x1?.set(z,z.v)}activate(){F0=this,this.apply()}deactivate(){if(F0!==this)return;F0=null,x1=null}flush(){if(this.activate(),o1.length>0){if(u7(),F0!==null&&F0!==this)return}else if(this.#Q===0)this.process([]);this.deactivate()}discard(){for(let z of this.#J)z(this);this.#J.clear()}#H(){if(J8.size>1){this.previous.clear();var z=x1,J=!0;for(let K of J8){if(K===this){J=!1;continue}let X=[];for(let[w,G]of this.current){if(K.current.has(w))if(J&&G!==K.current.get(w))K.current.set(w,G);else continue;X.push(w)}if(X.length===0)continue;let Z=[...K.current.keys()].filter((w)=>!this.current.has(w));if(Z.length>0){var Q=o1;o1=[];let w=new Set,G=new Map;for(let H of X)cQ(H,Z,w,G);if(o1.length>0){F0=K,K.apply();for(let H of o1)K.#Y(H,[],[]);K.deactivate()}o1=Q}}F0=null,x1=z}this.committed=!0,J8.delete(this)}increment(z){if(this.#Q+=1,z)this.#Z+=1}decrement(z){if(this.#Q-=1,z)this.#Z-=1;if(this.#W)return;this.#W=!0,m0(()=>{if(this.#W=!1,!this.is_deferred())this.revive();else if(o1.length>0)this.flush()})}revive(){for(let z of this.#X)this.#K.delete(z),E0(z,g0),a1(z);for(let z of this.#K)E0(z,w1),a1(z);this.flush()}oncommit(z){this.#z.add(z)}ondiscard(z){this.#J.add(z)}settled(){return(this.#w??=Cz()).promise}static ensure(){if(F0===null){let z=F0=new J1;if(J8.add(F0),!J6)m0(()=>{if(F0!==z)return;z.flush()})}return F0}apply(){if(!F1||!this.is_fork&&J8.size===1)return;x1=new Map(this.current);for(let z of J8){if(z===this)continue;for(let[J,Q]of z.previous)if(!x1.has(J))x1.set(J,Q)}}}function K6(z){var J=J6;J6=!0;try{var Q;if(z){if(F0!==null)u7();Q=z()}while(!0){if(pQ(),o1.length===0){if(F0?.flush(),o1.length===0)return bz=null,Q}u7()}}finally{J6=J}}function u7(){$7=!0;var z=m?new Set:null;try{var J=0;while(o1.length>0){var Q=J1.ensure();if(J++>1000){if(m){var K=new Map;for(let Z of Q.current.keys())for(let[w,G]of Z.updated??[]){var X=K.get(w);if(!X)X={error:G.error,count:0},K.set(w,X);X.count+=G.count}for(let Z of K.values())if(Z.error)console.error(Z.error)}hK()}if(Q.process(o1),k5.clear(),m)for(let Z of Q.current.keys())z.add(Z)}}finally{if($7=!1,bz=null,m)for(let Z of z)Z.updated=null}}function hK(){try{XQ()}catch(z){if(m)V1(z,"stack",{value:""});N5(z,bz)}}var X5=null;function _Q(z){var J=z.length;if(J===0)return;var Q=0;while(Q<J){var K=z[Q++];if((K.f&(b1|D1))===0&&Z6(K)){if(X5=new Set,Q6(K),K.deps===null&&K.first===null&&K.nodes===null)if(K.teardown===null&&K.ac===null)l7(K);else K.fn=null;if(X5?.size>0){k5.clear();for(let X of X5){if((X.f&(b1|D1))!==0)continue;let Z=[X],w=X.parent;while(w!==null){if(X5.has(w))X5.delete(w),Z.push(w);w=w.parent}for(let G=Z.length-1;G>=0;G--){let H=Z[G];if((H.f&(b1|D1))!==0)continue;Q6(H)}}X5.clear()}}}X5=null}function cQ(z,J,Q,K){if(Q.has(z))return;if(Q.add(z),z.reactions!==null)for(let X of z.reactions){let Z=X.f;if((Z&v0)!==0)cQ(X,J,Q,K);else if((Z&(f5|h1))!==0&&(Z&g0)===0&&sQ(X,J,K))E0(X,g0),a1(X)}}function sQ(z,J,Q){let K=Q.get(z);if(K!==void 0)return K;if(z.deps!==null)for(let X of z.deps){if(U5.call(J,X))return!0;if((X.f&v0)!==0&&sQ(X,J,Q))return Q.set(X,!0),!0}return Q.set(z,!1),!1}function a1(z){var J=bz=z;while(J.parent!==null){J=J.parent;var Q=J.f;if($7&&J===Q0&&(Q&h1)!==0&&(Q&r6)===0)return;if((Q&(Q5|k1))!==0){if((Q&u0)===0)return;J.f^=u0}}o1.push(J)}function aQ(z){let J=0,Q=W1(0),K;if(m)f1(Q,"createSubscriber version");return()=>{if(z6())W(Q),Y1(()=>{if(J===0)K=T0(()=>z(()=>D6(Q)));return J+=1,()=>{m0(()=>{if(J-=1,J===0)K?.(),K=void 0,D6(Q)})}})}}var fK=T1|I5|L6;function p7(z,J,Q){new d7(z,J,Q)}class d7{parent;is_pending=!1;#z;#J=r?U0:null;#Q;#Z;#w;#X=null;#K=null;#W=null;#Y=null;#G=null;#H=0;#U=0;#q=!1;#V=!1;#F=new Set;#x=new Set;#B=null;#L=aQ(()=>{if(this.#B=W1(this.#H),m)f1(this.#B,"$effect.pending()");return()=>{this.#B=null}});constructor(z,J,Q){if(this.#z=z,this.#Q=J,this.#Z=Q,this.parent=Q0.b,this.is_pending=!!this.#Q.pending,this.#w=M1(()=>{if(Q0.b=this,r){let X=this.#J;if(s0(),X.nodeType===R1&&X.data===q5)this.#S();else if(this.#I(),this.#U===0)this.is_pending=!1}else{var K=this.#O();try{this.#X=a0(()=>Q(K))}catch(X){this.error(X)}if(this.#U>0)this.#C();else this.is_pending=!1}return()=>{this.#G?.remove()}},fK),r)this.#z=U0}#I(){try{this.#X=a0(()=>this.#Z(this.#z))}catch(z){this.error(z)}}#S(){let z=this.#Q.pending;if(!z)return;this.#K=a0(()=>z(this.#z)),m0(()=>{var J=this.#O();if(this.#X=this.#M(()=>{return J1.ensure(),a0(()=>this.#Z(J))}),this.#U>0)this.#C();else b5(this.#K,()=>{this.#K=null}),this.is_pending=!1})}#O(){var z=this.#z;if(this.is_pending)this.#G=d0(),this.#z.before(this.#G),z=this.#G;return z}defer_effect(z){kz(z,this.#F,this.#x)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#Q.pending}#M(z){var J=Q0,Q=w0,K=L0;G1(this.#w),i0(this.#w),p5(this.#w.ctx);try{return z()}catch(X){return Nz(X),null}finally{G1(J),i0(Q),p5(K)}}#C(){let z=this.#Q.pending;if(this.#X!==null)this.#Y=document.createDocumentFragment(),this.#Y.append(this.#G),yz(this.#X,this.#Y);if(this.#K===null)this.#K=a0(()=>z(this.#z))}#P(z){if(!this.has_pending_snippet()){if(this.parent)this.parent.#P(z);return}if(this.#U+=z,this.#U===0){this.is_pending=!1;for(let J of this.#F)E0(J,g0),a1(J);for(let J of this.#x)E0(J,w1),a1(J);if(this.#F.clear(),this.#x.clear(),this.#K)b5(this.#K,()=>{this.#K=null});if(this.#Y)this.#z.before(this.#Y),this.#Y=null}}update_pending_count(z){if(this.#P(z),this.#H+=z,!this.#B||this.#q)return;this.#q=!0,m0(()=>{if(this.#q=!1,this.#B)$1(this.#B,this.#H)})}get_effect_pending(){return this.#L(),W(this.#B)}error(z){var J=this.#Q.onerror;let Q=this.#Q.failed;if(this.#V||!J&&!Q)throw z;if(this.#X)f0(this.#X),this.#X=null;if(this.#K)f0(this.#K),this.#K=null;if(this.#W)f0(this.#W),this.#W=null;if(r)R0(this.#J),z1(),R0(R5());var K=!1,X=!1;let Z=()=>{if(K){gQ();return}if(K=!0,X)FQ();if(J1.ensure(),this.#H=0,this.#W!==null)b5(this.#W,()=>{this.#W=null});if(this.is_pending=this.has_pending_snippet(),this.#X=this.#M(()=>{return this.#V=!1,a0(()=>this.#Z(this.#z))}),this.#U>0)this.#C();else this.is_pending=!1};var w=w0;try{i0(null),X=!0,J?.(z,Z),X=!1}catch(G){N5(G,this.#w&&this.#w.parent)}finally{i0(w)}if(Q)m0(()=>{this.#W=this.#M(()=>{J1.ensure(),this.#V=!0;try{return a0(()=>{Q(this.#z,()=>z,()=>Z)})}catch(G){return N5(G,this.#w.parent),null}finally{this.#V=!1}})})}}function Z8(z,J,Q,K){let X=s1()?X6:R6;var Z=z.filter((Y)=>!Y.settled);if(Q.length===0&&Z.length===0){K(J.map(X));return}var w=F0,G=Q0,H=i7(),B=Z.length===1?Z[0].promise:Z.length>1?Promise.all(Z.map((Y)=>Y.promise)):null;function F(Y){H();try{K(Y)}catch(U){if((G.f&b1)===0)N5(U,G)}w?.deactivate(),X8()}if(Q.length===0){B.then(()=>F(J.map(X)));return}function q(){H(),Promise.all(Q.map((Y)=>c7(Y))).then((Y)=>F([...J.map(X),...Y])).catch((Y)=>N5(Y,G))}if(B)B.then(q);else q()}function i7(){var z=Q0,J=w0,Q=L0,K=F0;if(m)var X=x5;return function(w=!0){if(G1(z),i0(J),p5(Q),w)K?.activate();if(m)_7(null),e6(X)}}function X8(){if(G1(null),i0(null),p5(null),m)_7(null),e6(null)}var v8=null;function _7(z){v8=z}var g8=new Set;function X6(z){var J=v0|g0,Q=w0!==null&&(w0.f&v0)!==0?w0:null;if(Q0!==null)Q0.f|=I5;let K={ctx:L0,deps:null,effects:null,equals:jz,f:J,fn:z,reactions:null,rv:0,v:b0,wv:0,parent:Q??Q0,ac:null};if(m&&F5)K.created=A5("created at");return K}function c7(z,J,Q){let K=Q0;if(K===null)zQ();var X=K.b,Z=void 0,w=W1(b0);if(m)w.label=J;var G=!w0,H=new Map;if(rQ(()=>{if(m)v8=Q0;var B=Cz();Z=B.promise;try{Promise.resolve(z()).then(B.resolve,B.reject).then(()=>{if(F===F0&&F.committed)F.deactivate();X8()})}catch(U){B.reject(U),X8()}if(m)v8=null;var F=F0;if(G){var q=X.is_rendered();X.update_pending_count(1),F.increment(q),H.get(F)?.reject(j5),H.delete(F),H.set(F,B)}let Y=(U,x=void 0)=>{if(v8=null,F.activate(),x){if(x!==j5)w.f|=Z5,$1(w,x)}else{if((w.f&Z5)!==0)w.f^=Z5;$1(w,U);for(let[I,M]of H){if(H.delete(I),I===F)break;M.reject(j5)}if(m&&Q!==void 0)g8.add(w),setTimeout(()=>{if(g8.has(w))kQ(w.label,Q),g8.delete(w)})}if(G)X.update_pending_count(-1),F.decrement(q)};B.promise.then(Y,(U)=>Y(null,U||"unknown"))}),B1(()=>{for(let B of H.values())B.reject(j5)}),m)w.f|=f5;return new Promise((B)=>{function F(q){function Y(){if(q===Z)B(w);else F(Z)}q.then(Y,Y)}F(Z)})}function M0(z){let J=X6(z);if(!F1)hz(J);return J}function R6(z){let J=X6(z);return J.equals=Dz,J}function vz(z){var J=z.effects;if(J!==null){z.effects=null;for(var Q=0;Q<J.length;Q+=1)f0(J[Q])}}var s7=[];function lK(z){var J=z.parent;while(J!==null){if((J.f&v0)===0)return(J.f&b1)===0?J:null;J=J.parent}return null}function h8(z){var J,Q=Q0;if(G1(lK(z)),m){let K=A6;Tz(new Set);try{if(U5.call(s7,z))JQ();s7.push(z),z.f&=~K5,vz(z),J=gz(z)}finally{G1(Q),Tz(K),s7.pop()}}else try{z.f&=~K5,vz(z),J=gz(z)}finally{G1(Q)}return J}function o7(z){var J=h8(z);if(!z.equals(J)){if(z.wv=K8(),!F0?.is_fork||z.deps===null){if(z.v=J,z.deps===null){E0(z,u0);return}}}if(w5)return;if(x1!==null){if(z6()||F0?.is_fork)x1.set(z,J)}else z8(z)}var A6=new Set,k5=new Map;function Tz(z){A6=z}var a7=!1;function nQ(){a7=!0}function W1(z,J){var Q={f:0,v:z,reactions:null,equals:jz,rv:0,wv:0};if(m&&F5)Q.created=J??A5("created at"),Q.updated=null,Q.set_during_effect=!1,Q.trace=null;return Q}function f(z,J){let Q=W1(z,J);return hz(Q),Q}function d5(z,J=!1,Q=!0){let K=W1(z);if(!J)K.equals=Dz;if(l5&&Q&&L0!==null&&L0.l!==null)(L0.l.s??=[]).push(K);return K}function D(z,J,Q=!1){if(w0!==null&&(!u1||(w0.f&I6)!==0)&&s1()&&(w0.f&(v0|h1|f5|I6))!==0&&(r1===null||!U5.call(r1,z)))qQ();let K=Q?C0(J):J;if(m)Rz(K,z.label);return $1(z,K)}function $1(z,J){if(!z.equals(J)){var Q=z.v;if(w5)k5.set(z,J);else k5.set(z,Q);z.v=J;var K=J1.ensure();if(K.capture(z,Q),m){if(F5||Q0!==null){z.updated??=new Map;let X=(z.updated.get("")?.count??0)+1;if(z.updated.set("",{error:null,count:X}),F5||X>5){let Z=A5("updated at");if(Z!==null){let w=z.updated.get(Z.stack);if(!w)w={error:Z,count:0},z.updated.set(Z.stack,w);w.count++}}}if(Q0!==null)z.set_during_effect=!0}if((z.f&v0)!==0){let X=z;if((z.f&g0)!==0)h8(X);z8(X)}if(z.wv=K8(),tQ(z,g0),s1()&&Q0!==null&&(Q0.f&u0)!==0&&(Q0.f&(k1|Q5))===0)if(n1===null)eQ([z]);else n1.push(z);if(!K.is_fork&&A6.size>0&&!a7)Ez()}return J}function Ez(){a7=!1;for(let z of A6){if((z.f&u0)!==0)E0(z,w1);if(Z6(z))Q6(z)}A6.clear()}function D6(z){D(z,z.v+1)}function tQ(z,J){var Q=z.reactions;if(Q===null)return;var K=s1(),X=Q.length;for(var Z=0;Z<X;Z++){var w=Q[Z],G=w.f;if(!K&&w===Q0)continue;if(m&&(G&I6)!==0){A6.add(w);continue}var H=(G&g0)===0;if(H)E0(w,J);if((G&v0)!==0){var B=w;if(x1?.delete(B),(G&K5)===0){if(G&j1)w.f|=K5;tQ(B,w1)}}else if(H){if((G&h1)!==0&&X5!==null)X5.add(w);a1(w)}}}var pK=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function C0(z){if(typeof z!=="object"||z===null||e0 in z)return z;let J=M6(z);if(J!==R7&&J!==rJ)return z;var Q=new Map,K=H5(z),X=f(0),Z=m&&F5?A5("created at"):null,w=w6,G=(q)=>{if(w6===w)return q();var Y=w0,U=w6;i0(null),r7(w);var x=q();return i0(Y),r7(U),x};if(K){if(Q.set("length",f(z.length,Z)),m)z=iK(z)}var H="";let B=!1;function F(q){if(B)return;B=!0,H=q,f1(X,`${H} version`);for(let[Y,U]of Q)f1(U,N6(H,Y));B=!1}return new Proxy(z,{defineProperty(q,Y,U){if(!("value"in U)||U.configurable===!1||U.enumerable===!1||U.writable===!1)UQ();var x=Q.get(Y);if(x===void 0)x=G(()=>{var I=f(U.value,Z);if(Q.set(Y,I),m&&typeof Y==="string")f1(I,N6(H,Y));return I});else D(x,U.value,!0);return!0},deleteProperty(q,Y){var U=Q.get(Y);if(U===void 0){if(Y in q){let x=G(()=>f(b0,Z));if(Q.set(Y,x),D6(X),m)f1(x,N6(H,Y))}}else D(U,b0),D6(X);return!0},get(q,Y,U){if(Y===e0)return z;if(m&&Y===Pz)return F;var x=Q.get(Y),I=Y in q;if(x===void 0&&(!I||S1(q,Y)?.writable))x=G(()=>{var A=C0(I?q[Y]:b0),E=f(A,Z);if(m)f1(E,N6(H,Y));return E}),Q.set(Y,x);if(x!==void 0){var M=W(x);return M===b0?void 0:M}return Reflect.get(q,Y,U)},getOwnPropertyDescriptor(q,Y){var U=Reflect.getOwnPropertyDescriptor(q,Y);if(U&&"value"in U){var x=Q.get(Y);if(x)U.value=W(x)}else if(U===void 0){var I=Q.get(Y),M=I?.v;if(I!==void 0&&M!==b0)return{enumerable:!0,configurable:!0,value:M,writable:!0}}return U},has(q,Y){if(Y===e0)return!0;var U=Q.get(Y),x=U!==void 0&&U.v!==b0||Reflect.has(q,Y);if(U!==void 0||Q0!==null&&(!x||S1(q,Y)?.writable)){if(U===void 0)U=G(()=>{var M=x?C0(q[Y]):b0,A=f(M,Z);if(m)f1(A,N6(H,Y));return A}),Q.set(Y,U);var I=W(U);if(I===b0)return!1}return x},set(q,Y,U,x){var I=Q.get(Y),M=Y in q;if(K&&Y==="length")for(var A=U;A<I.v;A+=1){var E=Q.get(A+"");if(E!==void 0)D(E,b0);else if(A in q){if(E=G(()=>f(b0,Z)),Q.set(A+"",E),m)f1(E,N6(H,A))}}if(I===void 0){if(!M||S1(q,Y)?.writable){if(I=G(()=>f(void 0,Z)),m)f1(I,N6(H,Y));D(I,C0(U)),Q.set(Y,I)}}else{M=I.v!==b0;var v=G(()=>C0(U));D(I,v)}var T=Reflect.getOwnPropertyDescriptor(q,Y);if(T?.set)T.set.call(x,U);if(!M){if(K&&typeof Y==="string"){var y=Q.get("length"),N=Number(Y);if(Number.isInteger(N)&&N>=y.v)D(y,N+1)}D6(X)}return!0},ownKeys(q){W(X);var Y=Reflect.ownKeys(q).filter((I)=>{var M=Q.get(I);return M===void 0||M.v!==b0});for(var[U,x]of Q)if(x.v!==b0&&!(U in q))Y.push(U);return Y},setPrototypeOf(){VQ()}})}function N6(z,J){if(typeof J==="symbol")return`${z}[Symbol(${J.description??""})]`;if(pK.test(J))return`${z}.${J}`;return/^\d+$/.test(J)?`${z}[${J}]`:`${z}['${J}']`}function w8(z){try{if(z!==null&&typeof z==="object"&&e0 in z)return z[e0]}catch{}return z}function mz(z,J){return Object.is(w8(z),w8(J))}var dK=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);function iK(z){return new Proxy(z,{get(J,Q,K){var X=Reflect.get(J,Q,K);if(!dK.has(Q))return X;return function(...Z){nQ();var w=X.apply(this,Z);return Ez(),w}}})}function z4(){let{prototype:z,__svelte_cleanup:J}=Array;if(J)J();let{indexOf:Q,lastIndexOf:K,includes:X}=z;z.indexOf=function(Z,w){let G=Q.call(this,Z,w);if(G===-1){for(let H=w??0;H<this.length;H+=1)if(w8(this[H])===Z){Iz("array.indexOf(...)");break}}return G},z.lastIndexOf=function(Z,w){let G=K.call(this,Z,w??this.length-1);if(G===-1){for(let H=0;H<=(w??this.length-1);H+=1)if(w8(this[H])===Z){Iz("array.lastIndexOf(...)");break}}return G},z.includes=function(Z,w){let G=X.call(this,Z,w);if(!G){for(let H=0;H<this.length;H+=1)if(w8(this[H])===Z){Iz("array.includes(...)");break}}return G},Array.__svelte_cleanup=()=>{z.indexOf=Q,z.lastIndexOf=K,z.includes=X}}var n7,W6,E8,J4,Q4;function fz(){if(n7!==void 0)return;n7=window,W6=document,E8=/Firefox/.test(navigator.userAgent);var z=Element.prototype,J=Node.prototype,Q=Text.prototype;if(J4=S1(J,"firstChild").get,Q4=S1(J,"nextSibling").get,A7(z))z.__click=void 0,z.__className=void 0,z.__attributes=null,z.__style=void 0,z.__e=void 0;if(A7(Q))Q.__t=void 0;if(m)z.__svelte_meta=null,z4()}function d0(z=""){return document.createTextNode(z)}function _0(z){return J4.call(z)}function o0(z){return Q4.call(z)}function O(z,J){if(!r)return _0(z);var Q=_0(U0);if(Q===null)Q=U0.appendChild(d0());else if(J&&Q.nodeType!==t6){var K=d0();return Q?.before(K),R0(K),K}return R0(Q),Q}function h(z,J=!1){if(!r){var Q=_0(z);if(Q instanceof Comment&&Q.data==="")return o0(Q);return Q}if(J&&U0?.nodeType!==t6){var K=d0();return U0?.before(K),R0(K),K}return U0}function S(z,J=1,Q=!1){let K=r?U0:z;var X;while(J--)X=K,K=o0(K);if(!r)return K;if(Q&&K?.nodeType!==t6){var Z=d0();if(K===null)X?.after(Z);else K.before(Z);return R0(Z),Z}return R0(K),K}function m8(z){z.textContent=""}function $z(){if(!F1)return!1;if(X5!==null)return!1;var z=Q0.f;return(z&V5)!==0}function k6(z,J){if(J){let Q=document.body;z.autofocus=!0,m0(()=>{if(document.activeElement===Q)z.focus()})}}var K4=!1;function uz(){if(!K4)K4=!0,document.addEventListener("reset",(z)=>{Promise.resolve().then(()=>{if(!z.defaultPrevented)for(let J of z.target.elements)J.__on_r?.()})},{capture:!0})}function i5(z){var J=w0,Q=Q0;i0(null),G1(null);try{return z()}finally{i0(J),G1(Q)}}function f8(z,J,Q,K=Q){z.addEventListener(J,()=>i5(Q));let X=z.__on_r;if(X)z.__on_r=()=>{X(),K(!0)};else z.__on_r=()=>K(!0);uz()}function e7(z){if(Q0===null){if(w0===null)ZQ(z);KQ()}if(w5)QQ(z)}function _K(z,J){var Q=J.last;if(Q===null)J.last=J.first=z;else Q.next=z,z.prev=Q,J.last=z}function t1(z,J,Q){var K=Q0;if(m)while(K!==null&&(K.f&I6)!==0)K=K.parent;if(K!==null&&(K.f&D1)!==0)z|=D1;var X={ctx:L0,deps:null,nodes:null,f:z|g0|j1,first:null,fn:J,last:null,next:null,parent:K,b:K&&K.b,prev:null,teardown:null,wv:0,ac:null};if(m)X.component_function=c1;if(Q)try{Q6(X),X.f|=V5}catch(G){throw f0(X),G}else if(J!==null)a1(X);var Z=X;if(Q&&Z.deps===null&&Z.teardown===null&&Z.nodes===null&&Z.first===Z.last&&(Z.f&I5)===0){if(Z=Z.first,(z&h1)!==0&&(z&T1)!==0&&Z!==null)Z.f|=T1}if(Z!==null){if(Z.parent=K,K!==null)_K(Z,K);if(w0!==null&&(w0.f&v0)!==0&&(z&Q5)===0){var w=w0;(w.effects??=[]).push(Z)}}return X}function z6(){return w0!==null&&!u1}function B1(z){let J=t1(t5,null,!1);return E0(J,u0),J.teardown=z,J}function Q1(z){if(e7("$effect"),m)V1(z,"name",{value:"$effect"});var J=Q0.f,Q=!w0&&(J&k1)!==0&&(J&V5)===0;if(Q){var K=L0;(K.e??=[]).push(z)}else return m7(z)}function m7(z){return t1(O6|k7,z,!1)}function $8(z){if(e7("$effect.pre"),m)V1(z,"name",{value:"$effect.pre"});return t1(t5|k7,z,!0)}function z9(z){J1.ensure();let J=t1(Q5|I5,z,!0);return()=>{f0(J)}}function Z4(z){J1.ensure();let J=t1(Q5|I5,z,!0);return(Q={})=>{return new Promise((K)=>{if(Q.outro)b5(J,()=>{f0(J),K(void 0)});else f0(J),K(void 0)})}}function H1(z){return t1(O6,z,!1)}function rQ(z){return t1(f5|I5,z,!0)}function Y1(z,J=0){return t1(t5|J,z,!0)}function g(z,J=[],Q=[],K=[]){Z8(K,J,Q,(X)=>{t1(t5,()=>z(...X.map(W)),!0)})}function u8(z,J=[],Q=[],K=[]){var X=F0,Z=Q.length>0||K.length>0;if(Z)X.increment(!0);Z8(K,J,Q,(w)=>{if(t1(O6,()=>z(...w.map(W)),!1),Z)X.decrement(!0)})}function M1(z,J=0){var Q=t1(h1|J,z,!0);if(m)Q.dev_stack=x5;return Q}function lz(z,J=0){var Q=t1(P6|J,z,!0);if(m)Q.dev_stack=x5;return Q}function a0(z){return t1(k1|I5,z,!0)}function J9(z){var J=z.teardown;if(J!==null){let Q=w5,K=w0;t7(!0),i0(null);try{J.call(null)}finally{t7(Q),i0(K)}}}function Q9(z,J=!1){var Q=z.first;z.first=z.last=null;while(Q!==null){let X=Q.ac;if(X!==null)i5(()=>{X.abort(j5)});var K=Q.next;if((Q.f&Q5)!==0)Q.parent=null;else f0(Q,J);Q=K}}function X4(z){var J=z.first;while(J!==null){var Q=J.next;if((J.f&k1)===0)f0(J);J=Q}}function f0(z,J=!0){var Q=!1;if((J||(z.f&r6)!==0)&&z.nodes!==null&&z.nodes.end!==null)K9(z.nodes.start,z.nodes.end),Q=!0;Q9(z,J&&!Q),p8(z,0),E0(z,b1);var K=z.nodes&&z.nodes.t;if(K!==null)for(let Z of K)Z.stop();J9(z);var X=z.parent;if(X!==null&&X.first!==null)l7(z);if(m)z.component_function=null;z.next=z.prev=z.teardown=z.ctx=z.deps=z.fn=z.nodes=z.ac=null}function K9(z,J){while(z!==null){var Q=z===J?null:o0(z);z.remove(),z=Q}}function l7(z){var{parent:J,prev:Q,next:K}=z;if(Q!==null)Q.next=K;if(K!==null)K.prev=Q;if(J!==null){if(J.first===z)J.first=K;if(J.last===z)J.last=Q}}function b5(z,J,Q=!0){var K=[];w4(z,K,!0);var X=()=>{if(Q)f0(z);if(J)J()},Z=K.length;if(Z>0){var w=()=>--Z||X();for(var G of K)G.out(w)}else X()}function w4(z,J,Q){if((z.f&D1)!==0)return;z.f^=D1;var K=z.nodes&&z.nodes.t;if(K!==null){for(let G of K)if(G.is_global||Q)J.push(G)}var X=z.first;while(X!==null){var Z=X.next,w=(X.f&T1)!==0||(X.f&k1)!==0&&(z.f&h1)!==0;w4(X,J,w?Q:!1),X=Z}}function l8(z){W4(z,!0)}function W4(z,J){if((z.f&D1)===0)return;if(z.f^=D1,(z.f&u0)===0)E0(z,g0),a1(z);var Q=z.first;while(Q!==null){var K=Q.next,X=(Q.f&T1)!==0||(Q.f&k1)!==0;W4(Q,X?J:!1),Q=K}var Z=z.nodes&&z.nodes.t;if(Z!==null){for(let w of Z)if(w.is_global||J)w.in()}}function yz(z,J){if(!z.nodes)return;var Q=z.nodes.start,K=z.nodes.end;while(Q!==null){var X=Q===K?null:o0(Q);J.append(Q),Q=X}}var Y4=null;var pz=!1,w5=!1;function t7(z){w5=z}var w0=null,u1=!1;function i0(z){w0=z}var Q0=null;function G1(z){Q0=z}var r1=null;function hz(z){if(w0!==null&&(!F1||(w0.f&v0)!==0))if(r1===null)r1=[z];else r1.push(z)}var l1=null,e1=0,n1=null;function eQ(z){n1=z}var G4=1,b6=0,w6=b6;function r7(z){w6=z}function K8(){return++G4}function Z6(z){var J=z.f;if((J&g0)!==0)return!0;if(J&v0)z.f&=~K5;if((J&w1)!==0){var Q=z.deps,K=Q.length;for(var X=0;X<K;X++){var Z=Q[X];if(Z6(Z))o7(Z);if(Z.wv>z.wv)return!0}if((J&j1)!==0&&x1===null)E0(z,u0)}return!1}function B4(z,J,Q=!0){var K=z.reactions;if(K===null)return;if(!F1&&r1!==null&&U5.call(r1,z))return;for(var X=0;X<K.length;X++){var Z=K[X];if((Z.f&v0)!==0)B4(Z,J,!1);else if(J===Z){if(Q)E0(Z,g0);else if((Z.f&u0)!==0)E0(Z,w1);a1(Z)}}}function gz(z){var J=l1,Q=e1,K=n1,X=w0,Z=r1,w=L0,G=u1,H=w6,B=z.f;if(l1=null,e1=0,n1=null,w0=(B&(k1|Q5))===0?z:null,r1=null,p5(z.ctx),u1=!1,w6=++b6,z.ac!==null)i5(()=>{z.ac.abort(j5)}),z.ac=null;try{z.f|=Oz;var F=z.fn,q=F(),Y=z.deps;if(l1!==null){var U;if(p8(z,e1),Y!==null&&e1>0){Y.length=e1+l1.length;for(U=0;U<l1.length;U++)Y[e1+U]=l1[U]}else z.deps=Y=l1;if(z6()&&(z.f&j1)!==0)for(U=e1;U<Y.length;U++)(Y[U].reactions??=[]).push(z)}else if(Y!==null&&e1<Y.length)p8(z,e1),Y.length=e1;if(s1()&&n1!==null&&!u1&&Y!==null&&(z.f&(v0|w1|g0))===0)for(U=0;U<n1.length;U++)B4(n1[U],z);if(X!==null&&X!==z){if(b6++,X.deps!==null)for(let x=0;x<Q;x+=1)X.deps[x].rv=b6;if(J!==null)for(let x of J)x.rv=b6;if(n1!==null)if(K===null)K=n1;else K.push(...n1)}if((z.f&Z5)!==0)z.f^=Z5;return q}catch(x){return Nz(x)}finally{z.f^=Oz,l1=J,e1=Q,n1=K,w0=X,r1=Z,p5(w),u1=G,w6=H}}function cK(z,J){let Q=J.reactions;if(Q!==null){var K=aJ.call(Q,z);if(K!==-1){var X=Q.length-1;if(X===0)Q=J.reactions=null;else Q[K]=Q[X],Q.pop()}}if(Q===null&&(J.f&v0)!==0&&(l1===null||!U5.call(l1,J))){var Z=J;if((Z.f&j1)!==0)Z.f^=j1,Z.f&=~K5;z8(Z),vz(Z),p8(Z,0)}}function p8(z,J){var Q=z.deps;if(Q===null)return;for(var K=J;K<Q.length;K++)cK(z,Q[K])}function Q6(z){var J=z.f;if((J&b1)!==0)return;E0(z,u0);var Q=Q0,K=pz;if(Q0=z,pz=!0,m){var X=c1;Az(z.component_function);var Z=x5;e6(z.dev_stack??x5)}try{if((J&(h1|P6))!==0)X4(z);else Q9(z);J9(z);var w=gz(z);if(z.teardown=typeof w==="function"?w:null,z.wv=G4,m&&F5&&(z.f&g0)!==0&&z.deps!==null){for(var G of z.deps)if(G.set_during_effect)G.wv=K8(),G.set_during_effect=!1}}finally{if(pz=K,Q0=Q,m)Az(X),e6(Z)}}async function y8(){if(F1)return new Promise((z)=>{requestAnimationFrame(()=>z()),setTimeout(()=>z())});await Promise.resolve(),K6()}function W(z){var J=z.f,Q=(J&v0)!==0;if(Y4?.add(z),w0!==null&&!u1){var K=Q0!==null&&(Q0.f&b1)!==0;if(!K&&(r1===null||!U5.call(r1,z))){var X=w0.deps;if((w0.f&Oz)!==0){if(z.rv<b6)if(z.rv=b6,l1===null&&X!==null&&X[e1]===z)e1++;else if(l1===null)l1=[z];else l1.push(z)}else{(w0.deps??=[]).push(z);var Z=z.reactions;if(Z===null)z.reactions=[w0];else if(!U5.call(Z,w0))Z.push(w0)}}}if(m){if(g8.delete(z),F5&&!u1&&T8!==null&&w0!==null&&T8.reaction===w0)if(z.trace)z.trace();else{var w=A5("traced at");if(w){var G=T8.entries.get(z);if(G===void 0)G={traces:[]},T8.entries.set(z,G);var H=G.traces[G.traces.length-1];if(w.stack!==H?.stack)G.traces.push(w)}}}if(w5&&k5.has(z))return k5.get(z);if(Q){var B=z;if(w5){var F=B.v;if((B.f&u0)===0&&B.reactions!==null||U4(B))F=h8(B);return k5.set(B,F),F}var q=(B.f&j1)===0&&!u1&&w0!==null&&(pz||(w0.f&j1)!==0),Y=B.deps===null;if(Z6(B)){if(q)B.f|=j1;o7(B)}if(q&&!Y)H4(B)}if(x1?.has(z))return x1.get(z);if((z.f&Z5)!==0)throw z.v;return z.v}function H4(z){if(z.deps===null)return;z.f|=j1;for(let J of z.deps)if((J.reactions??=[]).push(z),(J.f&v0)!==0&&(J.f&j1)===0)H4(J)}function U4(z){if(z.v===b0)return!0;if(z.deps===null)return!1;for(let J of z.deps){if(k5.has(J))return!0;if((J.f&v0)!==0&&U4(J))return!0}return!1}function T0(z){var J=u1;try{return u1=!0,z()}finally{u1=J}}function iz(z){if(typeof z!=="object"||!z||z instanceof EventTarget)return;if(e0 in z)dz(z);else if(!Array.isArray(z))for(let J in z){let Q=z[J];if(typeof Q==="object"&&Q&&e0 in Q)dz(Q)}}function dz(z,J=new Set){if(typeof z==="object"&&z!==null&&!(z instanceof EventTarget)&&!J.has(z)){if(J.add(z),z instanceof Date)z.getTime();for(let K in z)try{dz(z[K],J)}catch(X){}let Q=M6(z);if(Q!==Object.prototype&&Q!==Array.prototype&&Q!==Map.prototype&&Q!==Set.prototype&&Q!==Date.prototype){let K=Mz(Q);for(let X in K){let Z=K[X].get;if(Z)try{Z.call(z)}catch(w){}}}}}var sK=/\r/g;function V4(z){z=z.replace(sK,"");let J=5381,Q=z.length;while(Q--)J=(J<<5)-J^z.charCodeAt(Q);return(J>>>0).toString(36)}function q4(z){return z.endsWith("capture")&&z!=="gotpointercapture"&&z!=="lostpointercapture"}var oK=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function F4(z){return oK.includes(z)}var aK=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","webkitdirectory","defer","disablepictureinpicture","disableremoteplayback"];var rK={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function x4(z){return z=z.toLowerCase(),rK[z]??z}var TG=[...aK,"formNoValidate","isMap","noModule","playsInline","readOnly","value","volume","defaultValue","defaultChecked","srcObject","noValidate","allowFullscreen","disablePictureInPicture","disableRemotePlayback"];var nK=["touchstart","touchmove"];function M4(z){return nK.includes(z)}var tK=["$state","$state.raw","$derived","$derived.by"],EG=[...tK,"$state.eager","$state.snapshot","$props","$props.id","$bindable","$effect","$effect.pre","$effect.tracking","$effect.root","$effect.pending","$inspect","$inspect().with","$inspect.trace","$host"];function _z(z){return z?.replace(/\//g,"/â€‹")}var Z9=new Set,cz=new Set;function W8(z){if(!r)return;z.removeAttribute("onload"),z.removeAttribute("onerror");let J=z.__e;if(J!==void 0)z.__e=void 0,queueMicrotask(()=>{if(z.isConnected)z.dispatchEvent(J)})}function X9(z,J,Q,K={}){function X(Z){if(!K.capture)Y8.call(J,Z);if(!Z.cancelBubble)return i5(()=>{return Q?.call(this,Z)})}if(z.startsWith("pointer")||z.startsWith("touch")||z==="wheel")m0(()=>{J.addEventListener(z,X,K)});else J.addEventListener(z,X,K);return X}function C1(z,J,Q,K,X){var Z={capture:K,passive:X},w=X9(z,J,Q,Z);if(J===document.body||J===window||J===document||J instanceof HTMLMediaElement)B1(()=>{J.removeEventListener(z,w,Z)})}function I0(z){for(var J=0;J<z.length;J++)Z9.add(z[J]);for(var Q of cz)Q(z)}var O4=null;function Y8(z){var J=this,Q=J.ownerDocument,K=z.type,X=z.composedPath?.()||[],Z=X[0]||z.target;O4=z;var w=0,G=O4===z&&z.__root;if(G){var H=X.indexOf(G);if(H!==-1&&(J===document||J===window)){z.__root=J;return}var B=X.indexOf(J);if(B===-1)return;if(H<=B)w=H}if(Z=X[w]||z.target,Z===J)return;V1(z,"currentTarget",{configurable:!0,get(){return Z||Q}});var F=w0,q=Q0;i0(null),G1(null);try{var Y,U=[];while(Z!==null){var x=Z.assignedSlot||Z.parentNode||Z.host||null;try{var I=Z["__"+K];if(I!=null&&(!Z.disabled||z.target===Z))I.call(Z,z)}catch(M){if(Y)U.push(M);else Y=M}if(z.cancelBubble||x===J||x===null)break;Z=x}if(Y){for(let M of U)queueMicrotask(()=>{throw M});throw Y}}finally{z.__root=J,delete z.currentTarget,i0(F),G1(q)}}function d8(z){var J=document.createElement("template");return J.innerHTML=z.replaceAll("<!>","<!---->"),J.content}function p1(z,J){var Q=Q0;if(Q.nodes===null)Q.nodes={start:z,end:J,a:null,t:null}}function P(z,J){var Q=(J&DQ)!==0,K=(J&RQ)!==0,X,Z=!z.startsWith("<!>");return()=>{if(r)return p1(U0,null),U0;if(X===void 0){if(X=d8(Z?z:"<!>"+z),!Q)X=_0(X)}var w=K||E8?document.importNode(X,!0):X.cloneNode(!0);if(Q){var G=_0(w),H=w.lastChild;p1(G,H)}else p1(w,w);return w}}function N1(z=""){if(!r){var J=d0(z+"");return p1(J,J),J}var Q=U0;if(Q.nodeType!==t6)Q.before(Q=d0()),R0(Q);return p1(Q,Q),Q}function d(){if(r)return p1(U0,null),U0;var z=document.createDocumentFragment(),J=document.createComment(""),Q=d0();return z.append(J,Q),p1(J,Q),z}function V(z,J){if(r){var Q=Q0;if((Q.f&V5)===0||Q.nodes.end===null)Q.nodes.end=U0;s0();return}if(z===null)return;z.before(J)}var w9=!0;function u(z,J){var Q=J==null?"":typeof J==="object"?J+"":J;if(Q!==(z.__t??=z.nodeValue))z.__t=Q,z.nodeValue=Q+""}function B8(z,J){return L4(z,J)}function Y9(z,J){fz(),J.intro=J.intro??!1;let Q=J.target,K=r,X=U0;try{var Z=_0(Q);while(Z&&(Z.nodeType!==R1||Z.data!==b8))Z=o0(Z);if(!Z)throw D5;h0(!0),R0(Z);let w=L4(z,{...J,anchor:Z});return h0(!1),w}catch(w){if(w instanceof Error&&w.message.split(`
`).some((G)=>G.startsWith("https://svelte.dev/e/")))throw w;if(w!==D5)console.warn("Failed to hydrate: ",w);if(J.recover===!1)wQ();return fz(),m8(Q),h0(!1),B8(z,J)}finally{h0(K),R0(X)}}var G8=new Map;function L4(z,{target:J,anchor:Q,props:K={},events:X,context:Z,intro:w=!0}){fz();var G=new Set,H=(q)=>{for(var Y=0;Y<q.length;Y++){var U=q[Y];if(G.has(U))continue;G.add(U);var x=M4(U);J.addEventListener(U,Y8,{passive:x});var I=G8.get(U);if(I===void 0)document.addEventListener(U,Y8,{passive:x}),G8.set(U,1);else G8.set(U,I+1)}};H(o6(Z9)),cz.add(H);var B=void 0,F=Z4(()=>{var q=Q??J.appendChild(d0());return p7(q,{pending:()=>{}},(Y)=>{if(Z){_({});var U=L0;U.c=Z}if(X)K.$$events=X;if(r)p1(Y,null);if(w9=w,B=z(Y,K)||{},w9=!0,r){if(Q0.nodes.end=U0,U0===null||U0.nodeType!==R1||U0.data!==S6)throw e5(),D5}if(Z)c()}),()=>{for(var Y of G){J.removeEventListener(Y,Y8);var U=G8.get(Y);if(--U===0)document.removeEventListener(Y,Y8),G8.delete(Y);else G8.set(Y,U)}if(cz.delete(H),q!==Q)q.parentNode?.removeChild(q)}});return W9.set(B,F),B}var W9=new WeakMap;function G9(z,J){let Q=W9.get(z);if(Q)return W9.delete(z),Q(J);if(m)if(e0 in z)vQ();else EQ();return Promise.resolve()}class M5{anchor;#z=new Map;#J=new Map;#Q=new Map;#Z=new Set;#w=!0;constructor(z,J=!0){this.anchor=z,this.#w=J}#X=()=>{var z=F0;if(!this.#z.has(z))return;var J=this.#z.get(z),Q=this.#J.get(J);if(Q)l8(Q),this.#Z.delete(J);else{var K=this.#Q.get(J);if(K)this.#J.set(J,K.effect),this.#Q.delete(J),K.fragment.lastChild.remove(),this.anchor.before(K.fragment),Q=K.effect}for(let[X,Z]of this.#z){if(this.#z.delete(X),X===z)break;let w=this.#Q.get(Z);if(w)f0(w.effect),this.#Q.delete(Z)}for(let[X,Z]of this.#J){if(X===J||this.#Z.has(X))continue;let w=()=>{if(Array.from(this.#z.values()).includes(X)){var H=document.createDocumentFragment();yz(Z,H),H.append(d0()),this.#Q.set(X,{effect:Z,fragment:H})}else f0(Z);this.#Z.delete(X),this.#J.delete(X)};if(this.#w||!Q)this.#Z.add(X),b5(Z,w,!1);else w()}};#K=(z)=>{this.#z.delete(z);let J=Array.from(this.#z.values());for(let[Q,K]of this.#Q)if(!J.includes(Q))f0(K.effect),this.#Q.delete(Q)};ensure(z,J){var Q=F0,K=$z();if(J&&!this.#J.has(z)&&!this.#Q.has(z))if(K){var X=document.createDocumentFragment(),Z=d0();X.append(Z),this.#Q.set(z,{effect:a0(()=>J(Z)),fragment:X})}else this.#J.set(z,a0(()=>J(this.anchor)));if(this.#z.set(Q,z),K){for(let[w,G]of this.#J)if(w===z)Q.skipped_effects.delete(G);else Q.skipped_effects.add(G);for(let[w,G]of this.#Q)if(w===z)Q.skipped_effects.delete(G.effect);else Q.skipped_effects.add(G.effect);Q.oncommit(this.#X),Q.ondiscard(this.#K)}else{if(r)this.anchor=U0;this.#X()}}}var I4=0,B9=1;function T6(z,J,Q,K,X){if(r)s0();var Z=s1(),w=b0,G=Z?W1(w):d5(w,!1,!1),H=Z?W1(w):d5(w,!1,!1),B=new M5(z);M1(()=>{var F=J(),q=!1;let Y=r&&N7(F)===(z.data===q5);if(Y)R0(R5()),h0(!1);if(N7(F)){var U=i7(),x=!1;let I=(M)=>{if(q)return;if(x=!0,U(!1),J1.ensure(),r)h0(!1);try{M()}finally{if(X8(),!J6)K6()}};if(F.then((M)=>{I(()=>{$1(G,M),B.ensure(B9,K&&((A)=>K(A,G)))})},(M)=>{I(()=>{if($1(H,M),B.ensure(B9,X&&((A)=>X(A,H))),!X)throw H.v})}),r)B.ensure(I4,Q);else m0(()=>{if(!x)I(()=>{B.ensure(I4,Q)})})}else $1(G,F),B.ensure(B9,K&&((I)=>K(I,G)));if(Y)h0(!0);return()=>{q=!0}})}function j(z,J,Q=!1){if(r)s0();var K=new M5(z),X=Q?T1:0;function Z(w,G){if(r){let B=Sz(z)===q5;if(w===B){var H=R5();R0(H),K.anchor=H,h0(!1),K.ensure(w,G),h0(!0);return}}K.ensure(w,G)}M1(()=>{var w=!1;if(J((G,H=!0)=>{w=!0,Z(H,G)}),!w)Z(!1,null)},X)}function H9(z,J,Q){if(r)s0();var K=new M5(z),X=!s1();M1(()=>{var Z=J();if(X&&Z!==null&&typeof Z==="object")Z={};K.ensure(Z,Q)})}function O1(z,J){return J}function QZ(z,J,Q){var K=[],X=J.length,Z,w=J.length;for(var G=0;G<X;G++){let q=J[G];b5(q,()=>{if(Z){if(Z.pending.delete(q),Z.done.add(q),Z.pending.size===0){var Y=z.outrogroups;if(U9(o6(Z.done)),Y.delete(Z),Y.size===0)z.outrogroups=null}}else w-=1},!1)}if(w===0){var H=K.length===0&&Q!==null;if(H){var B=Q,F=B.parentNode;m8(F),F.append(B),z.items.clear()}U9(J,!H)}else Z={pending:new Set(J),done:new Set},(z.outrogroups??=new Set).add(Z)}function U9(z,J=!0){for(var Q=0;Q<z.length;Q++)f0(z[Q],J)}var S4;function A0(z,J,Q,K,X,Z=null){var w=z,G=new Map,H=(J&T7)!==0;if(H){var B=z;w=r?R0(_0(B)):B.appendChild(d0())}if(r)s0();var F=null,q=R6(()=>{var A=Q();return H5(A)?A:A==null?[]:o6(A)}),Y,U=!0;function x(){if(M.fallback=F,KZ(M,Y,w,J,K),F!==null)if(Y.length===0)if((F.f&S5)===0)l8(F);else F.f^=S5,i8(F,null,w);else b5(F,()=>{F=null})}var I=M1(()=>{Y=W(q);var A=Y.length;let E=!1;if(r){var v=Sz(w)===q5;if(v!==(A===0))w=R5(),R0(w),h0(!1),E=!0}var T=new Set,y=F0,N=$z();for(var R=0;R<A;R+=1){if(r&&U0.nodeType===R1&&U0.data===S6)w=U0,E=!0,h0(!1);var k=Y[R],$=K(k,R),b=U?null:G.get($);if(b){if(b.v)$1(b.v,k);if(b.i)$1(b.i,R);if(N)y.skipped_effects.delete(b.e)}else{if(b=ZZ(G,U?w:S4??=d0(),k,$,R,X,J,Q),!U)b.e.f|=S5;G.set($,b)}T.add($)}if(A===0&&Z&&!F)if(U)F=a0(()=>Z(w));else F=a0(()=>Z(S4??=d0())),F.f|=S5;if(r&&A>0)R0(R5());if(!U)if(N){for(let[l,n]of G)if(!T.has(l))y.skipped_effects.add(n.e);y.oncommit(x),y.ondiscard(()=>{})}else x();if(E)h0(!0);W(q)}),M={effect:I,flags:J,items:G,outrogroups:null,fallback:F};if(U=!1,r)w=U0}function KZ(z,J,Q,K,X){var Z=(K&CQ)!==0,w=J.length,G=z.items,H=z.effect.first,B,F=null,q,Y=[],U=[],x,I,M,A;if(Z){for(A=0;A<w;A+=1)if(x=J[A],I=X(x,A),M=G.get(I).e,(M.f&S5)===0)M.nodes?.a?.measure(),(q??=new Set).add(M)}for(A=0;A<w;A+=1){if(x=J[A],I=X(x,A),M=G.get(I).e,z.outrogroups!==null)for(let b of z.outrogroups)b.pending.delete(M),b.done.delete(M);if((M.f&S5)!==0)if(M.f^=S5,M===H)i8(M,null,Q);else{var E=F?F.next:H;if(M===z.effect.last)z.effect.last=M.prev;if(M.prev)M.prev.next=M.next;if(M.next)M.next.prev=M.prev;Y6(z,F,M),Y6(z,M,E),i8(M,E,Q),F=M,Y=[],U=[],H=F.next;continue}if((M.f&D1)!==0){if(l8(M),Z)M.nodes?.a?.unfix(),(q??=new Set).delete(M)}if(M!==H){if(B!==void 0&&B.has(M)){if(Y.length<U.length){var v=U[0],T;F=v.prev;var y=Y[0],N=Y[Y.length-1];for(T=0;T<Y.length;T+=1)i8(Y[T],v,Q);for(T=0;T<U.length;T+=1)B.delete(U[T]);Y6(z,y.prev,N.next),Y6(z,F,y),Y6(z,N,v),H=v,F=N,A-=1,Y=[],U=[]}else B.delete(M),i8(M,H,Q),Y6(z,M.prev,M.next),Y6(z,M,F===null?z.effect.first:F.next),Y6(z,F,M),F=M;continue}Y=[],U=[];while(H!==null&&H!==M)(B??=new Set).add(H),U.push(H),H=H.next;if(H===null)continue}if((M.f&S5)===0)Y.push(M);F=M,H=M.next}if(z.outrogroups!==null){for(let b of z.outrogroups)if(b.pending.size===0)U9(o6(b.done)),z.outrogroups?.delete(b);if(z.outrogroups.size===0)z.outrogroups=null}if(H!==null||B!==void 0){var R=[];if(B!==void 0){for(M of B)if((M.f&D1)===0)R.push(M)}while(H!==null){if((H.f&D1)===0&&H!==z.fallback)R.push(H);H=H.next}var k=R.length;if(k>0){var $=(K&T7)!==0&&w===0?Q:null;if(Z){for(A=0;A<k;A+=1)R[A].nodes?.a?.measure();for(A=0;A<k;A+=1)R[A].nodes?.a?.fix()}QZ(z,R,$)}}if(Z)m0(()=>{if(q===void 0)return;for(M of q)M.nodes?.a?.apply()})}function ZZ(z,J,Q,K,X,Z,w,G){var H=(w&xQ)!==0?(w&OQ)===0?d5(Q,!1,!1):W1(Q):null,B=(w&MQ)!==0?W1(X):null;if(m&&H)H.trace=()=>{G()[B?.v??X]};return{v:H,i:B,e:a0(()=>{return Z(J,H??Q,B??X,G),()=>{z.delete(K)}})}}function i8(z,J,Q){if(!z.nodes)return;var K=z.nodes.start,X=z.nodes.end,Z=J&&(J.f&S5)===0?J.nodes.start:Q;while(K!==null){var w=o0(K);if(Z.before(K),K===X)return;K=w}}function Y6(z,J,Q){if(J===null)z.effect.first=Q;else J.next=Q;if(Q===null)z.effect.last=J;else Q.prev=J}function XZ(z,J,Q){if(!J||J===V4(String(Q??"")))return;let K,X=z.__svelte_meta?.loc;if(X)K=`near ${X.file}:${X.line}:${X.column}`;else if(c1?.[m1])K=`in ${c1[m1]}`;TQ(_z(K))}function V9(z,J,Q=!1,K=!1,X=!1){var Z=z,w="";g(()=>{var G=Q0;if(w===(w=J()??"")){if(r)s0();return}if(G.nodes!==null)K9(G.nodes.start,G.nodes.end),G.nodes=null;if(w==="")return;if(r){var H=U0.data,B=s0(),F=B;while(B!==null&&(B.nodeType!==R1||B.data!==""))F=B,B=o0(B);if(B===null)throw e5(),D5;if(m&&!X)XZ(B.parentNode,H,w);p1(U0,F),Z=R0(B);return}var q=w+"";if(Q)q=`<svg>${q}</svg>`;else if(K)q=`<math>${q}</math>`;var Y=d8(q);if(Q||K)Y=_0(Y);if(p1(_0(Y),Y.lastChild),Q||K)while(_0(Y))Z.before(_0(Y));else Z.before(Y)})}function G6(z,J,...Q){var K=new M5(z);M1(()=>{let X=J()??null;if(m&&X==null)WQ();K.ensure(X,X&&((Z)=>X(Z,...Q)))},T1)}function E6(z,J){let Q=null,K=r;var X;if(r){Q=U0;var Z=_0(document.head);while(Z!==null&&(Z.nodeType!==R1||Z.data!==z))Z=o0(Z);if(Z===null)h0(!1);else{var w=o0(Z);Z.remove(),R0(w)}}if(!r)X=document.head.appendChild(d0());try{M1(()=>J(X),r6)}finally{if(K)h0(!0),R0(Q)}}function sz(z,J){var Q=void 0,K;lz(()=>{if(Q!==(Q=J())){if(K)f0(K),K=null;if(Q)K=a0(()=>{H1(()=>Q(z))})}})}function j4(z){var J,Q,K="";if(typeof z=="string"||typeof z=="number")K+=z;else if(typeof z=="object")if(Array.isArray(z)){var X=z.length;for(J=0;J<X;J++)z[J]&&(Q=j4(z[J]))&&(K&&(K+=" "),K+=Q)}else for(Q in z)z[Q]&&(K&&(K+=" "),K+=Q);return K}function D4(){for(var z,J,Q=0,K="",X=arguments.length;Q<X;Q++)(z=arguments[Q])&&(J=j4(z))&&(K&&(K+=" "),K+=J);return K}function y6(z){if(typeof z==="object")return D4(z);else return z??""}var R4=[...` 	
\r\fÂ \v\uFEFF`];function N4(z,J,Q){var K=z==null?"":""+z;if(J)K=K?K+" "+J:J;if(Q){for(var X in Q)if(Q[X])K=K?K+" "+X:X;else if(K.length){var Z=X.length,w=0;while((w=K.indexOf(X,w))>=0){var G=w+Z;if((w===0||R4.includes(K[w-1]))&&(G===K.length||R4.includes(K[G])))K=(w===0?"":K.substring(0,w))+K.substring(G+1);else w=G}}}return K===""?null:K}function A4(z,J=!1){var Q=J?" !important;":";",K="";for(var X in z){var Z=z[X];if(Z!=null&&Z!=="")K+=" "+X+": "+Z+Q}return K}function q9(z){if(z[0]!=="-"||z[1]!=="-")return z.toLowerCase();return z}function k4(z,J){if(J){var Q="",K,X;if(Array.isArray(J))K=J[0],X=J[1];else K=J;if(z){z=String(z).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var Z=!1,w=0,G=!1,H=[];if(K)H.push(...Object.keys(K).map(q9));if(X)H.push(...Object.keys(X).map(q9));var B=0,F=-1;let I=z.length;for(var q=0;q<I;q++){var Y=z[q];if(G){if(Y==="/"&&z[q-1]==="*")G=!1}else if(Z){if(Z===Y)Z=!1}else if(Y==="/"&&z[q+1]==="*")G=!0;else if(Y==='"'||Y==="'")Z=Y;else if(Y==="(")w++;else if(Y===")")w--;if(!G&&Z===!1&&w===0){if(Y===":"&&F===-1)F=q;else if(Y===";"||q===I-1){if(F!==-1){var U=q9(z.substring(B,F).trim());if(!H.includes(U)){if(Y!==";")q++;var x=z.substring(B,q).trim();Q+=" "+x+";"}}B=q+1,F=-1}}}}if(K)Q+=A4(K);if(X)Q+=A4(X,!0);return Q=Q.trim(),Q===""?null:Q}return z==null?null:String(z)}function K1(z,J,Q,K,X,Z){var w=z.__className;if(r||w!==Q||w===void 0){var G=N4(Q,K,Z);if(!r||G!==z.getAttribute("class"))if(G==null)z.removeAttribute("class");else if(J)z.className=G;else z.setAttribute("class",G);z.__className=Q}else if(Z&&X!==Z)for(var H in Z){var B=!!Z[H];if(X==null||B!==!!X[H])z.classList.toggle(H,B)}return Z}function F9(z,J={},Q,K){for(var X in Q){var Z=Q[X];if(J[X]!==Z)if(Q[X]==null)z.style.removeProperty(X);else z.style.setProperty(X,Z,K)}}function _5(z,J,Q,K){var X=z.__style;if(r||X!==J){var Z=k4(J,K);if(!r||Z!==z.getAttribute("style"))if(Z==null)z.removeAttribute("style");else z.style.cssText=Z;z.__style=J}else if(K)if(Array.isArray(K))F9(z,Q?.[0],K[0]),F9(z,Q?.[1],K[1],"important");else F9(z,Q,K);return K}function H8(z,J,Q=!1){if(z.multiple){if(J==null)return;if(!H5(J))return yQ();for(var K of z.options)K.selected=J.includes(_8(K));return}for(K of z.options){var X=_8(K);if(mz(X,J)){K.selected=!0;return}}if(!Q||J!==void 0)z.selectedIndex=-1}function oz(z){var J=new MutationObserver(()=>{H8(z,z.__value)});J.observe(z,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),B1(()=>{J.disconnect()})}function x9(z,J,Q=J){var K=new WeakSet,X=!0;f8(z,"change",(Z)=>{var w=Z?"[selected]":":checked",G;if(z.multiple)G=[].map.call(z.querySelectorAll(w),_8);else{var H=z.querySelector(w)??z.querySelector("option:not([disabled])");G=H&&_8(H)}if(Q(G),F0!==null)K.add(F0)}),H1(()=>{var Z=J();if(z===document.activeElement){var w=Q8??F0;if(K.has(w))return}if(H8(z,Z,X),X&&Z===void 0){var G=z.querySelector(":checked");if(G!==null)Z=_8(G),Q(Z)}z.__value=Z,X=!1}),oz(z)}function _8(z){if("__value"in z)return z.__value;else return z.value}var U8=Symbol("class"),V8=Symbol("style"),E4=Symbol("is custom element"),y4=Symbol("is html");function p0(z){if(!r)return;var J=!1,Q=()=>{if(J)return;if(J=!0,z.hasAttribute("value")){var K=z.value;i(z,"value",null),z.value=K}if(z.hasAttribute("checked")){var X=z.checked;i(z,"checked",null),z.checked=X}};z.__on_r=Q,m0(Q),uz()}function W5(z,J){var Q=C9(z);if(Q.value===(Q.value=J??void 0)||z.value===J&&(J!==0||z.nodeName!=="PROGRESS"))return;z.value=J??""}function v4(z,J){if(J){if(!z.hasAttribute("selected"))z.setAttribute("selected","")}else z.removeAttribute("selected")}function i(z,J,Q,K){var X=C9(z);if(r){if(X[J]=z.getAttribute(J),J==="src"||J==="srcset"||J==="href"&&z.nodeName==="LINK"){if(!K)BZ(z,J,Q??"");return}}if(X[J]===(X[J]=Q))return;if(J==="loading")z[tJ]=Q;if(Q==null)z.removeAttribute(J);else if(typeof Q!=="string"&&g4(z).includes(J))z[J]=Q;else z.setAttribute(J,Q)}function GZ(z,J,Q,K,X=!1,Z=!1){if(r&&X&&z.tagName==="INPUT"){var w=z,G=w.type==="checkbox"?"defaultChecked":"defaultValue";if(!(G in Q))p0(w)}var H=C9(z),B=H[E4],F=!H[y4];let q=r&&B;if(q)h0(!1);var Y=J||{},U=z.tagName==="OPTION";for(var x in J)if(!(x in Q))Q[x]=null;if(Q.class)Q.class=y6(Q.class);else if(K||Q[U8])Q.class=null;if(Q[V8])Q.style??=null;var I=g4(z);for(let N in Q){let R=Q[N];if(U&&N==="value"&&R==null){z.value=z.__value="",Y[N]=R;continue}if(N==="class"){var M=z.namespaceURI==="http://www.w3.org/1999/xhtml";K1(z,M,R,K,J?.[U8],Q[U8]),Y[N]=R,Y[U8]=Q[U8];continue}if(N==="style"){_5(z,R,J?.[V8],Q[V8]),Y[N]=R,Y[V8]=Q[V8];continue}var A=Y[N];if(R===A&&!(R===void 0&&z.hasAttribute(N)))continue;Y[N]=R;var E=N[0]+N[1];if(E==="$$")continue;if(E==="on"){let k={},$="$$"+N,b=N.slice(2);var v=F4(b);if(q4(b))b=b.slice(0,-7),k.capture=!0;if(!v&&A){if(R!=null)continue;z.removeEventListener(b,Y[$],k),Y[$]=null}if(R!=null)if(!v){let l=function(n){Y[N].call(this,n)};Y[$]=X9(b,z,l,k)}else z[`__${b}`]=R,I0([b]);else if(v)z[`__${b}`]=void 0}else if(N==="style")i(z,N,R);else if(N==="autofocus")k6(z,Boolean(R));else if(!B&&(N==="__value"||N==="value"&&R!=null))z.value=z.__value=R;else if(N==="selected"&&U)v4(z,R);else{var T=N;if(!F)T=x4(T);var y=T==="defaultValue"||T==="defaultChecked";if(R==null&&!B&&!y)if(H[N]=null,T==="value"||T==="checked"){let k=z,$=J===void 0;if(T==="value"){let b=k.defaultValue;k.removeAttribute(T),k.defaultValue=b,k.value=k.__value=$?b:null}else{let b=k.defaultChecked;k.removeAttribute(T),k.defaultChecked=b,k.checked=$?b:!1}}else z.removeAttribute(N);else if(y||I.includes(T)&&(B||typeof R!=="string")){if(z[T]=R,T in H)H[T]=b0}else if(typeof R!=="function")i(z,T,R,Z)}}if(q)h0(!0);return Y}function az(z,J,Q=[],K=[],X=[],Z,w=!1,G=!1){Z8(X,Q,K,(H)=>{var B=void 0,F={},q=z.nodeName==="SELECT",Y=!1;if(lz(()=>{var x=J(...H.map(W)),I=GZ(z,B,x,Z,w,G);if(Y&&q&&"value"in x)H8(z,x.value);for(let A of Object.getOwnPropertySymbols(F))if(!x[A])f0(F[A]);for(let A of Object.getOwnPropertySymbols(x)){var M=x[A];if(A.description===E7&&(!B||M!==B[A])){if(F[A])f0(F[A]);F[A]=a0(()=>sz(z,()=>M))}I[A]=M}B=I}),q){var U=z;H1(()=>{H8(U,B.value,!0),oz(U)})}Y=!0})}function C9(z){return z.__attributes??={[E4]:z.nodeName.includes("-"),[y4]:z.namespaceURI===NQ}}var b4=new Map;function g4(z){var J=z.getAttribute("is")||z.nodeName,Q=b4.get(J);if(Q)return Q;b4.set(J,Q=[]);var K,X=z,Z=Element.prototype;while(Z!==X){K=Mz(X);for(var w in K)if(K[w].set)Q.push(w);X=M6(X)}return Q}function BZ(z,J,Q){if(!m)return;if(J==="srcset"&&HZ(z,Q))return;if(M9(z.getAttribute(J)??"",Q))return;bQ(J,z.outerHTML.replace(z.innerHTML,z.innerHTML&&"..."),String(Q))}function M9(z,J){if(z===J)return!0;return new URL(z,document.baseURI).href===new URL(J,document.baseURI).href}function T4(z){return z.split(",").map((J)=>J.trim().split(" ").filter(Boolean))}function HZ(z,J){var Q=T4(z.srcset),K=T4(J);return K.length===Q.length&&K.every(([X,Z],w)=>Z===Q[w][1]&&(M9(Q[w][0],X)||M9(X,Q[w][0])))}function P1(z,J,Q=J){var K=new WeakSet;if(f8(z,"input",async(X)=>{if(m&&z.type==="checkbox")b7();var Z=X?z.defaultValue:z.value;if(Z=P9(z)?L9(Z):Z,Q(Z),F0!==null)K.add(F0);if(await y8(),Z!==(Z=J())){var{selectionStart:w,selectionEnd:G}=z,H=z.value.length;if(z.value=Z??"",G!==null){var B=z.value.length;if(w===G&&G===H&&B>H)z.selectionStart=B,z.selectionEnd=B;else z.selectionStart=w,z.selectionEnd=Math.min(G,B)}}}),r&&z.defaultValue!==z.value||T0(J)==null&&z.value){if(Q(P9(z)?L9(z.value):z.value),F0!==null)K.add(F0)}Y1(()=>{if(m&&z.type==="checkbox")b7();var X=J();if(z===document.activeElement){var Z=Q8??F0;if(K.has(Z))return}if(P9(z)&&X===L9(z.value))return;if(z.type==="date"&&!X&&!z.value)return;if(X!==z.value)z.value=X??""})}var O9=new Set;function c8(z,J,Q,K,X=K){var Z=Q.getAttribute("type")==="checkbox",w=z;let G=!1;if(J!==null)for(var H of J)w=w[H]??=[];if(w.push(Q),f8(Q,"change",()=>{var B=Q.__value;if(Z)B=h4(w,B,Q.checked);X(B)},()=>X(Z?[]:null)),Y1(()=>{var B=K();if(r&&Q.defaultChecked!==Q.checked){G=!0;return}if(Z)B=B||[],Q.checked=B.includes(Q.__value);else Q.checked=mz(Q.__value,B)}),B1(()=>{var B=w.indexOf(Q);if(B!==-1)w.splice(B,1)}),!O9.has(w))O9.add(w),m0(()=>{w.sort((B,F)=>B.compareDocumentPosition(F)===4?-1:1),O9.delete(w)});m0(()=>{if(G){var B;if(Z)B=h4(w,B,Q.checked);else{var F=w.find((q)=>q.checked);B=F?.__value}X(B)}})}function h4(z,J,Q){var K=new Set;for(var X=0;X<z.length;X+=1)if(z[X].checked)K.add(z[X].__value);if(!Q)K.delete(J);return Array.from(K)}function P9(z){var J=z.type;return J==="number"||J==="range"}function L9(z){return z===""?null:+z}class I9{#z=new WeakMap;#J;#Q;static entries=new WeakMap;constructor(z){this.#Q=z}observe(z,J){var Q=this.#z.get(z)||new Set;return Q.add(J),this.#z.set(z,Q),this.#Z().observe(z,this.#Q),()=>{var K=this.#z.get(z);if(K.delete(J),K.size===0)this.#z.delete(z),this.#J.unobserve(z)}}#Z(){return this.#J??(this.#J=new ResizeObserver((z)=>{for(var J of z){I9.entries.set(J.target,J);for(var Q of this.#z.get(J.target)||[])Q(J)}}))}}var UZ=new I9({box:"border-box"});function S9(z,J,Q){var K=UZ.observe(z,()=>Q(z[J]));H1(()=>{return T0(()=>Q(z[J])),K})}function m4(z,J){return z===J||z?.[e0]===J}function z5(z={},J,Q,K){return H1(()=>{var X,Z;return Y1(()=>{X=Z,Z=K?.()||[],T0(()=>{if(z!==Q(...Z)){if(J(z,...Z),X&&m4(Q(...X),z))J(null,...X)}})}),()=>{m0(()=>{if(Z&&m4(Q(...Z),z))J(null,...Z)})}}),z}function j9(z=!1){let J=L0,Q=J.l.u;if(!Q)return;let K=()=>iz(J.s);if(z){let X=0,Z={},w=X6(()=>{let G=!1,H=J.s;for(let B in H)if(H[B]!==Z[B])Z[B]=H[B],G=!0;if(G)X++;return X});K=()=>W(w)}if(Q.b.length)$8(()=>{f4(J,K),a6(Q.b)});if(Q1(()=>{let X=T0(()=>Q.m.map(nJ));return()=>{for(let Z of X)if(typeof Z==="function")Z()}}),Q.a.length)Q1(()=>{f4(J,K),a6(Q.a)})}function f4(z,J){if(z.l.s)for(let Q of z.l.s)W(Q);J()}var nz=!1,bF=Symbol();function D9(z){var J=nz;try{return nz=!1,[z(),nz]}finally{nz=J}}var qZ={get(z,J){if(z.exclude.includes(J))return;return z.props[J]},set(z,J){if(m)GQ(`${z.name}.${String(J)}`);return!1},getOwnPropertyDescriptor(z,J){if(z.exclude.includes(J))return;if(J in z.props)return{enumerable:!0,configurable:!0,value:z.props[J]}},has(z,J){if(z.exclude.includes(J))return!1;return J in z.props},ownKeys(z){return Reflect.ownKeys(z.props).filter((J)=>!z.exclude.includes(J))}};function c5(z,J,Q){return new Proxy(m?{props:z,exclude:J,name:Q,other:{},to_proxy:[]}:{props:z,exclude:J},qZ)}var FZ={get(z,J){let Q=z.props.length;while(Q--){let K=z.props[Q];if(C6(K))K=K();if(typeof K==="object"&&K!==null&&J in K)return K[J]}},set(z,J,Q){let K=z.props.length;while(K--){let X=z.props[K];if(C6(X))X=X();let Z=S1(X,J);if(Z&&Z.set)return Z.set(Q),!0}return!1},getOwnPropertyDescriptor(z,J){let Q=z.props.length;while(Q--){let K=z.props[Q];if(C6(K))K=K();if(typeof K==="object"&&K!==null&&J in K){let X=S1(K,J);if(X&&!X.configurable)X.configurable=!0;return X}}},has(z,J){if(J===e0||J===n6)return!1;for(let Q of z.props){if(C6(Q))Q=Q();if(Q!=null&&J in Q)return!0}return!1},ownKeys(z){let J=[];for(let Q of z.props){if(C6(Q))Q=Q();if(!Q)continue;for(let K in Q)if(!J.includes(K))J.push(K);for(let K of Object.getOwnPropertySymbols(Q))if(!J.includes(K))J.push(K)}return J}};function R9(...z){return new Proxy({props:z},FZ)}function j0(z,J,Q,K){var X=!l5||(Q&LQ)!==0,Z=(Q&SQ)!==0,w=(Q&jQ)!==0,G=K,H=!0,B=()=>{if(H)H=!1,G=w?T0(K):K;return G},F;if(Z){var q=e0 in z||n6 in z;F=S1(z,J)?.set??(q&&J in z?(v)=>z[J]=v:void 0)}var Y,U=!1;if(Z)[Y,U]=D9(()=>z[J]);else Y=z[J];if(Y===void 0&&K!==void 0){if(Y=B(),F){if(X)YQ(J);F(Y)}}var x;if(X)x=()=>{var v=z[J];if(v===void 0)return B();return H=!0,v};else x=()=>{var v=z[J];if(v!==void 0)G=void 0;return v===void 0?G:v};if(X&&(Q&IQ)===0)return x;if(F){var I=z.$$legacy;return function(v,T){if(arguments.length>0){if(!X||!T||I||U)F(T?x():v);return v}return x()}}var M=!1,A=((Q&PQ)!==0?X6:R6)(()=>{return M=!1,x()});if(m)A.label=J;if(Z)W(A);var E=Q0;return function(v,T){if(arguments.length>0){let y=T?W(A):X&&Z?C0(v):v;if(D(A,y),M=!0,G!==void 0)G=y;return v}if(w5&&M||(E.f&b1)!==0)return A.v;return W(A)}}function $4(z){return new u4(z)}class u4{#z;#J;constructor(z){var J=new Map,Q=(X,Z)=>{var w=d5(Z,!1,!1);return J.set(X,w),w};let K=new Proxy({...z.props||{},$$events:{}},{get(X,Z){return W(J.get(Z)??Q(Z,Reflect.get(X,Z)))},has(X,Z){if(Z===n6)return!0;return W(J.get(Z)??Q(Z,Reflect.get(X,Z))),Reflect.has(X,Z)},set(X,Z,w){return D(J.get(Z)??Q(Z,w),w),Reflect.set(X,Z,w)}});if(this.#J=(z.hydrate?Y9:B8)(z.component,{target:z.target,anchor:z.anchor,props:K,context:z.context,intro:z.intro??!1,recover:z.recover}),!F1&&(!z?.props?.$$host||z.sync===!1))K6();this.#z=K.$$events;for(let X of Object.keys(this.#J)){if(X==="$set"||X==="$destroy"||X==="$on")continue;V1(this,X,{get(){return this.#J[X]},set(Z){this.#J[X]=Z},enumerable:!0})}this.#J.$set=(X)=>{Object.assign(K,X)},this.#J.$destroy=()=>{G9(this.#J)}}$set(z){this.#J.$set(z)}$on(z,J){this.#z[z]=this.#z[z]||[];let Q=(...K)=>J.call(this,...K);return this.#z[z].push(Q),()=>{this.#z[z]=this.#z[z].filter((K)=>K!==Q)}}$destroy(){this.#J.$destroy()}}var SZ;if(typeof HTMLElement==="function")SZ=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(z,J,Q){super();if(this.$$ctor=z,this.$$s=J,Q)this.attachShadow({mode:"open"})}addEventListener(z,J,Q){if(this.$$l[z]=this.$$l[z]||[],this.$$l[z].push(J),this.$$c){let K=this.$$c.$on(z,J);this.$$l_u.set(J,K)}super.addEventListener(z,J,Q)}removeEventListener(z,J,Q){if(super.removeEventListener(z,J,Q),this.$$c){let K=this.$$l_u.get(J);if(K)K(),this.$$l_u.delete(J)}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let z=function(K){return(X)=>{let Z=document.createElement("slot");if(K!=="default")Z.name=K;V(X,Z)}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let J={},Q=jZ(this);for(let K of this.$$s)if(K in Q)if(K==="default"&&!this.$$d.children)this.$$d.children=z(K),J.default=!0;else J[K]=z(K);for(let K of this.attributes){let X=this.$$g_p(K.name);if(!(X in this.$$d))this.$$d[X]=A9(X,K.value,this.$$p_d,"toProp")}for(let K in this.$$p_d)if(!(K in this.$$d)&&this[K]!==void 0)this.$$d[K]=this[K],delete this[K];this.$$c=$4({component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:J,$$host:this}}),this.$$me=z9(()=>{Y1(()=>{this.$$r=!0;for(let K of D7(this.$$c)){if(!this.$$p_d[K]?.reflect)continue;this.$$d[K]=this.$$c[K];let X=A9(K,this.$$d[K],this.$$p_d,"toAttribute");if(X==null)this.removeAttribute(this.$$p_d[K].attribute||K);else this.setAttribute(this.$$p_d[K].attribute||K,X)}this.$$r=!1})});for(let K in this.$$l)for(let X of this.$$l[K]){let Z=this.$$c.$on(K,X);this.$$l_u.set(X,Z)}this.$$l={}}}attributeChangedCallback(z,J,Q){if(this.$$r)return;z=this.$$g_p(z),this.$$d[z]=A9(z,Q,this.$$p_d,"toProp"),this.$$c?.$set({[z]:this.$$d[z]})}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{if(!this.$$cn&&this.$$c)this.$$c.$destroy(),this.$$me(),this.$$c=void 0})}$$g_p(z){return D7(this.$$p_d).find((J)=>this.$$p_d[J].attribute===z||!this.$$p_d[J].attribute&&J.toLowerCase()===z)||z}};function A9(z,J,Q,K){let X=Q[z]?.type;if(J=X==="Boolean"&&typeof J!=="boolean"?J!=null:J,!K||!Q[z])return J;else if(K==="toAttribute")switch(X){case"Object":case"Array":return J==null?null:JSON.stringify(J);case"Boolean":return J?"":null;case"Number":return J==null?null:J;default:return J}else switch(X){case"Object":case"Array":return J&&JSON.parse(J);case"Boolean":return J;case"Number":return J!=null?+J:J;default:return J}}function jZ(z){let J={};return z.childNodes.forEach((Q)=>{J[Q.slot||"default"]=!0}),J}if(m){let z=function(J){if(!(J in globalThis)){let Q;Object.defineProperty(globalThis,J,{configurable:!0,get:()=>{if(Q!==void 0)return Q;BQ(J)},set:(K)=>{Q=K}})}};z("$state"),z("$effect"),z("$derived"),z("$inspect"),z("$props"),z("$bindable")}class N9{cache;prepareCache(){if(!this.cache){let z=localStorage.getItem("handleCache");this.cache=z?JSON.parse(z):{}}}saveCache(){localStorage.setItem("handleCache",JSON.stringify(this.cache))}getHandleDid(z){return this.prepareCache(),this.cache[z]}setHandleDid(z,J){this.prepareCache(),this.cache[z]=J,this.saveCache()}findHandleByDid(z){this.prepareCache();let J=Object.entries(this.cache).find((Q)=>Q[1]==z);return J?J[0]:void 0}}class H6 extends Error{code;json;constructor(z,J){super("APIError status "+z+`

`+JSON.stringify(J));this.code=z,this.json=J}}class k9 extends Error{}class B6 extends Error{}class s8{host;config;user;sendAuthHeaders;autoManageTokens;constructor(z,J,Q){if(this.host=z,this.config=J||null,this.user=J?.user||null,this.sendAuthHeaders=!!this.user,this.autoManageTokens=!!this.user,Q)Object.assign(this,Q)}get baseURL(){if(this.host)return(this.host.includes("://")?this.host:`https://${this.host}`)+"/xrpc";else throw new k9("Hostname not set")}get isLoggedIn(){return!!(this.user&&this.user.accessToken&&this.user.refreshToken&&this.user.did&&this.user.pdsEndpoint)}async getRequest(z,J,Q={}){let K=new URL(`${this.baseURL}/${z}`),X=Q&&"auth"in Q?Q.auth:this.sendAuthHeaders;if(this.autoManageTokens&&X===!0)await this.checkAccess();if(J)for(let G in J)if(J[G]instanceof Array)J[G].forEach((H)=>K.searchParams.append(G,H));else K.searchParams.append(G,J[G]);let Z=this.authHeaders(X);if(Q.headers)Object.assign(Z,Q.headers);let w=await fetch(K,{headers:Z,signal:Q.abortSignal??null});return await this.parseResponse(w)}async postRequest(z,J,Q={}){let K=`${this.baseURL}/${z}`,X=Q&&"auth"in Q?Q.auth:this.sendAuthHeaders;if(this.autoManageTokens&&X===!0)await this.checkAccess();let Z=this.authHeaders(X),w={method:"POST"};if(J)w.body=JSON.stringify(J),Z["Content-Type"]="application/json";if(Q.headers)Object.assign(Z,Q.headers);if(Q.abortSignal)w.signal=Q.abortSignal;w.headers=Z;let G=await fetch(K,w);return await this.parseResponse(G)}async fetchAll(z,J){if(!J||!J.field)throw new k9("'field' option is required");let Q=[],K=J.params??{},X=this.sliceOptions(J,["auth","headers","abortSignal"]);for(;;){let Z=await this.getRequest(z,K,X),w=Z[J.field],G=Z.cursor;if(J.breakWhen){let H=J.breakWhen;if(w.some((B)=>H(B))){if(!J.keepLastPage)w=w.filter((B)=>!H(B));G=null}}if(Q=Q.concat(w),K.cursor=G,J.onPageLoad?.(w),!G)break}return Q}authHeaders(z){if(typeof z=="string")return{Authorization:`Bearer ${z}`};else if(z)if(this.user?.accessToken)return{Authorization:`Bearer ${this.user.accessToken}`};else throw new B6("Can't send auth headers, access token is missing");else return{}}sliceOptions(z,J){let Q={};for(let K of J)if(K in z)Q[K]=z[K];return Q}tokenExpirationTimestamp(z){let J=z.split(".");if(J.length!=3)throw new B6("Invalid access token format");let K=JSON.parse(atob(J[1])).exp;if(!(K&&typeof K=="number"&&K>0))throw new B6("Invalid token expiry data");return K*1000}isInvalidToken(z,J){return z.status==400&&!!J&&["InvalidToken","ExpiredToken"].includes(J.error)}async parseResponse(z){let J=await z.text(),Q=J.trim().length>0?JSON.parse(J):void 0;if(z.status>=200&&z.status<300)return Q;else throw new H6(z.status,Q)}requireUserConfig(){if(!this.config||!this.config.user)throw new B6("Missing user configuration object")}requireLoggedInUser(){if(this.requireUserConfig(),!this.isLoggedIn)throw new B6("Not logged in")}async checkAccess(){if(this.requireLoggedInUser(),this.tokenExpirationTimestamp(this.user.accessToken)<new Date().getTime()+60000)await this.performTokenRefresh()}async logIn(z,J){this.requireUserConfig();let Q={identifier:z,password:J},K=await this.postRequest("com.atproto.server.createSession",Q,{auth:!1});return this.saveTokens(K),K}async performTokenRefresh(){this.requireLoggedInUser(),console.log("Refreshing access tokenâ€¦");let z=await this.postRequest("com.atproto.server.refreshSession",null,{auth:this.user.refreshToken});return this.saveTokens(z),z}saveTokens(z){if(this.requireUserConfig(),this.user.accessToken=z.accessJwt,this.user.refreshToken=z.refreshJwt,this.user.did=z.did,z.didDoc?.service){let J=z.didDoc.service.find((Q)=>Q.id=="#atproto_pds");this.host=J.serviceEndpoint.replace("https://","")}this.user.pdsEndpoint=this.host,this.config.save()}resetTokens(){this.requireUserConfig(),delete this.user.accessToken,delete this.user.refreshToken,delete this.user.did,delete this.user.pdsEndpoint,this.config.save()}}class l4{repo;collection;rkey;constructor(z){if(!z.startsWith("at://"))throw new s5(`Not an at:// URI: ${z}`);let J=z.split("/");if(J.length!=5)throw new s5(`Invalid at:// URI: ${z}`);this.repo=J[2],this.collection=J[3],this.rkey=J[4]}}function l0(z){return new l4(z)}function DZ(){return new IntersectionObserver((z,J)=>{for(let Q of z)if(Q.isIntersecting){let K=Q.target;K.removeAttribute("lazy"),J.unobserve(K)}},{rootMargin:"1000px 0px"})}var b9=DZ();/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */var{entries:r4,setPrototypeOf:p4,isFrozen:RZ,getPrototypeOf:AZ,getOwnPropertyDescriptor:NZ}=Object,{freeze:y1,seal:Y5,create:m9}=Object,{apply:f9,construct:$9}=typeof Reflect<"u"&&Reflect;if(!y1)y1=function(J){return J};if(!Y5)Y5=function(J){return J};if(!f9)f9=function(J,Q){for(var K=arguments.length,X=Array(K>2?K-2:0),Z=2;Z<K;Z++)X[Z-2]=arguments[Z];return J.apply(Q,X)};if(!$9)$9=function(J){for(var Q=arguments.length,K=Array(Q>1?Q-1:0),X=1;X<Q;X++)K[X-1]=arguments[X];return new J(...K)};var tz=v1(Array.prototype.forEach),kZ=v1(Array.prototype.lastIndexOf),d4=v1(Array.prototype.pop),o8=v1(Array.prototype.push),bZ=v1(Array.prototype.splice),z7=v1(String.prototype.toLowerCase),T9=v1(String.prototype.toString),E9=v1(String.prototype.match),a8=v1(String.prototype.replace),TZ=v1(String.prototype.indexOf),EZ=v1(String.prototype.trim),C5=v1(Object.prototype.hasOwnProperty),E1=v1(RegExp.prototype.test),r8=yZ(TypeError);function v1(z){return function(J){if(J instanceof RegExp)J.lastIndex=0;for(var Q=arguments.length,K=Array(Q>1?Q-1:0),X=1;X<Q;X++)K[X-1]=arguments[X];return f9(z,J,K)}}function yZ(z){return function(){for(var J=arguments.length,Q=Array(J),K=0;K<J;K++)Q[K]=arguments[K];return $9(z,Q)}}function O0(z,J){let Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:z7;if(p4)p4(z,null);let K=J.length;while(K--){let X=J[K];if(typeof X==="string"){let Z=Q(X);if(Z!==X){if(!RZ(J))J[K]=Z;X=Z}}z[X]=!0}return z}function vZ(z){for(let J=0;J<z.length;J++)if(!C5(z,J))z[J]=null;return z}function T5(z){let J=m9(null);for(let[Q,K]of r4(z))if(C5(z,Q))if(Array.isArray(K))J[Q]=vZ(K);else if(K&&typeof K==="object"&&K.constructor===Object)J[Q]=T5(K);else J[Q]=K;return J}function n8(z,J){while(z!==null){let K=NZ(z,J);if(K){if(K.get)return v1(K.get);if(typeof K.value==="function")return v1(K.value)}z=AZ(z)}function Q(){return null}return Q}var i4=y1(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),y9=y1(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),v9=y1(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gZ=y1(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),g9=y1(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hZ=y1(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_4=y1(["#text"]),c4=y1(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),h9=y1(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),s4=y1(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ez=y1(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mZ=Y5(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fZ=Y5(/<%[\w\W]*|[\w\W]*%>/gm),$Z=Y5(/\$\{[\w\W]*/gm),uZ=Y5(/^data-[\-\w.\u00B7-\uFFFF]+$/),lZ=Y5(/^aria-[\-\w]+$/),n4=Y5(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),pZ=Y5(/^(?:\w+script|data):/i),dZ=Y5(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),t4=Y5(/^html$/i),iZ=Y5(/^[a-z][.\w]*(-[.\w]+)+$/i),o4=Object.freeze({__proto__:null,ARIA_ATTR:lZ,ATTR_WHITESPACE:dZ,CUSTOM_ELEMENT:iZ,DATA_ATTR:uZ,DOCTYPE_NAME:t4,ERB_EXPR:fZ,IS_ALLOWED_URI:n4,IS_SCRIPT_OR_DATA:pZ,MUSTACHE_EXPR:mZ,TMPLIT_EXPR:$Z}),t8={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},_Z=function(){return typeof window>"u"?null:window},cZ=function(J,Q){if(typeof J!=="object"||typeof J.createPolicy!=="function")return null;let K=null,X="data-tt-policy-suffix";if(Q&&Q.hasAttribute(X))K=Q.getAttribute(X);let Z="dompurify"+(K?"#"+K:"");try{return J.createPolicy(Z,{createHTML(w){return w},createScriptURL(w){return w}})}catch(w){return console.warn("TrustedTypes policy "+Z+" could not be created."),null}},a4=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function e4(){let z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_Z(),J=(Z0)=>e4(Z0);if(J.version="3.3.1",J.removed=[],!z||!z.document||z.document.nodeType!==t8.document||!z.Element)return J.isSupported=!1,J;let{document:Q}=z,K=Q,X=K.currentScript,{DocumentFragment:Z,HTMLTemplateElement:w,Node:G,Element:H,NodeFilter:B,NamedNodeMap:F=z.NamedNodeMap||z.MozNamedAttrMap,HTMLFormElement:q,DOMParser:Y,trustedTypes:U}=z,x=H.prototype,I=n8(x,"cloneNode"),M=n8(x,"remove"),A=n8(x,"nextSibling"),E=n8(x,"childNodes"),v=n8(x,"parentNode");if(typeof w==="function"){let Z0=Q.createElement("template");if(Z0.content&&Z0.content.ownerDocument)Q=Z0.content.ownerDocument}let T,y="",{implementation:N,createNodeIterator:R,createDocumentFragment:k,getElementsByTagName:$}=Q,{importNode:b}=K,l=a4();J.isSupported=typeof r4==="function"&&typeof v==="function"&&N&&N.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:n,ERB_EXPR:s,TMPLIT_EXPR:a,DATA_ATTR:W0,ARIA_ATTR:K0,IS_SCRIPT_OR_DATA:q0,ATTR_WHITESPACE:o,CUSTOM_ELEMENT:e}=o4,{IS_ALLOWED_URI:P0}=o4,V0=null,k0=O0({},[...i4,...y9,...v9,...g9,..._4]),Y0=null,z0=O0({},[...c4,...h9,...s4,...ez]),t=Object.seal(m9(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),B0=null,D0=null,H0=Object.seal(m9(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),G0=!0,n0=!0,v5=!1,Hz=!0,a5=!1,r5=!0,B5=!1,l6=!1,p6=!1,n5=!1,d6=!1,Uz=!1,EJ=!0,yJ=!1,LK="user-content-",M7=!0,N8=!1,i6={},P5=null,C7=O0({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),vJ=null,gJ=O0({},["audio","video","img","source","image","track"]),O7=null,hJ=O0({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Vz="http://www.w3.org/1998/Math/MathML",qz="http://www.w3.org/2000/svg",g5="http://www.w3.org/1999/xhtml",_6=g5,P7=!1,L7=null,IK=O0({},[Vz,qz,g5],T9),Fz=O0({},["mi","mo","mn","ms","mtext"]),xz=O0({},["annotation-xml"]),SK=O0({},["title","style","font","a","script"]),k8=null,jK=["application/xhtml+xml","text/html"],DK="text/html",t0=null,c6=null,RK=Q.createElement("form"),mJ=function(L){return L instanceof RegExp||L instanceof Function},I7=function(){let L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(c6&&c6===L)return;if(!L||typeof L!=="object")L={};if(L=T5(L),k8=jK.indexOf(L.PARSER_MEDIA_TYPE)===-1?DK:L.PARSER_MEDIA_TYPE,t0=k8==="application/xhtml+xml"?T9:z7,V0=C5(L,"ALLOWED_TAGS")?O0({},L.ALLOWED_TAGS,t0):k0,Y0=C5(L,"ALLOWED_ATTR")?O0({},L.ALLOWED_ATTR,t0):z0,L7=C5(L,"ALLOWED_NAMESPACES")?O0({},L.ALLOWED_NAMESPACES,T9):IK,O7=C5(L,"ADD_URI_SAFE_ATTR")?O0(T5(hJ),L.ADD_URI_SAFE_ATTR,t0):hJ,vJ=C5(L,"ADD_DATA_URI_TAGS")?O0(T5(gJ),L.ADD_DATA_URI_TAGS,t0):gJ,P5=C5(L,"FORBID_CONTENTS")?O0({},L.FORBID_CONTENTS,t0):C7,B0=C5(L,"FORBID_TAGS")?O0({},L.FORBID_TAGS,t0):T5({}),D0=C5(L,"FORBID_ATTR")?O0({},L.FORBID_ATTR,t0):T5({}),i6=C5(L,"USE_PROFILES")?L.USE_PROFILES:!1,G0=L.ALLOW_ARIA_ATTR!==!1,n0=L.ALLOW_DATA_ATTR!==!1,v5=L.ALLOW_UNKNOWN_PROTOCOLS||!1,Hz=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,a5=L.SAFE_FOR_TEMPLATES||!1,r5=L.SAFE_FOR_XML!==!1,B5=L.WHOLE_DOCUMENT||!1,n5=L.RETURN_DOM||!1,d6=L.RETURN_DOM_FRAGMENT||!1,Uz=L.RETURN_TRUSTED_TYPE||!1,p6=L.FORCE_BODY||!1,EJ=L.SANITIZE_DOM!==!1,yJ=L.SANITIZE_NAMED_PROPS||!1,M7=L.KEEP_CONTENT!==!1,N8=L.IN_PLACE||!1,P0=L.ALLOWED_URI_REGEXP||n4,_6=L.NAMESPACE||g5,Fz=L.MATHML_TEXT_INTEGRATION_POINTS||Fz,xz=L.HTML_INTEGRATION_POINTS||xz,t=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&mJ(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck))t.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck;if(L.CUSTOM_ELEMENT_HANDLING&&mJ(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck))t.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;if(L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean")t.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;if(a5)n0=!1;if(d6)n5=!0;if(i6){if(V0=O0({},_4),Y0=[],i6.html===!0)O0(V0,i4),O0(Y0,c4);if(i6.svg===!0)O0(V0,y9),O0(Y0,h9),O0(Y0,ez);if(i6.svgFilters===!0)O0(V0,v9),O0(Y0,h9),O0(Y0,ez);if(i6.mathMl===!0)O0(V0,g9),O0(Y0,s4),O0(Y0,ez)}if(L.ADD_TAGS)if(typeof L.ADD_TAGS==="function")H0.tagCheck=L.ADD_TAGS;else{if(V0===k0)V0=T5(V0);O0(V0,L.ADD_TAGS,t0)}if(L.ADD_ATTR)if(typeof L.ADD_ATTR==="function")H0.attributeCheck=L.ADD_ATTR;else{if(Y0===z0)Y0=T5(Y0);O0(Y0,L.ADD_ATTR,t0)}if(L.ADD_URI_SAFE_ATTR)O0(O7,L.ADD_URI_SAFE_ATTR,t0);if(L.FORBID_CONTENTS){if(P5===C7)P5=T5(P5);O0(P5,L.FORBID_CONTENTS,t0)}if(L.ADD_FORBID_CONTENTS){if(P5===C7)P5=T5(P5);O0(P5,L.ADD_FORBID_CONTENTS,t0)}if(M7)V0["#text"]=!0;if(B5)O0(V0,["html","head","body"]);if(V0.table)O0(V0,["tbody"]),delete B0.tbody;if(L.TRUSTED_TYPES_POLICY){if(typeof L.TRUSTED_TYPES_POLICY.createHTML!=="function")throw r8('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof L.TRUSTED_TYPES_POLICY.createScriptURL!=="function")throw r8('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');T=L.TRUSTED_TYPES_POLICY,y=T.createHTML("")}else{if(T===void 0)T=cZ(U,X);if(T!==null&&typeof y==="string")y=T.createHTML("")}if(y1)y1(L);c6=L},fJ=O0({},[...y9,...v9,...gZ]),$J=O0({},[...g9,...hZ]),AK=function(L){let p=v(L);if(!p||!p.tagName)p={namespaceURI:_6,tagName:"template"};let J0=z7(L.tagName),$0=z7(p.tagName);if(!L7[L.namespaceURI])return!1;if(L.namespaceURI===qz){if(p.namespaceURI===g5)return J0==="svg";if(p.namespaceURI===Vz)return J0==="svg"&&($0==="annotation-xml"||Fz[$0]);return Boolean(fJ[J0])}if(L.namespaceURI===Vz){if(p.namespaceURI===g5)return J0==="math";if(p.namespaceURI===qz)return J0==="math"&&xz[$0];return Boolean($J[J0])}if(L.namespaceURI===g5){if(p.namespaceURI===qz&&!xz[$0])return!1;if(p.namespaceURI===Vz&&!Fz[$0])return!1;return!$J[J0]&&(SK[J0]||!fJ[J0])}if(k8==="application/xhtml+xml"&&L7[L.namespaceURI])return!0;return!1},L5=function(L){o8(J.removed,{element:L});try{v(L).removeChild(L)}catch(p){M(L)}},x6=function(L,p){try{o8(J.removed,{attribute:p.getAttributeNode(L),from:p})}catch(J0){o8(J.removed,{attribute:null,from:p})}if(p.removeAttribute(L),L==="is")if(n5||d6)try{L5(p)}catch(J0){}else try{p.setAttribute(L,"")}catch(J0){}},uJ=function(L){let p=null,J0=null;if(p6)L="<remove></remove>"+L;else{let c0=E9(L,/^[\r\n\t ]+/);J0=c0&&c0[0]}if(k8==="application/xhtml+xml"&&_6===g5)L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>";let $0=T?T.createHTML(L):L;if(_6===g5)try{p=new Y().parseFromString($0,k8)}catch(c0){}if(!p||!p.documentElement){p=N.createDocument(_6,"template",null);try{p.documentElement.innerHTML=P7?y:$0}catch(c0){}}let I1=p.body||p.documentElement;if(L&&J0)I1.insertBefore(Q.createTextNode(J0),I1.childNodes[0]||null);if(_6===g5)return $.call(p,B5?"html":"body")[0];return B5?p.documentElement:I1},lJ=function(L){return R.call(L.ownerDocument||L,L,B.SHOW_ELEMENT|B.SHOW_COMMENT|B.SHOW_TEXT|B.SHOW_PROCESSING_INSTRUCTION|B.SHOW_CDATA_SECTION,null)},S7=function(L){return L instanceof q&&(typeof L.nodeName!=="string"||typeof L.textContent!=="string"||typeof L.removeChild!=="function"||!(L.attributes instanceof F)||typeof L.removeAttribute!=="function"||typeof L.setAttribute!=="function"||typeof L.namespaceURI!=="string"||typeof L.insertBefore!=="function"||typeof L.hasChildNodes!=="function")},pJ=function(L){return typeof G==="function"&&L instanceof G};function h5(Z0,L,p){tz(Z0,(J0)=>{J0.call(J,L,p,c6)})}let dJ=function(L){let p=null;if(h5(l.beforeSanitizeElements,L,null),S7(L))return L5(L),!0;let J0=t0(L.nodeName);if(h5(l.uponSanitizeElement,L,{tagName:J0,allowedTags:V0}),r5&&L.hasChildNodes()&&!pJ(L.firstElementChild)&&E1(/<[/\w!]/g,L.innerHTML)&&E1(/<[/\w!]/g,L.textContent))return L5(L),!0;if(L.nodeType===t8.progressingInstruction)return L5(L),!0;if(r5&&L.nodeType===t8.comment&&E1(/<[/\w]/g,L.data))return L5(L),!0;if(!(H0.tagCheck instanceof Function&&H0.tagCheck(J0))&&(!V0[J0]||B0[J0])){if(!B0[J0]&&_J(J0)){if(t.tagNameCheck instanceof RegExp&&E1(t.tagNameCheck,J0))return!1;if(t.tagNameCheck instanceof Function&&t.tagNameCheck(J0))return!1}if(M7&&!P5[J0]){let $0=v(L)||L.parentNode,I1=E(L)||L.childNodes;if(I1&&$0){let c0=I1.length;for(let g1=c0-1;g1>=0;--g1){let m5=I(I1[g1],!0);m5.__removalCount=(L.__removalCount||0)+1,$0.insertBefore(m5,A(L))}}}return L5(L),!0}if(L instanceof H&&!AK(L))return L5(L),!0;if((J0==="noscript"||J0==="noembed"||J0==="noframes")&&E1(/<\/no(script|embed|frames)/i,L.innerHTML))return L5(L),!0;if(a5&&L.nodeType===t8.text){if(p=L.textContent,tz([n,s,a],($0)=>{p=a8(p,$0," ")}),L.textContent!==p)o8(J.removed,{element:L.cloneNode()}),L.textContent=p}return h5(l.afterSanitizeElements,L,null),!1},iJ=function(L,p,J0){if(EJ&&(p==="id"||p==="name")&&((J0 in Q)||(J0 in RK)))return!1;if(n0&&!D0[p]&&E1(W0,p));else if(G0&&E1(K0,p));else if(H0.attributeCheck instanceof Function&&H0.attributeCheck(p,L));else if(!Y0[p]||D0[p])if(_J(L)&&(t.tagNameCheck instanceof RegExp&&E1(t.tagNameCheck,L)||t.tagNameCheck instanceof Function&&t.tagNameCheck(L))&&(t.attributeNameCheck instanceof RegExp&&E1(t.attributeNameCheck,p)||t.attributeNameCheck instanceof Function&&t.attributeNameCheck(p,L))||p==="is"&&t.allowCustomizedBuiltInElements&&(t.tagNameCheck instanceof RegExp&&E1(t.tagNameCheck,J0)||t.tagNameCheck instanceof Function&&t.tagNameCheck(J0)));else return!1;else if(O7[p]);else if(E1(P0,a8(J0,o,"")));else if((p==="src"||p==="xlink:href"||p==="href")&&L!=="script"&&TZ(J0,"data:")===0&&vJ[L]);else if(v5&&!E1(q0,a8(J0,o,"")));else if(J0)return!1;return!0},_J=function(L){return L!=="annotation-xml"&&E9(L,e)},cJ=function(L){h5(l.beforeSanitizeAttributes,L,null);let{attributes:p}=L;if(!p||S7(L))return;let J0={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Y0,forceKeepAttr:void 0},$0=p.length;while($0--){let I1=p[$0],{name:c0,namespaceURI:g1,value:m5}=I1,s6=t0(c0),j7=m5,U1=c0==="value"?j7:EZ(j7);if(J0.attrName=s6,J0.attrValue=U1,J0.keepAttr=!0,J0.forceKeepAttr=void 0,h5(l.uponSanitizeAttribute,L,J0),U1=J0.attrValue,yJ&&(s6==="id"||s6==="name"))x6(c0,L),U1=LK+U1;if(r5&&E1(/((--!?|])>)|<\/(style|title|textarea)/i,U1)){x6(c0,L);continue}if(s6==="attributename"&&E9(U1,"href")){x6(c0,L);continue}if(J0.forceKeepAttr)continue;if(!J0.keepAttr){x6(c0,L);continue}if(!Hz&&E1(/\/>/i,U1)){x6(c0,L);continue}if(a5)tz([n,s,a],(oJ)=>{U1=a8(U1,oJ," ")});let sJ=t0(L.nodeName);if(!iJ(sJ,s6,U1)){x6(c0,L);continue}if(T&&typeof U==="object"&&typeof U.getAttributeType==="function")if(g1);else switch(U.getAttributeType(sJ,s6)){case"TrustedHTML":{U1=T.createHTML(U1);break}case"TrustedScriptURL":{U1=T.createScriptURL(U1);break}}if(U1!==j7)try{if(g1)L.setAttributeNS(g1,c0,U1);else L.setAttribute(c0,U1);if(S7(L))L5(L);else d4(J.removed)}catch(oJ){x6(c0,L)}}h5(l.afterSanitizeAttributes,L,null)},NK=function Z0(L){let p=null,J0=lJ(L);h5(l.beforeSanitizeShadowDOM,L,null);while(p=J0.nextNode())if(h5(l.uponSanitizeShadowNode,p,null),dJ(p),cJ(p),p.content instanceof Z)Z0(p.content);h5(l.afterSanitizeShadowDOM,L,null)};return J.sanitize=function(Z0){let L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=null,J0=null,$0=null,I1=null;if(P7=!Z0,P7)Z0="<!-->";if(typeof Z0!=="string"&&!pJ(Z0))if(typeof Z0.toString==="function"){if(Z0=Z0.toString(),typeof Z0!=="string")throw r8("dirty is not a string, aborting")}else throw r8("toString is not a function");if(!J.isSupported)return Z0;if(!l6)I7(L);if(J.removed=[],typeof Z0==="string")N8=!1;if(N8){if(Z0.nodeName){let m5=t0(Z0.nodeName);if(!V0[m5]||B0[m5])throw r8("root node is forbidden and cannot be sanitized in-place")}}else if(Z0 instanceof G)if(p=uJ("<!---->"),J0=p.ownerDocument.importNode(Z0,!0),J0.nodeType===t8.element&&J0.nodeName==="BODY")p=J0;else if(J0.nodeName==="HTML")p=J0;else p.appendChild(J0);else{if(!n5&&!a5&&!B5&&Z0.indexOf("<")===-1)return T&&Uz?T.createHTML(Z0):Z0;if(p=uJ(Z0),!p)return n5?null:Uz?y:""}if(p&&p6)L5(p.firstChild);let c0=lJ(N8?Z0:p);while($0=c0.nextNode())if(dJ($0),cJ($0),$0.content instanceof Z)NK($0.content);if(N8)return Z0;if(n5){if(d6){I1=k.call(p.ownerDocument);while(p.firstChild)I1.appendChild(p.firstChild)}else I1=p;if(Y0.shadowroot||Y0.shadowrootmode)I1=b.call(K,I1,!0);return I1}let g1=B5?p.outerHTML:p.innerHTML;if(B5&&V0["!doctype"]&&p.ownerDocument&&p.ownerDocument.doctype&&p.ownerDocument.doctype.name&&E1(t4,p.ownerDocument.doctype.name))g1="<!DOCTYPE "+p.ownerDocument.doctype.name+`>
`+g1;if(a5)tz([n,s,a],(m5)=>{g1=a8(g1,m5," ")});return T&&Uz?T.createHTML(g1):g1},J.setConfig=function(){let Z0=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};I7(Z0),l6=!0},J.clearConfig=function(){c6=null,l6=!1},J.isValidAttribute=function(Z0,L,p){if(!c6)I7({});let J0=t0(Z0),$0=t0(L);return iJ(J0,$0,p)},J.addHook=function(Z0,L){if(typeof L!=="function")return;o8(l[Z0],L)},J.removeHook=function(Z0,L){if(L!==void 0){let p=kZ(l[Z0],L);return p===-1?void 0:bZ(l[Z0],p,1)[0]}return d4(l[Z0])},J.removeHooks=function(Z0){l[Z0]=[]},J.removeAllHooks=function(){l=a4()},J}var zK=e4();function v6(z){return J7(z,"day")}function J7(z,J,Q){if(z==1)return`1 ${J}`;else return Q=Q??`${J}s`,`${z} ${Q}`}function JK(z){return zK.sanitize(z,{ALLOWED_TAGS:["a","b","blockquote","br","code","dd","del","div","dl","dt","em","font","h1","h2","h3","h4","h5","h6","hr","i","li","ol","p","q","pre","s","span","strong","sub","sup","u","wbr","#text"],ALLOWED_ATTR:["align","alt","class","clear","color","dir","href","lang","rel","title","translate"]})}function QK(z,J){if(z.length<=J)return z;else return z.slice(0,J-1)+"â€¦"}function g6(z){if(z===void 0||z===null||typeof z=="number")return z;else return parseInt(z,10)}function d1(z){let J=z.reason?z.reason.indexedAt:z.post.record.createdAt;return Date.parse(J)}function q8(z){try{let J=new URL(z);return J.protocol=="http:"||J.protocol=="https:"}catch(J){return console.error("Invalid URL: "+J),!1}}function KK(z,J){return z.getDate()==J.getDate()&&z.getMonth()==J.getMonth()&&z.getFullYear()==J.getFullYear()}function U6(z){console.log(z),alert(z)}class i1{constructor(z,J){this.data=z,Object.assign(this,J??{})}get uri(){return this.data.uri}get cid(){return this.data.cid}get rkey(){return l0(this.uri).rkey}get type(){return this.data.$type}}class e8 extends i1{constructor(z){super(z);this.author=z.creator}get title(){return this.data.displayName}get description(){return this.data.description}get likeCount(){return g6(this.data.likeCount)}get avatar(){return this.data.avatar}}class zz extends i1{constructor(z){super(z);this.author=z.creator}get title(){return this.data.name}get purpose(){return this.data.purpose}get description(){return this.data.description}get avatar(){return this.data.avatar}}class Jz extends i1{constructor(z){super(z);this.author=z.creator}get title(){return this.data.record.name}get description(){return this.data.record.description}}class Z1{json;static parseInlineEmbed(z){switch(z.$type){case"app.bsky.embed.record#view":return new x8(z);case"app.bsky.embed.recordWithMedia#view":return new M8(z);case"app.bsky.embed.images#view":return new W7(z);case"app.bsky.embed.external#view":return new C8(z);case"app.bsky.embed.video#view":return new O8(z);default:if(location.protocol=="file:")throw new F8(`Unexpected embed type: ${z.$type}`);else return console.warn("Unexpected embed type:",z.$type),new Z1(z)}}static parseRawEmbed(z){switch(z.$type){case"app.bsky.embed.record":return new X7(z);case"app.bsky.embed.recordWithMedia":return new w7(z);case"app.bsky.embed.images":return new Q7(z);case"app.bsky.embed.external":return new K7(z);case"app.bsky.embed.video":return new Z7(z);default:if(location.protocol=="file:")throw new F8(`Unexpected embed type: ${z.$type}`);else return console.warn("Unexpected embed type:",z.$type),new Z1(z)}}constructor(z){this.json=z}get type(){return this.json.$type}}class Q7 extends Z1{images;constructor(z){super(z);this.images=z.images}}class K7 extends Z1{url;title;thumb;constructor(z){super(z);this.url=z.external.uri,this.title=z.external.title,this.thumb=z.external.thumb}}class Z7 extends Z1{video;constructor(z){super(z);this.video=z.video}}class X7 extends Z1{record;constructor(z){super(z);this.record=new i1(z.record)}}class w7 extends Z1{record;media;constructor(z){super(z);this.record=new i1(z.record.record),this.media=Z1.parseRawEmbed(z.media)}}class x8 extends Z1{record;constructor(z){super(z);this.record=u9(z.record)}}class M8 extends Z1{record;media;constructor(z){super(z);this.record=u9(z.record.record),this.media=Z1.parseInlineEmbed(z.media)}}class C8 extends Z1{url;title;description;thumb;constructor(z){super(z);this.url=z.external.uri,this.title=z.external.title,this.description=z.external.description,this.thumb=z.external.thumb}}class W7 extends Z1{images;constructor(z){super(z);this.images=z.images}}class O8 extends Z1{playlistURL;alt;constructor(z){super(z);this.playlistURL=z.playlist,this.alt=z.alt}}class F8 extends Error{constructor(z){super(z)}}class h6 extends i1{get didLinkToAuthor(){let{repo:z}=l0(this.uri);return`https://bsky.app/profile/${z}`}}function V6(z,J=null,Q=0,K=0){switch(z.$type){case"app.bsky.feed.defs#threadViewPost":let X=new S0(z.post,{level:Q,absoluteLevel:K});if(X.pageRoot=J??X,z.replies){let Z=z.replies.map((w)=>V6(w,X.pageRoot,Q+1,K+1));X.setReplies(Z)}if(K<=0&&z.parent)X.parent=V6(z.parent,X.pageRoot,Q-1,K-1);return X;case"app.bsky.feed.defs#notFoundPost":return new O5(z);case"app.bsky.feed.defs#blockedPost":return new E5(z);default:throw new F8(`Unexpected record type: ${z.$type}`)}}function u9(z){switch(z.$type){case"app.bsky.embed.record#viewRecord":return new S0(z,{isEmbed:!0});case"app.bsky.embed.record#viewNotFound":return new O5(z);case"app.bsky.embed.record#viewBlocked":return new E5(z);case"app.bsky.embed.record#viewDetached":return new P8(z);case"app.bsky.feed.defs#generatorView":return new e8(z);case"app.bsky.graph.defs#listView":return new zz(z);case"app.bsky.graph.defs#starterPackViewBasic":return new Jz(z);default:return console.warn("Unknown record type:",z.$type),new i1(z)}}function XK(z){let J=new S0(z.post);if(z.reply){if(J.parent=ZK(z.reply.parent),J.threadRoot=ZK(z.reply.root),z.reply.grandparentAuthor)J.grandparentAuthor=z.reply.grandparentAuthor}if(z.reason)J.reason=z.reason;return J}function ZK(z){switch(z.$type){case"app.bsky.feed.defs#postView":return new S0(z);case"app.bsky.feed.defs#notFoundPost":return new O5(z);case"app.bsky.feed.defs#blockedPost":return new E5(z);default:throw new F8(`Unexpected record type: ${z.$type}`)}}class S0 extends h6{parent;threadRoot;pageRoot;replies;grandparentAuthor;level;absoluteLevel;reason;isEmbed;constructor(z,J){super(z);if(Object.assign(this,J??{}),this.absoluteLevel===0)this.pageRoot=this;if(this.record=this.isPostView?z.record:z.value,this.isPostView&&z.embed)this.embed=Z1.parseInlineEmbed(z.embed);else if(this.isEmbed&&z.embeds&&z.embeds[0])this.embed=Z1.parseInlineEmbed(z.embeds[0]);else if(this.record.embed)this.embed=Z1.parseRawEmbed(this.record.embed);if(this.author=this.author??z.author,this.replies=[],this.viewerData=z.viewer,this.viewerLike=z.viewer?.like,this.author)N0.cacheProfile(this.author)}updateDataFromPost(z){this.record=z.record,this.embed=z.embed,this.author=z.author,this.viewerData=z.viewerData,this.viewerLike=z.viewerLike,this.level=z.level,this.absoluteLevel=z.absoluteLevel,this.setReplies(z.replies)}setReplies(z){this.replies=z,this.replies.sort(this.sortReplies.bind(this))}sortReplies(z,J){if(z instanceof S0&&J instanceof S0)if(z.author.did==this.author.did&&J.author.did!=this.author.did)return-1;else if(z.author.did!=this.author.did&&J.author.did==this.author.did)return 1;else if(z.text!="\uD83D\uDCCC"&&J.text=="\uD83D\uDCCC")return-1;else if(z.text=="\uD83D\uDCCC"&&J.text!="\uD83D\uDCCC")return 1;else if(z.createdAt.getTime()<J.createdAt.getTime())return-1;else if(z.createdAt.getTime()>J.createdAt.getTime())return 1;else return 0;else if(z instanceof S0)return-1;else if(J instanceof S0)return 1;else return 0}get isPostView(){return!this.isEmbed}get isFediPost(){return this.author?.handle.endsWith(".ap.brid.gy")}get originalFediContent(){return this.record.bridgyOriginalText}get originalFediURL(){return this.record.bridgyOriginalUrl}get isPageRoot(){return this.pageRoot===this}get authorFediHandle(){if(this.isFediPost)return this.author.handle.replace(/\.ap\.brid\.gy$/,"").replace(".","@");else throw"Not a Fedi post"}get hasValidHandle(){return this.author.handle!="handle.invalid"}get authorDisplayName(){if(this.author.displayName)return this.author.displayName.trim();else if(this.author.handle.endsWith(".bsky.social"))return this.author.handle.replace(/\.bsky\.social$/,"");else return this.author.handle}get linkToAuthor(){return"https://bsky.app/profile/"+(this.hasValidHandle?this.author.handle:this.author.did)}get linkToPost(){return this.linkToAuthor+"/post/"+this.rkey}get text(){return this.record.text}get lowercaseText(){if(!this._lowercaseText)this._lowercaseText=this.record.text.toLowerCase();return this._lowercaseText}get facets(){return this.record.facets}get tags(){return this.record.tags}get createdAt(){return new Date(this.record.createdAt)}get likeCount(){return g6(this.data.likeCount)}get replyCount(){return g6(this.data.replyCount)}get quoteCount(){return g6(this.data.quoteCount)}get hasMoreReplies(){return this.replyCount!==void 0&&this.replyCount>this.replies.length&&this.replies.length===0&&(this.level!==void 0&&this.level>4)}get hasHiddenReplies(){return this.replyCount!==void 0&&this.replyCount>this.replies.length&&(this.replies.length>0||this.level!==void 0&&this.level<=4)}get isRestrictingReplies(){return!!(this.data.threadgate&&this.data.threadgate.record.allow)}get repostCount(){return g6(this.data.repostCount)}get liked(){return this.viewerLike!==void 0}get muted(){return this.author.viewer?.muted}get muteList(){return this.author.viewer?.mutedByList?.name}get hasViewerInfo(){return this.viewerData!==void 0}get parentReference(){return this.record.reply?.parent&&new i1(this.record.reply?.parent)}get rootReference(){return this.record.reply?.root&&new i1(this.record.reply?.root)}}class E5 extends h6{constructor(z){super(z);this.author=z.author}get blocksUser(){return!!this.author.viewer?.blocking}get blockedByUser(){return this.author.viewer?.blockedBy}}class O5 extends h6{}class P8 extends h6{}class l9 extends Error{}class s5 extends Error{constructor(z){super(z)}}class _1 extends s8{handleCache;profiles;constructor(z,J,Q){super(z,J,Q);this.handleCache=new N9,this.profiles={}}cacheProfile(z){this.profiles[z.did]=z,this.profiles[z.handle]=z,this.handleCache.setHandleDid(z.handle,z.did)}async fetchHandleForDid(z){let J=this.handleCache.findHandleByDid(z);if(J)return J;else return(await this.loadUserProfile(z)).handle}async resolveHandle(z){let J=this.handleCache.getHandleDid(z);if(J)return J;else{let Q=await this.getRequest("com.atproto.identity.resolveHandle",{handle:z},{auth:!1}),K=Q.did;if(K)return this.handleCache.setHandleDid(z,K),K;else throw new l9("Missing DID in response: "+JSON.stringify(Q))}}async loadThreadByURL(z){let{user:J,post:Q}=Qz(z);return await this.loadThreadById(J,Q)}async loadThreadById(z,J){let K=`at://${z.startsWith("did:")?z:await this.resolveHandle(z)}/app.bsky.feed.post/${J}`;return await this.loadThreadByAtURI(K)}async loadThreadByAtURI(z){return await this.getRequest("app.bsky.feed.getPostThread",{uri:z,depth:10})}async loadUserProfile(z){if(this.profiles[z])return this.profiles[z];else{let J=await this.getRequest("app.bsky.actor.getProfile",{actor:z});return this.cacheProfile(J),J}}async autocompleteUsers(z){return(await this.getRequest("app.bsky.actor.searchActorsTypeahead",{q:z})).actors}async getReplies(z){return(await this.fetchAll("blue.microcosm.links.getBacklinks",{field:"records",params:{subject:z,source:"app.bsky.feed.post:reply.parent.uri",limit:100}})).map((Q)=>`at://${Q.did}/${Q.collection}/${Q.rkey}`)}async getQuoteCount(z){return(await this.getRequest("blue.feeds.post.getQuoteCount",{uri:z})).quoteCount}async getQuotes(z,J){let Q;if(z.startsWith("at://"))Q=z;else{let{user:X,post:Z}=Qz(z);Q=`at://${X.startsWith("did:")?X:await q6.resolveHandle(X)}/app.bsky.feed.post/${Z}`}let K={uri:Q};if(J)K.cursor=J;return await this.getRequest("blue.feeds.post.getQuotes",K)}async getHashtagFeed(z,J){let Q={q:"#"+z,limit:50,sort:"latest"};if(J)Q.cursor=J;return await this.getRequest("app.bsky.feed.searchPosts",Q)}async loadHiddenReplies(z){let Q=(await p9.getReplies(z.uri)).filter((Z)=>!z.replies.some((w)=>w.uri===Z));Q.sort((Z,w)=>{let G=Z.split("/").at(-1),H=w.split("/").at(-1);return G.localeCompare(H)});let K=Q.map((Z)=>this.loadThreadByAtURI(Z));return(await Promise.allSettled(K)).map((Z)=>Z.status=="fulfilled"?Z.value:null)}async loadUserTimeline(z,J,Q){let X=new Date().getTime()-J*86400*1000,{filter:Z,...w}=Q;return await this.fetchAll("app.bsky.feed.getAuthorFeed",{params:{actor:z,filter:Z,limit:100},field:"feed",breakWhen:(G)=>d1(G)<X,...w})}async loadListTimeline(z,J,Q={}){let X=new Date().getTime()-J*86400*1000;return await this.fetchAll("app.bsky.feed.getListFeed",{params:{list:z,limit:100},field:"feed",breakWhen:(Z)=>d1(Z)<X,...Q})}async loadPost(z){let J=await this.loadPosts([z]);if(J.length==1)return J[0];else throw new l9("Post not found")}async loadPostIfExists(z){return(await this.loadPosts([z]))[0]}async loadPosts(z){if(z.length>0)return(await this.getRequest("app.bsky.feed.getPosts",{uris:z})).posts;else return[]}async loadPostViewerInfo(z){let J=await this.loadPostIfExists(z.uri);if(J)z.author=J.author,z.viewerData=J.viewer,z.viewerLike=J.viewer?.like;return J}async reloadBlockedPost(z){let{repo:J}=l0(z),Q=q6.loadPostIfExists(z),K=this.getRequest("app.bsky.actor.getProfile",{actor:J}),X=await Q;if(!X)return null;let Z=await K;return new S0(X,{author:Z})}}class wK{user;constructor(){let z=localStorage.getItem("userData");this.user=z?JSON.parse(z):{}}save(){if(this.user)localStorage.setItem("userData",JSON.stringify(this.user));else localStorage.removeItem("userData")}}class Y7 extends _1{user;constructor(){let z=new wK,J=z.user.pdsEndpoint||null;super(J,z);this.user=z.user}async getCurrentUserAvatar(){return(await this.getRequest("com.atproto.repo.getRecord",{repo:this.user.did,collection:"app.bsky.actor.profile",rkey:"self"})).value.avatar}async loadCurrentUserAvatar(){if(!this.config||!this.config.user)throw new B6("User isn't logged in");let z=await this.getCurrentUserAvatar();if(z){let J=`https://cdn.bsky.app/img/avatar/plain/${this.user.did}/${z.ref.$link}@jpeg`;return this.config.user.avatar=J,this.config.save(),J}else return null}async loadNotifications(z){return await this.getRequest("app.bsky.notification.listNotifications",z||{})}async loadMentions(z){let J=await this.loadNotifications({cursor:z??"",limit:100,reasons:["reply","mention"]}),Q=J.notifications.map((Z)=>Z.uri),K=[];for(let Z=0;Z<Q.length;Z+=25){let w=this.loadPosts(Q.slice(Z,Z+25));K.push(w)}let X=await Promise.all(K);return{cursor:J.cursor,posts:X.flat()}}async loadHomeTimeline(z,J={}){let K=new Date().getTime()-z*86400*1000;return await this.fetchAll("app.bsky.feed.getTimeline",{params:{limit:100},field:"feed",breakWhen:(X)=>d1(X)<K,...J})}async loadUserLists(){return(await this.fetchAll("app.bsky.graph.getLists",{params:{actor:this.user.did,limit:100},field:"lists"})).filter((J)=>J.purpose=="app.bsky.graph.defs#curatelist")}async likePost(z){return await this.postRequest("com.atproto.repo.createRecord",{repo:this.user.did,collection:"app.bsky.feed.like",record:{subject:{uri:z.uri,cid:z.cid},createdAt:new Date().toISOString()}})}async removeLike(z){let{rkey:J}=l0(z);await this.postRequest("com.atproto.repo.deleteRecord",{repo:this.user.did,collection:"app.bsky.feed.like",rkey:J})}resetTokens(){delete this.user.avatar,super.resetTokens()}}class WK{#z;get data(){return W(this.#z)}set data(z){D(this.#z,z,!0)}constructor(){let z=localStorage.getItem("settings");this.#z=f(C0(z?JSON.parse(z):{}))}save(){localStorage.setItem("settings",JSON.stringify(this.data))}logOut(){delete this.data.incognito,this.save()}get dateLocale(){return this.data.dateLocale}set dateLocale(z){this.data.dateLocale=z,this.save()}get incognitoMode(){return this.data.incognito}set incognitoMode(z){this.data.incognito=z,this.save()}get biohazardsEnabled(){return this.data.biohazard}set biohazardsEnabled(z){this.data.biohazard=z,this.save()}}var y0=new WK;window.settings=y0;var q6=new _1("api.bsky.app"),Kz=new _1("blue.mackuba.eu"),p9=new _1("constellation.microcosm.blue"),x0=new Y7,N0;function d9(){N0=x0.isLoggedIn&&!y0.incognitoMode?x0:q6,window.api=N0}d9();window.AuthenticatedAPI=Y7;window.BlueskyAPI=_1;window.Minisky=s8;window.appView=q6;window.blueAPI=Kz;window.accountAPI=x0;window.constellationAPI=p9;function m6(){return location.protocol+"//"+location.host+location.pathname}function L8(z){let J=new URL(m6());return J.searchParams.set("hash",z),J.toString()}function i9(z){let J=new URL(m6());return J.searchParams.set("quotes",z),J.toString()}function y5(z){return G5(z.author.handle,z.rkey)}function G5(z,J){let Q=new URL(m6());return Q.searchParams.set("author",z),Q.searchParams.set("post",J),Q.toString()}function Qz(z){let J;try{J=new URL(z)}catch(Z){throw new s5(`${Z}`)}if(J.protocol!="https:"&&J.protocol!="http:")throw new s5("URL must start with http(s)://");let Q=J.pathname.split("/");if(Q.length<5||Q[1]!="profile"||Q[3]!="post")throw new s5("This is not a valid thread URL");let K=Q[2],X=Q[4];return{user:K,post:X}}function YK(z){return Object.fromEntries(new URLSearchParams(z))}var GK="5";if(typeof window<"u")((window.__svelte??={}).v??=new Set).add(GK);class _9 extends Error{}class HK extends Error{}async function BK(z){let J;if(z.startsWith("did:plc:"))J=new URL(`https://plc.directory/${z}`);else if(z.startsWith("did:web:")){let Z=z.replace(/^did:web:/,"");J=new URL(`https://${Z}/.well-known/did.json`)}else throw new _9(`Unknown DID type: ${z}`);let Q=await fetch(J),K=await Q.text(),X=K.trim().length>0?JSON.parse(K):void 0;if(Q.status==200){let Z=(X.service||[]).find((w)=>w.id=="#atproto_pds");if(Z)return Z.serviceEndpoint.replace("https://","");else throw new _9("Missing #atproto_pds service definition")}else throw new H6(Q.status,X)}async function UK(z){if(z.match(/^did:/))return await BK(z);else if(z.match(/^[^@]+@[^@]+$/))return"bsky.social";else if(z.match(/^@?[\w\-]+(\.[\w\-]+)+$/)){z=z.replace(/^@/,"");let J=await q6.resolveHandle(z);return await BK(J)}else throw new HK("Please enter your handle or DID.")}class VK{#z;#J;#Q;constructor(){this.#z=f(C0(x0.isLoggedIn)),this.#J=f(C0(x0.isLoggedIn?x0.user.avatar:void 0)),this.#Q=f(!1)}get isIncognito(){return!!y0.incognitoMode}toggleIncognitoMode(){y0.incognitoMode=!this.isIncognito,location.reload()}get loggedIn(){return W(this.#z)}get avatarURL(){return W(this.#J)}get avatarIsLoading(){return W(this.#Q)}async logIn(z,J){let Q=await UK(z);x0.host=Q,await x0.logIn(z,J),D(this.#z,!0),D(this.#Q,!0),d9(),x0.loadCurrentUserAvatar().then((K)=>{D(this.#J,K||void 0,!0)}).catch((K)=>{console.log(K)}).finally(()=>{D(this.#Q,!1)})}logOut(){x0.resetTokens(),y0.logOut(),location.reload()}}var X1=new VK;var sZ=P("<div><!></div>");function Zz(z,J){_(J,!0);let Q=j0(J,"onClose",3,void 0),K=j0(J,"id",3,void 0),X=c5(J,["$$slots","$$events","$$legacy","children","onClose","id"]);function Z(H){if(H.target===H.currentTarget)Q()?.()}var w=sZ();w.__click=Z;var G=O(w);G6(G,()=>J.children),C(w),g(()=>{i(w,"id",K()),K1(w,1,`dialog ${J.class??""}`,"svelte-1l7hx096m6h0i")}),V(z,w),c()}I0(["click"]);var oZ=P(`<form method="get" class="svelte-1dbou6z4h1v2"><i class="close fa-circle-xmark fa-regular"></i> <h2>â˜£ï¸ Infohazard Warning</h2> <p>&ldquo;<em>This thread is not a place of honor... no highly esteemed post is commemorated here... nothing valued is here.</em>&rdquo;</p> <p>This feature allows access to comments in a thread which were hidden because one of the commenters has blocked another. Bluesky currently hides such comments to avoid escalating conflicts.</p> <p>Are you sure you want to enter?<br/>(You can toggle this in the menu in top-left corner.)</p> <p class="submit svelte-1dbou6z4h1v2"><input type="submit" value="Show me the drama \uD83D\uDE08" class="svelte-1dbou6z4h1v2"/> <input type="submit" value="Nope, I'd rather not \uD83D\uDE48" class="svelte-1dbou6z4h1v2"/></p></form>`);function c9(z,J){_(J,!0);let Q=j0(J,"onConfirm",3,void 0),K=j0(J,"onReject",3,void 0),X=j0(J,"onClose",3,void 0);function Z(G){G.preventDefault(),y0.biohazardsEnabled=!0,Q()?.(),X()?.()}function w(G){G.preventDefault(),y0.biohazardsEnabled=!1,K()?.(),X()?.()}Zz(z,{onClose:()=>X()?.(),children:(G,H)=>{var B=oZ(),F=O(B);F.__click=function(...x){X()?.apply(this,x)};var q=S(F,10),Y=O(q);Y.__click=Z;var U=S(Y,2);U.__click=w,C(q),C(B),V(G,B)},$$slots:{default:!0}}),c()}I0(["click"]);var aZ=P('<i class="close fa-circle-xmark fa-regular"></i>'),rZ=P(`<div class="info-box svelte-2qjb5vuwmm7pw"><p class="svelte-2qjb5vuwmm7pw">Skythread doesn't support OAuth yet. For now, you need to use an "app password" here, which you can generate in the Bluesky app settings.</p> <p class="svelte-2qjb5vuwmm7pw">The password you enter here is only passed to the Bluesky API (PDS) and isn't saved anywhere. The returned access token is only stored in your browser's local storage. You can see the complete source code of this app <a href="http://tangled.org/mackuba.eu/skythread" target="_blank" class="svelte-2qjb5vuwmm7pw">on Tangled</a>.</p></div>`),nZ=P('<input type="submit" value="Log in"/>'),tZ=P('<i class="cloudy fa-solid fa-cloud fa-beat fa-xl svelte-2qjb5vuwmm7pw"></i>'),eZ=P('<form method="get"><!> <h2>\uD83C\uDF24 Skythread</h2> <p><input type="text" id="login_handle" required placeholder="name.bsky.social"/></p> <p><input type="password" id="login_password" required placeholder="âœ±âœ±âœ±âœ±âœ±âœ±âœ±âœ±"/></p> <p class="info svelte-2qjb5vuwmm7pw"><a href="#" class="svelte-2qjb5vuwmm7pw"><i class="fa-regular fa-circle-question"></i> Use an "app password" here</a></p> <!> <p class="submit"><!></p></form>');function s9(z,J){_(J,!0);let Q=j0(J,"onClose",3,void 0),K=j0(J,"onLogin",3,void 0),X=f(""),Z=f(""),w=f(!1),G=f(!1),H,B;function F(){if(J.showClose&&Q())Q()()}function q(x){x.preventDefault(),D(w,!W(w))}async function Y(x){x.preventDefault(),D(G,!0),H.blur(),B.blur();try{await X1.logIn(W(X).trim(),W(Z).trim()),K()?.(),Q()?.()}catch(I){D(G,!1),U(I)}}function U(x){if(console.log(x),x instanceof H6&&x.code==401&&x.json.error=="AuthFactorTokenRequired")alert('Please log in using an "app password" if you have 2FA enabled.');else window.setTimeout(()=>alert(x),10)}{let x=M0(()=>W(w)?"expanded":"");Zz(z,{id:"login",get class(){return W(x)},onClose:F,children:(I,M)=>{var A=eZ(),E=O(A);{var v=(K0)=>{var q0=aZ();q0.__click=function(...o){Q()?.apply(this,o)},V(K0,q0)};j(E,(K0)=>{if(J.showClose)K0(v)})}var T=S(E,4),y=O(T);p0(y),k6(y,!0),z5(y,(K0)=>H=K0,()=>H),C(T);var N=S(T,2),R=O(N);p0(R),z5(R,(K0)=>B=K0,()=>B),C(N);var k=S(N,2),$=O(k);$.__click=q,C(k);var b=S(k,2);{var l=(K0)=>{var q0=rZ();V(K0,q0)};j(b,(K0)=>{if(W(w))K0(l)})}var n=S(b,2),s=O(n);{var a=(K0)=>{var q0=nZ();V(K0,q0)},W0=(K0)=>{var q0=tZ();V(K0,q0)};j(s,(K0)=>{if(!W(G))K0(a);else K0(W0,!1)})}C(n),C(A),C1("submit",A,Y),P1(y,()=>W(X),(K0)=>D(X,K0)),P1(R,()=>W(Z),(K0)=>D(Z,K0)),V(I,A)},$$slots:{default:!0}})}c()}I0(["click"]);var G7=f(!1),qK=f(!1),B7=f(!1),FK=f(void 0);function I8(z){if(!W(G7))D(G7,!0),D(qK,z.showClose,!0)}function xK(z){if(!W(B7))D(B7,!0),D(FK,z,!0)}function o9(z){var J=d(),Q=h(J);{var K=(Z)=>{s9(Z,{onClose:()=>D(G7,!1),get showClose(){return W(qK)}})},X=(Z)=>{var w=d(),G=h(w);{var H=(B)=>{c9(B,{onClose:()=>D(B7,!1),onConfirm:()=>W(FK)?.()})};j(G,(B)=>{if(W(B7))B(H)},!0)}V(Z,w)};j(Q,(Z)=>{if(W(G7))Z(K);else Z(X,!1)})}V(z,J)}var zX=P('<span class="check">âœ“</span>'),JX=P('<li class="svelte-2oxniw1nprfwt"><a class="button svelte-2oxniw1nprfwt" href="#"><!> </a></li>');function S8(z,J){let Q=j0(J,"title",3,void 0),K=j0(J,"showCheckmark",3,!1);var X=JX(),Z=O(X);Z.__click=function(...B){J.onclick?.apply(this,B)};var w=O(Z);{var G=(B)=>{var F=zX();V(B,F)};j(w,(B)=>{if(K())B(G)})}var H=S(w);C(Z),C(X),g(()=>{i(Z,"title",Q()),u(H,` ${J.label??""}`)}),V(z,X)}I0(["click"]);var QX=P("<!> <img/>",1),KX=P("<img/>");function a9(z,J){let Q=c5(J,["$$slots","$$events","$$legacy","loading","error"]),K=f(void 0);function X(){D(K,"loaded")}function Z(){D(K,"error")}var w=d(),G=h(w);{var H=(F)=>{var q=QX(),Y=h(q);G6(Y,()=>J.loading);var U=S(Y,2);az(U,()=>({...Q,style:"display: none",onload:X,onerror:Z})),W8(U),V(F,q)},B=(F)=>{var q=d(),Y=h(q);{var U=(I)=>{var M=KX();az(M,()=>({...Q})),W8(M),V(I,M)},x=(I)=>{var M=d(),A=h(M);G6(A,()=>J.error),V(I,M)};j(Y,(I)=>{if(W(K)=="loaded")I(U);else I(x,!1)},!0)}V(F,q)};j(G,(F)=>{if(!W(K))F(H);else F(B,!1)})}V(z,w)}var ZX=P('<i class="fa-solid fa-user-secret fa-lg svelte-39wlrotalwj0t"></i>'),XX=P('<i class="fa-regular fa-user-circle fa-xl svelte-39wlrotalwj0t"></i>'),wX=P('<i class="fa-regular fa-user-circle fa-xl svelte-39wlrotalwj0t"></i>'),WX=P('<i class="fa-solid fa-user-circle fa-xl svelte-39wlrotalwj0t"></i>'),YX=P('<i class="fa-solid fa-user-circle fa-xl svelte-39wlrotalwj0t"></i>'),GX=P('<div id="account"><!></div> <div id="account_menu" class="svelte-39wlrotalwj0t"><ul class="svelte-39wlrotalwj0t"><!> <!> <!> <li class="link svelte-39wlrotalwj0t"><a class="svelte-39wlrotalwj0t">Home</a></li> <li class="link svelte-39wlrotalwj0t"><a href="?page=posting_stats" class="svelte-39wlrotalwj0t">Posting stats</a></li> <li class="link svelte-39wlrotalwj0t"><a href="?page=like_stats" class="svelte-39wlrotalwj0t">Like stats</a></li> <li class="link svelte-39wlrotalwj0t"><a href="?page=search" class="svelte-39wlrotalwj0t">Timeline search</a></li> <li class="link svelte-39wlrotalwj0t"><a href="?page=search&amp;mode=likes" class="svelte-39wlrotalwj0t">Archive search</a></li></ul></div>',1);function r9(z,J){_(J,!0);let Q=f(!1);Q1(()=>{let k=document.body.parentNode;return k.addEventListener("click",K),()=>{k.removeEventListener("click",K)}});function K(){D(Q,!1)}function X(k){k.stopPropagation(),D(Q,!W(Q))}function Z(k){if(k.preventDefault(),y0.biohazardsEnabled===!1)y0.biohazardsEnabled=!0;else y0.biohazardsEnabled=!1}function w(k){k.preventDefault(),X1.toggleIncognitoMode()}function G(k){k.preventDefault(),I8({showClose:!0}),D(Q,!1)}function H(k){k.preventDefault(),X1.logOut()}var B=GX(),F=h(B);F.__click=X;var q=O(F);{var Y=(k)=>{var $=ZX();V(k,$)},U=(k)=>{var $=d(),b=h($);{var l=(s)=>{var a=XX();V(s,a)},n=(s)=>{var a=d(),W0=h(a);{var K0=(o)=>{a9(o,{class:"avatar",get src(){return X1.avatarURL},loading:(V0)=>{var k0=wX();V(V0,k0)},error:(V0)=>{var k0=WX();V(V0,k0)},$$slots:{loading:!0,error:!0}})},q0=(o)=>{var e=YX();V(o,e)};j(W0,(o)=>{if(X1.loggedIn&&X1.avatarURL)o(K0);else o(q0,!1)},!0)}V(s,a)};j(b,(s)=>{if(!X1.loggedIn||X1.avatarIsLoading)s(l);else s(n,!1)},!0)}V(k,$)};j(q,(k)=>{if(X1.isIncognito)k(Y);else k(U,!1)})}C(F);var x=S(F,2);x.__click=(k)=>k.stopPropagation();var I=O(x),M=O(I);{var A=(k)=>{S8(k,{onclick:w,label:"Incognito mode",title:"Temporarily load threads as a logged-out user",get showCheckmark(){return X1.isIncognito}})};j(M,(k)=>{if(X1.loggedIn)k(A)})}var E=S(M,2);{let k=M0(()=>y0.biohazardsEnabled!==!1);S8(E,{onclick:Z,label:"Show infohazards",title:"Show links to blocked and hidden comments",get showCheckmark(){return W(k)}})}var v=S(E,2);{var T=(k)=>{S8(k,{onclick:G,label:"Log in"})},y=(k)=>{S8(k,{onclick:H,label:"Log out"})};j(v,(k)=>{if(!X1.loggedIn)k(T);else k(y,!1)})}var N=S(v,2),R=O(N);C(N),z1(8),C(I),C(x),g((k)=>{K1(F,1,y6({active:W(Q)}),"svelte-39wlrotalwj0t"),_5(x,`visibility: ${W(Q)?"visible":"hidden"}`),i(R,"href",k)},[m6]),V(z,B),c()}I0(["click"]);var f6,n9;function F6(z){if(f6)document.removeEventListener("scroll",f6);n9?.disconnect(),f6=()=>{if(window.pageYOffset+window.innerHeight>document.body.offsetHeight-500)z(f6)},z(f6),document.addEventListener("scroll",f6),n9=new ResizeObserver(f6),n9.observe(document.body)}hQ();var BX=P('<div id="loader" class="svelte-1sl84wlrv68d4"><img src="icons/sunny.png" alt="Loading..." class="svelte-1sl84wlrv68d4"/></div>');function o5(z){var J=BX();V(z,J)}var HX=P('<div class="margin svelte-2ac5zurqv2ncl"><div class="edge svelte-2ac5zurqv2ncl"><div class="line svelte-2ac5zurqv2ncl"></div></div> <img class="plus svelte-2ac5zurqv2ncl"/></div>');function t9(z,J){_(J,!0);let Q=j0(J,"collapsed",15,!1);function K(){Q(!Q())}var X=HX(),Z=O(X);Z.__click=K;var w=S(Z,2);w.__click=K,C(X),g(()=>{i(w,"alt",Q()?"+":"-"),i(w,"src",`icons/${Q()?"add-square.png":"subtract-square.png"}`)}),V(z,X),c()}I0(["click"]);var UX=P('<a class="fedi-link svelte-1ssytx46btagw" target="_blank"><div class="svelte-1ssytx46btagw"><i class="fa-solid fa-arrow-up-right-from-square fa-sm svelte-1ssytx46btagw"></i> </div></a>');function e9(z,J){_(J,!0);let Q=M0(()=>new URL(J.url).hostname);var K=UX(),X=O(K),Z=S(O(X));C(X),C(K),g(()=>{i(K,"href",J.url),u(Z,` View on ${W(Q)??""}`)}),V(z,K),c()}var VX=P('â˜£ï¸ <a class="svelte-29k9heaj3bdpw">Load hidden repliesâ€¦</a>',1),qX=P('<img class="loader" src="icons/sunny.png" alt="Loading..."/>'),FX=P('<p class="hidden-replies svelte-29k9heaj3bdpw"><!></p>');function zJ(z,J){_(J,!0);let{post:Q}=r0(),K=f(!1);function X(F){if(F.preventDefault(),y0.biohazardsEnabled===!0)Z();else xK(()=>{Z()})}async function Z(){D(K,!0);try{let q=(await N0.loadHiddenReplies(Q)).map((Y)=>Y&&V6(Y.thread,Q.pageRoot,1,Q.absoluteLevel+1));D(K,!1),J.onLoad(q)}catch(F){D(K,!1),J.onError(F)}}var w=FX(),G=O(w);{var H=(F)=>{var q=VX(),Y=S(h(q));Y.__click=X,g((U)=>i(Y,"href",U),[()=>y5(Q)]),V(F,q)},B=(F)=>{var q=qX();V(F,q)};j(G,(F)=>{if(!W(K))F(H);else F(B,!1)})}C(w),V(z,w),c()}I0(["click"]);var xX=P("<a>Load more repliesâ€¦</a>"),MX=P('<img class="loader" src="icons/sunny.png" alt="Loading..."/>'),CX=P("<p><!></p>");function JJ(z,J){_(J,!0);let{post:Q}=r0(),K=f(!1);async function X(B){B.preventDefault(),D(K,!0);try{let F=await N0.loadThreadByAtURI(Q.uri),q=V6(F.thread,Q.pageRoot,0,Q.absoluteLevel);if(D(K,!1),q instanceof S0)window.subtreeRoot=q,J.onLoad(q);else J.onError(Error("Post is not available"))}catch(F){D(K,!1),J.onError(F)}}var Z=CX(),w=O(Z);{var G=(B)=>{var F=xX();F.__click=X,g((q)=>i(F,"href",q),[()=>y5(Q)]),V(B,F)},H=(B)=>{var F=MX();V(B,F)};j(w,(B)=>{if(!W(K))B(G);else B(H,!1)})}C(Z),V(z,Z),c()}I0(["click"]);class j8{text;facet;constructor(z,J){this.text=z;this.facet=J}get link(){return this.facet?.features.find((z)=>z.$type==="app.bsky.richtext.facet#link")}isLink(){return!!this.link}get mention(){return this.facet?.features.find((z)=>z.$type==="app.bsky.richtext.facet#mention")}isMention(){return!!this.mention}get tag(){return this.facet?.features.find((z)=>z.$type==="app.bsky.richtext.facet#tag")}isTag(){return!!this.tag}}class QJ{unicodeText;facets;constructor(z){if(this.unicodeText=new MK(z.text),this.facets=z.facets,this.facets)this.facets=this.facets.filter(PX).sort(OX)}get text(){return this.unicodeText.toString()}get length(){return this.unicodeText.length}get graphemeLength(){return this.unicodeText.graphemeLength}*segments(){let z=this.facets||[];if(!z.length){yield new j8(this.unicodeText.utf16);return}let J=0,Q=0;do{let K=z[Q];if(J<K.index.byteStart)yield new j8(this.unicodeText.slice(J,K.index.byteStart));else if(J>K.index.byteStart){Q++;continue}if(K.index.byteStart<K.index.byteEnd){let X=this.unicodeText.slice(K.index.byteStart,K.index.byteEnd);if(!X.trim())yield new j8(X);else yield new j8(X,K)}J=K.index.byteEnd,Q++}while(Q<z.length);if(J<this.unicodeText.length)yield new j8(this.unicodeText.slice(J,this.unicodeText.length))}}var OX=(z,J)=>z.index.byteStart-J.index.byteStart,PX=(z)=>z.index.byteStart<=z.index.byteEnd,LX=new TextEncoder,IX=new TextDecoder,SX=new Intl.Segmenter,jX=(z)=>{return Array.from(SX.segment(z)).length};class MK{utf16;utf8;_graphemeLen;constructor(z){this.utf16=z,this.utf8=LX.encode(z)}get length(){return this.utf8.byteLength}get graphemeLength(){if(!this._graphemeLen)this._graphemeLen=jX(this.utf16);return this._graphemeLen}slice(z,J){return IX.decode(this.utf8.slice(z,J))}toString(){return this.utf16}}var DX=P("<a> </a>"),RX=P("<a> </a>"),AX=P("<a> </a>"),NX=P("<br/>"),kX=P("<!> ",1);function KJ(z,J){_(J,!0);let Q=M0(()=>new QJ({text:J.text,facets:J.facets})),K=M0(()=>W(Q).segments());var X=d(),Z=h(X);A0(Z,17,()=>W(K),O1,(w,G)=>{var H=d(),B=h(H);{var F=(Y)=>{var U=DX(),x=O(U,!0);C(U),g(()=>{i(U,"href",`https://bsky.app/profile/${W(G).mention.did??""}`),u(x,W(G).text)}),V(Y,U)},q=(Y)=>{var U=d(),x=h(U);{var I=(A)=>{var E=d(),v=h(E);{var T=(N)=>{var R=RX(),k=O(R,!0);C(R),g(()=>{i(R,"href",W(G).link.uri),u(k,W(G).text)}),V(N,R)},y=(N)=>{var R=N1();g(()=>u(R,`[${W(G).text??""}](${W(G).link.uri??""})`)),V(N,R)};j(v,(N)=>{if(q8(W(G).link.uri))N(T);else N(y,!1)})}V(A,E)},M=(A)=>{var E=d(),v=h(E);{var T=(N)=>{var R=AX(),k=O(R,!0);C(R),g(($)=>{i(R,"href",$),u(k,W(G).text)},[()=>L8(W(G).tag.tag)]),V(N,R)},y=(N)=>{let R=M0(()=>W(G).text.split(`
`));var k=d(),$=h(k);A0($,17,()=>W(R),O1,(b,l,n)=>{var s=kX(),a=h(s);{var W0=(q0)=>{var o=NX();V(q0,o)};j(a,(q0)=>{if(n>0)q0(W0)})}var K0=S(a,1,!0);g(()=>u(K0,W(l))),V(b,s)}),V(N,k)};j(v,(N)=>{if(W(G).tag)N(T);else N(y,!1)},!0)}V(A,E)};j(x,(A)=>{if(W(G).link)A(I);else A(M,!1)},!0)}V(Y,U)};j(B,(Y)=>{if(W(G).mention)Y(F);else Y(q,!1)})}V(w,H)}),V(z,X),c()}var bX=P('<div class="bridged-body svelte-2d3jfo6dimkdp"><!></div>'),TX=P('<p class="body svelte-2d3jfo6dimkdp"><!></p>');function Xz(z,J){_(J,!0);let Q="search-results",{post:K}=r0(),X=j0(J,"highlightedMatches",3,void 0),Z=f(void 0);function w(q){let Y=new RegExp(`\\b(${q.join("|")})\\b`,"gi"),U=document.createTreeWalker(W(Z),NodeFilter.SHOW_TEXT),x=[];while(U.nextNode()){let M=U.currentNode;if(!M.textContent)continue;Y.lastIndex=0;for(;;){let A=Y.exec(M.textContent);if(A===null)break;let E=new Range;E.setStart(M,A.index),E.setEnd(M,A.index+A[0].length),x.push(E)}}let I=CSS.highlights.get(Q)||new Highlight;x.forEach((M)=>I.add(M)),CSS.highlights.set(Q,I)}Q1(()=>{if(X()&&X().length>0)return w(X()),()=>{CSS.highlights.delete(Q)};else return});var G=d(),H=h(G);{var B=(q)=>{var Y=bX(),U=O(Y);V9(U,()=>JK(K.originalFediContent)),C(Y),z5(Y,(x)=>D(Z,x),()=>W(Z)),V(q,Y)},F=(q)=>{var Y=TX(),U=O(Y);KJ(U,{get text(){return K.text},get facets(){return K.facets}}),C(Y),z5(Y,(x)=>D(Z,x),()=>W(Z)),V(q,Y)};j(H,(q)=>{if(K.originalFediContent)q(B);else q(F,!1)})}V(z,G),c()}class ZJ{post;placement;constructor(z,J){this.post=z,this.placement=J}get timeFormatForTimestamp(){if(this.placement=="quotes"||this.placement=="feed")return{weekday:"short",day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric"};else if(this.post.isPageRoot||this.placement!="thread")return{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric"};else if(this.post.pageRoot&&!KK(this.post.createdAt,this.post.pageRoot.createdAt))return{day:"numeric",month:"short",hour:"numeric",minute:"numeric"};else return{hour:"numeric",minute:"numeric"}}get formattedTimestamp(){let z=this.timeFormatForTimestamp;return this.post.createdAt.toLocaleString(y0.dateLocale,z)}}var EX=P('<a class="action"><i class="fa-solid fa-arrows-split-up-and-left fa-rotate-180"></i></a>');function D8(z,J){_(J,!0);let Q=j0(J,"title",3,"");var K=EX();g((X)=>{i(K,"href",X),i(K,"title",Q())},[()=>y5(J.post)]),V(z,K),c()}var yX=P('<i class="muted-avatar fa-regular fa-circle-user fa-2x svelte-19hm87t6mz7s5"></i>'),vX=P('<img class="avatar svelte-19hm87t6mz7s5" alt="Avatar" loading="lazy"/>'),gX=P('<i class="no-avatar fa-regular fa-face-smile fa-2x svelte-19hm87t6mz7s5"></i>'),hX=P('<a class="handle svelte-19hm87t6mz7s5" target="_blank"> </a> <img src="icons/mastodon.svg" class="mastodon svelte-19hm87t6mz7s5" alt="Mastodon logo"/>',1),mX=P('<a class="handle svelte-19hm87t6mz7s5" target="_blank"> </a>'),fX=P('<span class="separator svelte-19hm87t6mz7s5">&bull;</span> <!>',1),$X=P('<h2 class="svelte-19hm87t6mz7s5"><!> <!> <span class="separator svelte-19hm87t6mz7s5">&bull;</span> <a class="time svelte-19hm87t6mz7s5" target="_blank"> </a> <!></h2>');function XJ(z,J){_(J,!0);let{post:Q,placement:K}=r0(),X=new ZJ(Q,K),Z=f(void 0);Q1(()=>{if(W(Z))b9.observe(W(Z));return()=>{W(Z)&&b9.unobserve(W(Z))}});var w=$X(),G=O(w);{var H=(E)=>{var v=yX();V(E,v)},B=(E)=>{var v=d(),T=h(v);{var y=(R)=>{var k=vX();z5(k,($)=>D(Z,$),()=>W(Z)),g(()=>i(k,"src",Q.author.avatar)),V(R,k)},N=(R)=>{var k=gX();V(R,k)};j(T,(R)=>{if(Q.author.avatar)R(y);else R(N,!1)},!0)}V(E,v)};j(G,(E)=>{if(Q.muted)E(H);else E(B,!1)})}var F=S(G),q=S(F);{var Y=(E)=>{var v=hX(),T=h(v),y=O(T);C(T),z1(2),g(()=>{i(T,"href",Q.linkToAuthor),u(y,`@${Q.authorFediHandle??""}`)}),V(E,v)},U=(E)=>{var v=mX(),T=O(v,!0);C(v),g(()=>{i(v,"href",Q.linkToAuthor),u(T,Q.hasValidHandle?`@${Q.author.handle}`:"[invalid handle]")}),V(E,v)};j(q,(E)=>{if(Q.isFediPost)E(Y);else E(U,!1)})}var x=S(q,4),I=O(x,!0);C(x);var M=S(x,2);{var A=(E)=>{var v=fX(),T=S(h(v),2);{var y=(R)=>{D8(R,{get post(){return Q},title:"Load thread"})},N=(R)=>{D8(R,{get post(){return Q},title:"Load this subtree"})};j(T,(R)=>{if(["quote","quotes","feed"].includes(K))R(y);else R(N,!1)})}V(E,v)};j(M,(E)=>{if(Q.replyCount>0&&!Q.isPageRoot||["quote","quotes","feed"].includes(K))E(A)})}C(w),g((E)=>{u(F,` ${Q.authorDisplayName??""} `),i(x,"href",Q.linkToPost),i(x,"title",E),u(I,X.formattedTimestamp)},[()=>Q.createdAt.toISOString()]),V(z,w),c()}var uX=P('<a class="svelte-3d455ypfy1g8s"> </a>'),lX=P('<p class="tags"></p>');function wJ(z,J){_(J,!1);let{post:Q}=r0();j9();var K=lX();A0(K,5,()=>Q.tags,O1,(X,Z)=>{var w=uX(),G=O(w);C(w),g((H)=>{i(w,"href",H),u(G,`# ${W(Z)??""}`)},[()=>L8(W(Z))]),V(X,w)}),C(K),V(z,K),c()}var pX=P('<span class="svelte-1tsy42z5eauyq"><i class="fa-solid fa-retweet svelte-1tsy42z5eauyq"></i> </span>'),dX=P('<span class="svelte-1tsy42z5eauyq"><i class="fa-regular fa-message svelte-1tsy42z5eauyq"></i> <a class="svelte-1tsy42z5eauyq"> </a></span>'),iX=P('<span class="svelte-1tsy42z5eauyq"><i class="fa-regular fa-comments svelte-1tsy42z5eauyq"></i> <a class="svelte-1tsy42z5eauyq"> </a></span>'),_X=P('<a class="svelte-1tsy42z5eauyq"><i class="fa-regular fa-comments svelte-1tsy42z5eauyq"></i> </a>'),cX=P('<span class="svelte-1tsy42z5eauyq"><i class="fa-solid fa-ban svelte-1tsy42z5eauyq"></i> Limited replies</span>'),sX=P('<span class="svelte-1tsy42z5eauyq"><i class="fa-solid fa-ban svelte-1tsy42z5eauyq" title="Limited replies"></i></span>'),oX=P('<span class="blocked-info svelte-1tsy42z5eauyq">\uD83D\uDEAB Post unavailable</span>'),aX=P('<p class="stats svelte-1tsy42z5eauyq"><span class="svelte-1tsy42z5eauyq"><i></i> <output> </output></span> <!> <!> <!> <!> <!></p>');function WJ(z,J){_(J,!0);let{post:Q,placement:K}=r0(),X=f(C0(Q.liked)),Z=f(C0(Q.likeCount)),w=f(!1);async function G(){try{if(Q.hasViewerInfo)await B();else if(X1.loggedIn)await H();else I8({showClose:!0})}catch($){U6($)}}async function H(){if(await x0.loadPostViewerInfo(Q))if(Q.liked)D(X,!0);else await B();else D(w,!0)}async function B(){if(!W(X)){let $=await x0.likePost(Q);Q.viewerLike=$.uri,D(X,!0),D(Z,W(Z)+1)}else await x0.removeLike(Q.viewerLike),Q.viewerLike=void 0,D(X,!1),D(Z,W(Z)-1)}var F=aX(),q=O(F),Y=O(q);Y.__click=G;var U=S(Y,2),x=O(U,!0);C(U),C(q);var I=S(q,2);{var M=($)=>{var b=pX(),l=S(O(b));C(b),g(()=>u(l,` ${Q.repostCount??""}`)),V($,b)};j(I,($)=>{if(Q.repostCount>0)$(M)})}var A=S(I,2);{var E=($)=>{var b=dX(),l=S(O(b),2),n=O(l,!0);C(l),C(b),g((s,a)=>{i(l,"href",s),u(n,a)},[()=>y5(Q),()=>J7(Q.replyCount,"reply","replies")]),V($,b)};j(A,($)=>{if(Q.replyCount>0&&(K=="quotes"||K=="feed"))$(E)})}var v=S(A,2);{var T=($)=>{var b=d(),l=h(b);{var n=(a)=>{var W0=iX(),K0=S(O(W0),2),q0=O(K0,!0);C(K0),C(W0),g((o,e)=>{i(K0,"href",o),u(q0,e)},[()=>i9(Q.linkToPost),()=>J7(J.quoteCount,"quote")]),V(a,W0)},s=(a)=>{var W0=_X(),K0=S(O(W0));C(W0),g((q0)=>{i(W0,"href",q0),u(K0,` ${J.quoteCount??""}`)},[()=>i9(Q.linkToPost)]),V(a,W0)};j(l,(a)=>{if(K=="quotes"||K=="feed"||Q.isPageRoot)a(n);else a(s,!1)})}V($,b)};j(v,($)=>{if(J.quoteCount&&K!="quote")$(T)})}var y=S(v,2);{var N=($)=>{var b=d(),l=h(b);{var n=(a)=>{var W0=cX();V(a,W0)},s=(a)=>{var W0=d(),K0=h(W0);{var q0=(o)=>{var e=sX();V(o,e)};j(K0,(o)=>{if(K=="quotes")o(q0)},!0)}V(a,W0)};j(l,(a)=>{if(K=="thread")a(n);else a(s,!1)})}V($,b)};j(y,($)=>{if(Q.isRestrictingReplies)$(N)})}var R=S(y,2);{var k=($)=>{var b=oX();V($,b)};j(R,($)=>{if(W(w))$(k)})}C(F),g(()=>{K1(Y,1,`fa-solid fa-heart ${W(X)?"liked":""}`,"svelte-1tsy42z5eauyq"),u(x,W(Z))}),V(z,F),c()}I0(["click"]);var rX=P('<details class="image-alt svelte-3o2regxzbqbr0"><summary class="svelte-3o2regxzbqbr0">Show alt</summary> </details>'),nX=P("<p>[<a>Image</a>]</p> <!>",1),tX=P("<div></div>");function YJ(z,J){_(J,!0);let{post:Q}=r0();function K(Z){if(Z.fullsize)return Z.fullsize;else{let w=Z.image.ref.$link;return`https://cdn.bsky.app/img/feed_fullsize/plain/${Q.author.did}/${w}@jpeg`}}var X=tX();A0(X,21,()=>J.embed.images,O1,(Z,w)=>{var G=nX(),H=h(G),B=S(O(H));z1(),C(H);var F=S(H,2);{var q=(Y)=>{var U=rX(),x=S(O(U));C(U),g(()=>u(x,` ${W(w).alt??""}`)),V(Y,U)};j(F,(Y)=>{if(W(w).alt)Y(q)})}g((Y)=>i(B,"href",Y),[()=>K(W(w))]),V(Z,G)}),C(X),V(z,X),c()}var eX=P('<div class="gif svelte-2dx58m87um1nk"><img/></div>');function GJ(z,J){let Q=f(!1),K=f(!1),X=f(500),Z=f(200);function w(q){let Y=q.target;if(Y.naturalWidth<Y.naturalHeight)D(X,200),D(Z,400);D(Q,!0)}function G(){D(K,!W(K))}var H=eX(),B=O(H);B.__click=G;let F;C(H),g(()=>{i(B,"src",W(K)?J.staticURL:J.gifURL),K1(B,1,y6(W(K)?"static":""),"svelte-2dx58m87um1nk"),i(B,"alt",J.alt?`Gif: ${J.alt}`:"Gif animation"),F=_5(B,"",F,{opacity:W(Q)?1:0,"max-width":`${W(X)??""}px`,"max-height":`${W(Z)??""}px`})}),C1("load",B,w),W8(B),V(z,H)}I0(["click"]);var zw=P('<p class="description"> </p>'),Jw=P('<a class="link-card" target="_blank"><div><p class="domain"> </p> <h2> </h2> <!></div></a>'),Qw=P("<p> </p>");function BJ(z,J){_(J,!0);let{post:Q}=r0(),K=f(!1),X=M0(()=>new URL(J.embed.url).hostname),Z=M0(()=>W(X)=="media.tenor.com"),w=M0(()=>W(Z)?G:void 0);function G(U){U.preventDefault(),D(K,!0)}function H(){if(typeof J.embed.thumb=="string")return J.embed.thumb;else return`https://cdn.bsky.app/img/avatar/feed_thumbnail/${Q.author.did}/${J.embed.thumb.ref.$link}@jpeg`}var B=d(),F=h(B);{var q=(U)=>{{let x=M0(H);GJ(U,{get gifURL(){return J.embed.url},get staticURL(){return W(x)},get alt(){return J.embed.title}})}},Y=(U)=>{var x=d(),I=h(x);{var M=(E)=>{var v=Jw();v.__click=function(...l){W(w)?.apply(this,l)};var T=O(v),y=O(T),N=O(y,!0);C(y);var R=S(y,2),k=O(R,!0);C(R);var $=S(R,2);{var b=(l)=>{var n=zw(),s=O(n,!0);C(n),g((a)=>u(s,a),[()=>QK(J.embed.description,300)]),V(l,n)};j($,(l)=>{if(J.embed.description)l(b)})}C(T),C(v),g(()=>{i(v,"href",J.embed.url),u(N,W(X)),u(k,J.embed.title||J.embed.url)}),V(E,v)},A=(E)=>{var v=Qw(),T=O(v);C(v),g(()=>u(T,`[Link: ${J.embed.url??""}]`)),V(E,v)};j(I,(E)=>{if(q8(J.embed.url))E(M);else E(A,!1)})}V(U,x)};j(F,(U)=>{if(W(K))U(q);else U(Y,!1)})}V(z,B),c()}I0(["click"]);var Kw=P('<img class="avatar" alt="Avatar"/>'),Zw=P('<p class="description"> </p>'),Xw=P('<a class="link-card record" target="_blank"><div><!> <h2> <span class="handle"> </span></h2> <!> <p class="stats"><i class="fa-solid fa-heart"></i> <output> </output></p></div></a>');function HJ(z,J){_(J,!0);function Q(M){let{repo:A,rkey:E}=l0(M.uri);return`https://bsky.app/profile/${A}/feed/${E}`}var K=Xw(),X=O(K),Z=O(X);{var w=(M)=>{var A=Kw();g(()=>i(A,"src",J.feed.avatar)),V(M,A)};j(Z,(M)=>{if(J.feed.avatar)M(w)})}var G=S(Z,2),H=O(G),B=S(H),F=O(B);C(B),C(G);var q=S(G,2);{var Y=(M)=>{var A=Zw(),E=O(A,!0);C(A),g(()=>u(E,J.feed.description)),V(M,A)};j(q,(M)=>{if(J.feed.description)M(Y)})}var U=S(q,2),x=S(O(U),2),I=O(x,!0);C(x),C(U),C(X),C(K),g((M)=>{i(K,"href",M),u(H,`${J.feed.title??""} `),u(F,`â€¢ Feed by @${J.feed.author.handle??""}`),u(I,J.feed.likeCount)},[()=>Q(J.feed)]),V(z,K),c()}var ww=P('<p class="description"> </p>'),Ww=P('<a class="link-card record" target="_blank"><div><h2> <span class="handle"> </span></h2> <!></div></a>');function UJ(z,J){_(J,!0);function Q(q){let{repo:Y,rkey:U}=l0(q.uri);return`https://bsky.app/starter-pack/${Y}/${U}`}var K=Ww(),X=O(K),Z=O(X),w=O(Z),G=S(w),H=O(G);C(G),C(Z);var B=S(Z,2);{var F=(q)=>{var Y=ww(),U=O(Y,!0);C(Y),g(()=>u(U,J.starterPack.description)),V(q,Y)};j(B,(q)=>{if(J.starterPack.description)q(F)})}C(X),C(K),g((q)=>{i(K,"href",q),u(w,`${J.starterPack.title??""} `),u(H,`â€¢ Starter pack by @${J.starterPack.author.handle??""}`)},[()=>Q(J.starterPack)]),V(z,K),c()}var Yw=P('<img class="avatar" alt="Avatar"/>'),Gw=P('<p class="description"> </p>'),Bw=P('<a class="link-card record" target="_blank"><div><!> <h2> <span class="handle"> </span></h2> <!></div></a>');function VJ(z,J){_(J,!0);function Q(x){let{repo:I,rkey:M}=l0(x.uri);return`https://bsky.app/profile/${I}/lists/${M}`}function K(x){switch(x.purpose){case"app.bsky.graph.defs#curatelist":return"User list";case"app.bsky.graph.defs#modlist":return"Mute list";default:return"List"}}var X=Bw(),Z=O(X),w=O(Z);{var G=(x)=>{var I=Yw();g(()=>i(I,"src",J.list.avatar)),V(x,I)};j(w,(x)=>{if(J.list.avatar)x(G)})}var H=S(w,2),B=O(H),F=S(B),q=O(F);C(F),C(H);var Y=S(H,2);{var U=(x)=>{var I=Gw(),M=O(I,!0);C(I),g(()=>u(M,J.list.description)),V(x,I)};j(Y,(x)=>{if(J.list.description)x(U)})}C(Z),C(X),g((x,I)=>{i(X,"href",x),u(B,`${J.list.title??""} `),u(q,`â€¢ ${I??""} by @${J.list.author.handle??""}`)},[()=>Q(J.list),()=>K(J.list)]),V(z,X),c()}var CK=(z,J=J5)=>{var Q=d(),K=h(Q);{var X=(w)=>{var G=Hw(),H=O(G);$6(H,{get post(){return J()},placement:"quote"}),C(G),V(w,G)},Z=(w)=>{var G=d(),H=h(G);{var B=(q)=>{HJ(q,{get feed(){return J()}})},F=(q)=>{var Y=d(),U=h(Y);{var x=(M)=>{UJ(M,{get starterPack(){return J()}})},I=(M)=>{var A=d(),E=h(A);{var v=(y)=>{VJ(y,{get list(){return J()}})},T=(y)=>{var N=Uw(),R=O(N),k=O(R);C(R),C(N),g(()=>u(k,`[${J().type??""}]`)),V(y,N)};j(E,(y)=>{if(J()instanceof zz)y(v);else y(T,!1)},!0)}V(M,A)};j(U,(M)=>{if(J()instanceof Jz)M(x);else M(I,!1)},!0)}V(q,Y)};j(H,(q)=>{if(J()instanceof e8)q(B);else q(F,!1)},!0)}V(w,G)};j(K,(w)=>{if(J()instanceof h6)w(X);else w(Z,!1)})}V(z,Q)},Hw=P('<div class="quote-embed svelte-767shvs6ixvg"><!></div>'),Uw=P('<div class="quote-embed svelte-767shvs6ixvg"><p> </p></div>'),Vw=P('<div class="quote-embed svelte-767shvs6ixvg"><p class="post placeholder svelte-767shvs6ixvg">Error loading quoted post</p></div>'),qw=P('<div class="quote-embed svelte-767shvs6ixvg"><p class="post placeholder svelte-767shvs6ixvg">Loading quoted post...</p></div>');function U7(z,J){_(J,!0);let{post:Q}=r0();async function K(){let{collection:H}=l0(J.record.uri);if(H=="app.bsky.feed.post"){let B=await N0.loadPostIfExists(J.record.uri);if(B)return new S0(B);else return new O5(Q.data)}else{let F=(await N0.loadPostIfExists(Q.uri).then((q)=>q&&new S0(q)))?.embed;if(F instanceof x8||F instanceof M8)return F.record;else return new O5(J.record)}}var X=d(),Z=h(X);{var w=(H)=>{var B=d(),F=h(B);T6(F,K,(q)=>{var Y=qw();V(q,Y)},(q,Y)=>{CK(q,()=>W(Y))},(q)=>{var Y=Vw();V(q,Y)}),V(H,B)},G=(H)=>{CK(H,()=>J.record)};j(Z,(H)=>{if(J.record.constructor===i1&&!J.record.type)H(w);else H(G,!1)})}V(z,X),c()}var Fw=P('<details class="image-alt"><summary>Show alt</summary> </details>'),xw=P("<div><p>[<a>Video</a>]</p> <!></div>");function qJ(z,J){_(J,!0);let{post:Q}=r0();function K(B){if(B instanceof O8)return B.playlistURL;else{let F=B.video.ref.$link;return`https://video.bsky.app/watch/${Q.author.did}/${F}/playlist.m3u8`}}var X=xw(),Z=O(X),w=S(O(Z));z1(),C(Z);var G=S(Z,2);{var H=(B)=>{var F=Fw(),q=S(O(F));C(F),g(()=>u(q,` ${J.embed.alt??""}`)),V(B,F)};j(G,(B)=>{if(J.embed.alt)B(H)})}C(X),g((B)=>i(w,"href",B),[()=>K(J.embed)]),V(z,X),c()}var Mw=P("<div><!> <!></div>"),Cw=P("<p> </p>"),Ow=P('<div class="embed svelte-1k40bdrlabc6f"><!></div>');function u6(z,J){_(J,!0);var Q=Ow(),K=O(Q);{var X=(w)=>{U7(w,{get record(){return J.embed.record}})},Z=(w)=>{var G=d(),H=h(G);{var B=(q)=>{var Y=Mw(),U=O(Y);u6(U,{get embed(){return J.embed.media}});var x=S(U,2);U7(x,{get record(){return J.embed.record}}),C(Y),V(q,Y)},F=(q)=>{var Y=d(),U=h(Y);{var x=(M)=>{YJ(M,{get embed(){return J.embed}})},I=(M)=>{var A=d(),E=h(A);{var v=(y)=>{BJ(y,{get embed(){return J.embed}})},T=(y)=>{var N=d(),R=h(N);{var k=(b)=>{qJ(b,{get embed(){return J.embed}})},$=(b)=>{var l=Cw(),n=O(l);C(l),g(()=>u(n,`[${J.embed.type??""}]`)),V(b,l)};j(R,(b)=>{if(J.embed instanceof Z7||J.embed instanceof O8)b(k);else b($,!1)},!0)}V(y,N)};j(E,(y)=>{if(J.embed instanceof K7||J.embed instanceof C8)y(v);else y(T,!1)},!0)}V(M,A)};j(U,(M)=>{if(J.embed instanceof Q7||J.embed instanceof W7)M(x);else M(I,!1)},!0)}V(q,Y)};j(H,(q)=>{if(J.embed instanceof w7||J.embed instanceof M8)q(B);else q(F,!1)},!0)}V(w,G)};j(K,(w)=>{if(J.embed instanceof X7||J.embed instanceof x8)w(X);else w(Z,!1)})}C(Q),V(z,Q),c()}var Pw=P("<a> </a>"),Lw=P("<a>See parent post</a>"),Iw=P("<a>See parent post</a>"),Sw=P('<p class="back"><i class="fa-solid fa-reply"></i> <!></p>');function wz(z,J){_(J,!0);let Q=M0(()=>l0(J.uri)),K=M0(()=>W(Q).repo),X=M0(()=>W(Q).rkey);var Z=Sw(),w=S(O(Z),2);T6(w,()=>N0.fetchHandleForDid(W(K)),(G)=>{var H=Iw();g((B)=>i(H,"href",B),[()=>G5(W(K),W(X))]),V(G,H)},(G,H)=>{var B=Pw(),F=O(B);C(B),g((q)=>{i(B,"href",q),u(F,`See parent post (@${W(H)??""})`)},[()=>G5(W(H),W(X))]),V(G,B)},(G)=>{var H=Lw();g((B)=>i(H,"href",B),[()=>G5(W(K),W(X))]),V(G,H)}),C(Z),V(z,Z),c()}var jw=P("<!> <!> <!>",1);function FJ(z,J){_(J,!0),xJ({post:J.post,placement:J.placement});var Q=jw(),K=h(Q);{var X=(H)=>{wz(H,{get uri(){return J.post.parentReference.uri}})};j(K,(H)=>{if(J.post.isPageRoot&&J.post.parentReference)H(X)})}var Z=S(K,2);Xz(Z,{});var w=S(Z,2);{var G=(H)=>{u6(H,{get embed(){return J.post.embed}})};j(w,(H)=>{if(J.post.embed)H(G)})}V(z,Q),c()}var Dw=P('(<a target="_blank"> </a> ',1),Rw=P('(<a target="_blank"> </a>)',1);function R8(z,J){_(J,!0);let Q=j0(J,"status",3,void 0),K=f(void 0),X=M0(()=>W(K)?`@${W(K)}`:"see author");Q1(()=>{let B=l0(J.post.uri).repo;N0.fetchHandleForDid(B).then((F)=>{D(K,F,!0)})});var Z=d(),w=h(Z);{var G=(B)=>{var F=Dw(),q=S(h(F)),Y=O(q,!0);C(q);var U=S(q);g(()=>{i(q,"href",J.post.didLinkToAuthor),u(Y,W(X)),u(U,`, ${Q()??""})`)}),V(B,F)},H=(B)=>{var F=Rw(),q=S(h(F)),Y=O(q,!0);C(q),z1(),g(()=>{i(q,"href",J.post.didLinkToAuthor),u(Y,W(X))}),V(B,F)};j(w,(B)=>{if(Q())B(G);else B(H,!1)})}V(z,Z),c()}var Aw=P('<p class="blocked-header"><i class="fa-solid fa-ban"></i> <span>Deleted post</span> <!></p>');function Wz(z,J){var Q=Aw(),K=S(O(Q),4);R8(K,{get post(){return J.post}}),C(Q),V(z,Q)}var Nw=P('<a href="#">Load postâ€¦</a>'),kw=P('<p class="load-post"><!></p>'),bw=P('<p class="blocked-header"><i class="fa-solid fa-ban"></i> <span> </span> <!></p> <!>',1),Tw=P('<span class="separator">&bull;</span> <!>',1),Ew=P('<p class="blocked-header"><i class="fa-solid fa-ban"></i> <span> </span> <!> <!></p> <!>',1);function A8(z,J){_(J,!0);let Q=M0(()=>y0.biohazardsEnabled!==!1),K=f(!1),X=f(!1),Z=f(void 0);async function w(U){U.preventDefault(),D(K,!0);let x=await N0.reloadBlockedPost(J.post.uri);if(x)D(Z,x,!0);else D(X,!0)}function G(U){let x=U.author.viewer;if(x)return!(x.blockedBy||x.blocking);else return!0}function H(){if(J.post instanceof P8)return;else if(J.post.blockedByUser)return"has blocked you";else if(J.post.blocksUser)return"you've blocked them";else return}var B=d(),F=h(B);{var q=(U)=>{var x=bw(),I=h(x),M=S(O(I),2),A=O(M,!0);C(M);var E=S(M,2);{var v=(N)=>{{let R=M0(H);R8(N,{get post(){return J.post},get status(){return W(R)}})}};j(E,(N)=>{if(W(Q))N(v)})}C(I);var T=S(I,2);{var y=(N)=>{var R=kw(),k=O(R);{var $=(l)=>{var n=Nw();n.__click=w,V(l,n)},b=(l)=>{var n=N1("Â ");V(l,n)};j(k,(l)=>{if(!W(K))l($);else l(b,!1)})}C(R),V(N,R)};j(T,(N)=>{if(W(Q))N(y)})}g(()=>u(A,J.reason)),V(U,x)},Y=(U)=>{var x=d(),I=h(x);{var M=(E)=>{var v=Ew(),T=h(v),y=S(O(T),2),N=O(y,!0);C(y);var R=S(y,2);{let l=M0(H);R8(R,{get post(){return J.post},get status(){return W(l)}})}var k=S(R,2);{var $=(l)=>{var n=Tw(),s=S(h(n),2);D8(s,{get post(){return W(Z)},title:"Load thread"}),V(l,n)};j(k,(l)=>{if(G(W(Z)))l($)})}C(T);var b=S(T,2);FJ(b,{get post(){return W(Z)},get placement(){return J.placement}}),g(()=>u(N,J.reason)),V(E,v)},A=(E)=>{{let v=M0(()=>new O5(J.post.data));Wz(E,{get post(){return W(v)}})}};j(I,(E)=>{if(W(Z))E(M);else E(A,!1)},!0)}V(U,x)};j(F,(U)=>{if(!W(X)&&!W(Z))U(q);else U(Y,!1)})}V(z,B),c()}I0(["click"]);var yw=P("<div><!></div>");function $6(z,J){var Q=d(),K=h(Q);{var X=(w)=>{L1(w,{get post(){return J.post},get placement(){return J.placement}})},Z=(w)=>{var G=yw(),H=O(G);{var B=(q)=>{A8(q,{get post(){return J.post},get placement(){return J.placement},reason:"Blocked post"})},F=(q)=>{var Y=d(),U=h(Y);{var x=(M)=>{A8(M,{get post(){return J.post},get placement(){return J.placement},reason:"Hidden quote"})},I=(M)=>{Wz(M,{get post(){return J.post}})};j(U,(M)=>{if(J.post instanceof P8)M(x);else M(I,!1)},!0)}V(q,Y)};j(H,(q)=>{if(J.post instanceof E5)q(B);else q(F,!1)})}C(G),g(()=>K1(G,1,`post post-${J.placement??""} blocked`,"svelte-15n9djnirzicp")),V(w,G)};j(K,(w)=>{if(J.post instanceof S0)w(X);else w(Z,!1)})}V(z,Q)}var[r0,xJ]=g7(),vw=P("<!> <!> <!> <!> <!>",1),gw=P('<details class="svelte-2k39y5eft77zk"><summary class="svelte-2k39y5eft77zk"> </summary> <!></details>'),hw=P('<p class="missing-replies-info svelte-2k39y5eft77zk"><i class="fa-solid fa-ban"></i> <!> (likely taken down by moderation)</p>'),mw=P('<div><!> <!> <div class="content svelte-2k39y5eft77zk"><!> <!> <!> <!></div></div>');function L1(z,J){_(J,!0);let Q=(o)=>{var e=vw(),P0=h(e);Xz(P0,{get highlightedMatches(){return X()}});var V0=S(P0,2);{var k0=(G0)=>{wJ(G0,{})};j(V0,(G0)=>{if(K().tags)G0(k0)})}var Y0=S(V0,2);{var z0=(G0)=>{u6(G0,{get embed(){return K().embed}})};j(Y0,(G0)=>{if(K().embed&&U(K().embed))G0(z0)})}var t=S(Y0,2);{var B0=(G0)=>{e9(G0,{get url(){return K().originalFediURL}})};j(t,(G0)=>{if(K().originalFediURL&&q8(K().originalFediURL))G0(B0)})}var D0=S(t,2);{var H0=(G0)=>{WJ(G0,{get quoteCount(){return W(F)}})};j(D0,(G0)=>{if(K().likeCount!==void 0||K().repostCount!==void 0)G0(H0)})}V(o,e)},K=j0(J,"post",7),X=j0(J,"highlightedMatches",3,void 0),Z=c5(J,["$$slots","$$events","$$legacy","post","placement","highlightedMatches"]),w=f(!1),G=f(C0(K().replies)),H=f(!1),B=f(void 0);xJ({post:K(),placement:J.placement});let F=f(C0(K().quoteCount));function q(o){D(F,o,!0)}function Y(o){if(o instanceof S0)return!0;else if(o instanceof E5)return y0.biohazardsEnabled!==!1;else return!1}function U(o){if(K().originalFediURL){if(o instanceof C8&&o.title?.startsWith("Original post on "))return!1}return!0}function x(o){K().updateDataFromPost(o),D(G,K().replies,!0)}function I(o){let e=o.filter((P0)=>P0!==null);if(W(G).push(...e),K().replies=W(G),e.length===o.length&&e.length>0)D(B,void 0);else D(B,o.length-e.length);D(H,!0)}function M(o){U6(o)}var A={setQuoteCount:q},E=mw();let v;var T=O(E);XJ(T,{});var y=S(T,2);{var N=(o)=>{t9(o,{get collapsed(){return W(w)},set collapsed(e){D(w,e,!0)}})};j(y,(o)=>{if(J.placement=="thread"&&!K().isPageRoot)o(N)})}var R=S(y,2),k=O(R);{var $=(o)=>{var e=gw(),P0=O(e),V0=O(P0,!0);C(P0);var k0=S(P0,2);Q(k0),C(e),g(()=>u(V0,K().muteList?`Muted (${K().muteList})`:"Muted - click to show")),V(o,e)},b=(o)=>{Q(o)};j(k,(o)=>{if(K().muted)o($);else o(b,!1)})}var l=S(k,2);{var n=(o)=>{L1(o,{get post(){return W(G)[0]},placement:"thread",class:"flat"})},s=(o)=>{var e=d(),P0=h(e);A0(P0,17,()=>W(G),(V0)=>V0.uri,(V0,k0)=>{var Y0=d(),z0=h(Y0);{var t=(B0)=>{$6(B0,{get post(){return W(k0)},placement:"thread"})};j(z0,(B0)=>{if(Y(W(k0)))B0(t)})}V(V0,Y0)}),V(o,e)};j(l,(o)=>{if(K().replyCount==1&&W(G)[0]instanceof S0&&W(G)[0].author.did==K().author.did)o(n);else o(s,!1)})}var a=S(l,2);{var W0=(o)=>{var e=d(),P0=h(e);H9(P0,()=>W(G),(V0)=>{var k0=d(),Y0=h(k0);{var z0=(B0)=>{JJ(B0,{onLoad:x,onError:M})},t=(B0)=>{var D0=d(),H0=h(D0);{var G0=(n0)=>{zJ(n0,{onLoad:I,onError:M})};j(H0,(n0)=>{if(K().hasHiddenReplies&&y0.biohazardsEnabled!==!1)n0(G0)},!0)}V(B0,D0)};j(Y0,(B0)=>{if(K().hasMoreReplies)B0(z0);else B0(t,!1)})}V(V0,k0)}),V(o,e)};j(a,(o)=>{if(J.placement=="thread"&&!W(H))o(W0)})}var K0=S(a,2);{var q0=(o)=>{var e=hw(),P0=S(O(e),2);{var V0=(Y0)=>{var z0=N1();g(()=>u(z0,`${W(B)??""} replies are missing`)),V(Y0,z0)},k0=(Y0)=>{var z0=d(),t=h(z0);{var B0=(H0)=>{var G0=N1("1 reply is missing");V(H0,G0)},D0=(H0)=>{var G0=N1("Some replies are missing");V(H0,G0)};j(t,(H0)=>{if(W(B)==1)H0(B0);else H0(D0,!1)},!0)}V(Y0,z0)};j(P0,(Y0)=>{if(W(B)>1)Y0(V0);else Y0(k0,!1)})}z1(),C(e),V(o,e)};j(K0,(o)=>{if(W(B)!==void 0)o(q0)})}return C(R),C(E),g(()=>v=K1(E,1,`post post-${J.placement??""} ${(J.class||"")??""}`,"svelte-2k39y5eft77zk",v,{muted:K().muted,collapsed:W(w)})),V(z,E),c(A)}var fw=P('<main class="hashtag svelte-2cy8gir839nsk"><header><h2><!></h2></header> <!></main>');function MJ(z,J){_(J,!0);let Q=j0(J,"hashtag",7);Q(Q().replace(/^\#/,""));let K=C0([]),X=f(!1),Z=f(!1),w=!1,G=!1,H;F6(async()=>{if(w||G)return;w=!0;try{let U=await N0.getHashtagFeed(Q(),H),x=U.posts.map((I)=>new S0(I));if(D(X,!0),K.push(...x),w=!1,H=U.cursor,!H||K.length==0)G=!0}catch(U){console.log(U),w=!1,D(Z,!0)}});var B=d();E6("xlrj1v",(U)=>{u8(()=>{W6.title=`#${Q()??""} - Skythread`})});var F=h(B);{var q=(U)=>{var x=fw(),I=O(x),M=O(I),A=O(M);{var E=(y)=>{var N=N1();g(()=>u(N,`Posts tagged: #${Q()??""}`)),V(y,N)},v=(y)=>{var N=N1();g(()=>u(N,`No posts tagged #${Q()??""}.`)),V(y,N)};j(A,(y)=>{if(K.length>0)y(E);else y(v,!1)})}C(M),C(I);var T=S(I,2);A0(T,17,()=>K,(y)=>y.uri,(y,N)=>{L1(y,{get post(){return W(N)},placement:"feed"})}),C(x),V(U,x)},Y=(U)=>{var x=d(),I=h(x);{var M=(A)=>{o5(A,{})};j(I,(A)=>{if(!W(Z))A(M)},!0)}V(U,x)};j(F,(U)=>{if(W(X))U(q);else U(Y,!1)})}V(z,B),c()}var $w=P('<div id="search" class="svelte-20y046s055ja6"><form method="get" class="svelte-20y046s055ja6">\uD83C\uDF24 <input type="text" placeholder="Paste a thread link or type a #hashtag" class="svelte-20y046s055ja6"/></form></div>');function V7(z,J){_(J,!0);let Q=f(""),K;Q1(()=>{K.focus()});function X(H){H.preventDefault();let B=W(Q).trim();if(!B)return;if(B.startsWith("at://")){let F=new URL(m6());F.searchParams.set("q",B),location.assign(F.toString())}else if(B.match(/^#?((\p{Letter}|\p{Number})+)$/u)){let F=B.replace(/^#/,"");location.assign(L8(F))}else try{let{user:F,post:q}=Qz(B);location.assign(G5(F,q))}catch(F){console.log(F),alert(F.message||"This is not a valid URL or hashtag")}}var Z=$w(),w=O(Z),G=S(O(w));p0(G),z5(G,(H)=>K=H,()=>K),C(w),C(Z),C1("submit",w,X),P1(G,()=>W(Q),(H)=>D(Q,H)),V(z,Z),c()}var uw=P('<tr><td class="no svelte-3rl6pbqxjh5is"></td><td class="handle svelte-3rl6pbqxjh5is"><img class="avatar svelte-3rl6pbqxjh5is" alt="Avatar"/> <a target="_blank"> </a></td><td class="count svelte-3rl6pbqxjh5is"> </td></tr>'),lw=P('<table style="display: table;"><thead><tr><th colspan="3" class="svelte-3rl6pbqxjh5is"> </th></tr></thead><tbody></tbody></table>');function q7(z,J){var Q=lw(),K=O(Q),X=O(K),Z=O(X),w=O(Z,!0);C(Z),C(X),C(K);var G=S(K);A0(G,21,()=>J.users,O1,(H,B,F)=>{var q=uw(),Y=O(q);Y.textContent=F+1;var U=S(Y),x=O(U),I=S(x,2),M=O(I,!0);C(I),C(U);var A=S(U),E=O(A,!0);C(A),C(q),g(()=>{i(x,"src",W(B).avatar),i(I,"href",`https://bsky.app/profile/${W(B).handle??""}`),u(M,W(B).handle),u(E,W(B).count)}),V(H,q)}),C(G),C(Q),g(()=>{K1(Q,1,`scan-result ${J.cssClass??""}`,"svelte-3rl6pbqxjh5is"),u(w,J.header)}),V(z,Q)}class CJ{scanStartTime;appView;progressPosts;progressLikeRecords;progressPostLikes;onProgress;abortController;constructor(){this.appView=new _1("public.api.bsky.app"),this.progressPosts=0,this.progressLikeRecords=0,this.progressPostLikes=0}async findLikes(z,J){this.onProgress=J,this.resetProgress(),this.scanStartTime=new Date().getTime(),this.abortController=new AbortController;let Q=this.fetchGivenLikes(z),K=await this.fetchReceivedLikes(z),X=this.sumUpReceivedLikes(K),Z=this.getTopEntries(X),w=await Q,G=this.sumUpGivenLikes(w),H=this.getTopEntries(G),B=await this.appView.getRequest("app.bsky.actor.getProfiles",{actors:H.map((F)=>F.did)},{abortSignal:this.abortController.signal});for(let F of B.profiles){let q=H.find((Y)=>Y.did==F.did);q.handle=F.handle,q.avatar=F.avatar}return this.scanStartTime=void 0,{givenLikes:H,receivedLikes:Z}}async fetchGivenLikes(z){let J=this.scanStartTime;return await x0.fetchAll("com.atproto.repo.listRecords",{params:{repo:x0.user.did,collection:"app.bsky.feed.like",limit:100},field:"records",breakWhen:(Q)=>Date.parse(Q.value.createdAt)<J-86400*z*1000,onPageLoad:(Q)=>{let K=Q.at(-1);if(!K)return;let X=Date.parse(K.value.createdAt),Z=(J-X)/86400/1000;this.updateProgress({likeRecords:Math.min(1,Z/z)})},abortSignal:this.abortController.signal})}async fetchReceivedLikes(z){let J=this.scanStartTime,K=(await this.appView.loadUserTimeline(x0.user.did,z,{filter:"posts_with_replies",onPageLoad:(Z)=>{let w=Z.at(-1);if(!w)return;let G=d1(w),H=(J-G)/86400/1000;this.updateProgress({posts:Math.min(1,H/z)})},abortSignal:this.abortController.signal})).filter((Z)=>!Z.reason&&Z.post.likeCount>0),X=[];for(let Z=0;Z<K.length;Z+=10){let w=K.slice(Z,Z+10);this.updateProgress({postLikes:Z/K.length});let G=w.map((B)=>{return this.appView.fetchAll("app.bsky.feed.getLikes",{params:{uri:B.post.uri,limit:100},field:"likes",abortSignal:this.abortController.signal})}),H=await Promise.all(G);X=X.concat(H)}return this.updateProgress({postLikes:1}),X.flat()}sumUpReceivedLikes(z){let J={};for(let Q of z){let K=Q.actor.handle;if(!J[K])J[K]={handle:K,count:0,avatar:Q.actor.avatar};J[K].count+=1}return J}sumUpGivenLikes(z){let J={};for(let Q of z){let K=l0(Q.value.subject.uri).repo;if(!J[K])J[K]={did:K,count:0};J[K].count+=1}return J}getTopEntries(z){return Object.entries(z).sort(this.sortResults).map((J)=>J[1]).slice(0,25)}resetProgress(){this.progressPosts=0,this.progressLikeRecords=0,this.progressPostLikes=0,this.onProgress?.(0)}updateProgress(z){if(z.posts)this.progressPosts=z.posts;if(z.likeRecords)this.progressLikeRecords=z.likeRecords;if(z.postLikes)this.progressPostLikes=z.postLikes;let J=0.1*this.progressPosts+0.65*this.progressLikeRecords+0.25*this.progressPostLikes;this.onProgress?.(J)}sortResults(z,J){if(z[1].count<J[1].count)return 1;else if(z[1].count>J[1].count)return-1;else return 0}abortScan(){this.scanStartTime=void 0,this.onProgress=void 0,this.abortController?.abort(),delete this.abortController}}var pw=P('<progress style="display: inline;" class="svelte-2hvcjaqoddeji"></progress>'),dw=P("<!> <!>",1),iw=P('<main><h2>Like statistics</h2> <form><p>Time range: <input id="like_stats_range" type="range" min="1" max="60" class="svelte-2hvcjaqoddeji"/> <label for="like_stats_range"> </label></p> <p><input type="submit" class="svelte-2hvcjaqoddeji"/> <!></p></form> <!></main>');function OJ(z,J){_(J,!0);let Q=f(7),K=f(void 0),X=M0(()=>W(K)!==void 0),Z=f(void 0),w=f(void 0),G=new CJ;async function H(y){y.preventDefault();try{if(!W(X)){D(Z,void 0),D(w,void 0);let N=await G.findLikes(W(Q),(R)=>{D(K,R,!0)});D(Z,N.givenLikes,!0),D(w,N.receivedLikes,!0),D(K,void 0)}else G.abortScan(),D(K,void 0)}catch(N){if(N.name!=="AbortError")throw N}}var B=iw(),F=S(O(B),2),q=O(F),Y=S(O(q));p0(Y);var U=S(Y,2),x=O(U,!0);C(U),C(q);var I=S(q,2),M=O(I);p0(M);var A=S(M,2);{var E=(y)=>{var N=pw();g(()=>W5(N,W(K))),V(y,N)};j(A,(y)=>{if(W(X))y(E)})}C(I),C(F);var v=S(F,2);{var T=(y)=>{var N=dw(),R=h(N);q7(R,{cssClass:"given-likes",header:"â¤ï¸ Likes from you:",get users(){return W(Z)}});var k=S(R,2);q7(k,{cssClass:"received-likes",header:"\uD83D\uDC9B Likes on your posts:",get users(){return W(w)}}),V(y,N)};j(v,(y)=>{if(W(Z)&&W(w))y(T)})}C(B),g((y)=>{u(x,y),W5(M,W(X)?"Cancel":"Start scan")},[()=>v6(W(Q))]),C1("submit",F,H),P1(Y,()=>W(Q),(y)=>D(Q,y)),V(z,B),c()}var _w="did:web:lycan.feeds.blue#lycan";class Yz{lycanAddress;constructor(z){this.lycanAddress=z??_w}get proxyHeaders(){return{"atproto-proxy":this.lycanAddress}}async getImportStatus(){return await x0.getRequest("blue.feeds.lycan.getImportStatus",null,{headers:this.proxyHeaders})}async startImport(){await x0.postRequest("blue.feeds.lycan.startImport",null,{headers:this.proxyHeaders})}async makeQuery(z,J,Q){let K={collection:z,query:J};if(Q)K.cursor=Q;return await x0.getRequest("blue.feeds.lycan.searchPosts",K,{headers:this.proxyHeaders})}searchPosts(z,J,Q){let K=!1,X=!1,Z;F6(async()=>{if(K||X)return;K=!0;let w=await this.makeQuery(z,J,Z),H=(await x0.loadPosts(w.posts)).map((B)=>new S0(B));if(K=!1,Q.onPostsLoaded({posts:H,terms:w.terms}),Z=w.cursor,!Z)X=!0,Q.onFinish?.()})}}class F7 extends Yz{localLycan;constructor(z){super();this.localLycan=new _1(z)}async getImportStatus(){return await this.localLycan.getRequest("blue.feeds.lycan.getImportStatus",{user:x0.user.did})}async startImport(){await this.localLycan.postRequest("blue.feeds.lycan.startImport",{user:x0.user.did})}async makeQuery(z,J,Q){let K={collection:z,query:J,user:x0.user.did};if(Q)K.cursor=Q;return await this.localLycan.getRequest("blue.feeds.lycan.searchPosts",K)}}var cw=P('<main class="search-page svelte-geig8bptdwj6"><!></main>');function Gz(z,J){var Q=cw(),K=O(Q);G6(K,()=>J.children),C(Q),V(z,Q)}var sw=P('<input type="radio" name="collection"/> <label class="svelte-1xaglya9rfxfs"> </label>',1),ow=P(`<form class="svelte-1xaglya9rfxfs"><h4>Data not imported yet</h4> <p class="svelte-1xaglya9rfxfs">In order to search within your likes and bookmarks, the posts you've liked or saved need to be imported into a database.
            This is a one-time process, but it can take several minutes or more, depending on the age of your account.</p> <p class="svelte-1xaglya9rfxfs">To start the import, press the button below. You can then wait until it finishes, or close this tab and come back a bit later.
            After the import is complete, the database will be kept up to date automatically going forward.</p> <p class="svelte-1xaglya9rfxfs"><input type="submit" value="Start import"/></p></form>`),aw=P('<p><progress class="svelte-1xaglya9rfxfs"></progress> <output class="svelte-1xaglya9rfxfs"> </output></p>'),rw=P('<div class="import-progress svelte-1xaglya9rfxfs"><h4>Import in progress</h4> <p class="import-status"> </p> <!></div>'),nw=P('<div class="lycan-import svelte-1xaglya9rfxfs"><!></div>'),tw=P("<p>...</p>"),ew=P('<p class="results-end"> </p>'),zW=P("<!> <!>",1),JW=P('<h2>Archive search</h2> <form class="search-form"><p class="search">Search: <input type="text" class="search-query" autocomplete="off"/></p> <div class="search-collections svelte-1xaglya9rfxfs"></div></form> <!> <div class="results"><!></div>',1);function PJ(z,J){_(J,!0);let Q=[],K=[{id:"likes",title:"Likes"},{id:"reposts",title:"Reposts"},{id:"quotes",title:"Quotes"},{id:"pins",title:"Pins"}],X=M0(()=>A(J.lycan)),Z=f(!1),w=f(void 0),G=f(void 0),H=f(0),B=f(!1),F,q=f(C0(K[0].id)),Y=f(""),U=f(!1),x=f(!1),I=f(C0([])),M=f(C0([]));T();function A(b){if(!b)return new Yz;else if(b=="local"||b=="localhost")return new F7("http://localhost:3000");else if(b.startsWith("local:")||b.startsWith("localhost:")){let l=b.split(":")[1];return new F7(`http://localhost:${l}`)}else return new Yz(`did:web:${J.lycan}#lycan`)}function E(b){b.preventDefault(),y({status:"requested"}),D(B,!0),W(X).startImport().catch((l)=>{console.error("Failed to start Lycan import",l),R(`Import failed: ${l}`)})}function v(b){if(b.key=="Enter"){b.preventDefault();let l=W(Y).trim().toLowerCase();if(l.length==0||W(w)!="finished")return;D(I,[],!0),D(B,!1),D(U,!0),D(x,!1),W(X).searchPosts(W(q),l,{onPostsLoaded:({posts:n,terms:s})=>{D(U,!1),W(I).push(...n),D(M,s,!0)},onFinish:()=>{D(x,!0)}})}}async function T(){if(W(Z))return;D(Z,!0);try{let b=await W(X).getImportStatus();y(b)}catch(b){R(`Couldn't check import status: ${b}`)}finally{D(Z,!1)}}function y(b){if(console.log(b),!b.status){R("Error checking import status");return}D(w,b.status,!0);let l=["in_progress","scheduled","requested"].includes(b.status);if(D(B,W(B)||l,!0),b.status=="not_started");else if(l)N(b);else if(b.status=="finished")N({status:"finished",progress:1});else R("Error checking import status");l?k():$()}function N(b){if(D(H,Math.max(0,Math.min(b.progress||0,1)),!0),b.progress==1)D(G,"Import complete âœ“");else if(b.position){let l=new Date(b.position).toLocaleString(y0.dateLocale,{day:"numeric",month:"short",year:"numeric"});D(G,`Downloaded data until: ${l}`)}else if(b.status=="requested")D(G,"Requesting importâ€¦");else D(G,"Import startedâ€¦")}function R(b){D(w,"error"),D(B,!0),D(G,b,!0),$()}function k(){if(!F)F=setInterval(T,3000)}function $(){if(F)clearInterval(F),F=void 0}Gz(z,{children:(b,l)=>{var n=JW(),s=S(h(n),2),a=O(s),W0=S(O(a));p0(W0),W0.__keydown=v,C(a);var K0=S(a,2);A0(K0,21,()=>K,O1,(Y0,z0)=>{var t=sw(),B0=h(t);p0(B0);var D0,H0=S(B0,2),G0=O(H0,!0);C(H0),g(()=>{if(i(B0,"id",`collection-${W(z0).id??""}`),D0!==(D0=W(z0).id))B0.value=(B0.__value=W(z0).id)??"";i(H0,"for",`collection-${W(z0).id??""}`),u(G0,W(z0).title)}),c8(Q,[],B0,()=>{return W(z0).id,W(q)},(n0)=>D(q,n0)),V(Y0,t)}),C(K0),C(s);var q0=S(s,2);{var o=(Y0)=>{var z0=nw(),t=O(z0);{var B0=(H0)=>{var G0=ow();C1("submit",G0,E),V(H0,G0)},D0=(H0)=>{var G0=rw(),n0=S(O(G0),2),v5=O(n0,!0);C(n0);var Hz=S(n0,2);{var a5=(r5)=>{var B5=aw(),l6=O(B5),p6=S(l6,2),n5=O(p6);C(p6),C(B5),g((d6)=>{W5(l6,W(H)),u(n5,`${d6??""}%`)},[()=>Math.round(W(H)*100)]),V(r5,B5)};j(Hz,(r5)=>{if(W(w)!="error")r5(a5)})}C(G0),g(()=>u(v5,W(G))),V(H0,G0)};j(t,(H0)=>{if(W(w)=="not_started")H0(B0);else H0(D0,!1)})}C(z0),V(Y0,z0)};j(q0,(Y0)=>{if(W(B)||W(w)=="not_started")Y0(o)})}var e=S(q0,2),P0=O(e);{var V0=(Y0)=>{var z0=tw();V(Y0,z0)},k0=(Y0)=>{var z0=zW(),t=h(z0);A0(t,17,()=>W(I),(H0)=>H0.uri,(H0,G0)=>{L1(H0,{get post(){return W(G0)},placement:"feed",get highlightedMatches(){return W(M)}})});var B0=S(t,2);{var D0=(H0)=>{var G0=ew(),n0=O(G0,!0);C(G0),g(()=>u(n0,W(I).length>0?"No more results.":"No results.")),V(H0,G0)};j(B0,(H0)=>{if(W(x))H0(D0)})}V(Y0,z0)};j(P0,(Y0)=>{if(W(U))Y0(V0);else Y0(k0,!1)})}C(e),g(()=>W0.disabled=W(w)!="finished"),P1(W0,()=>W(Y),(Y0)=>D(Y,Y0)),V(b,n)},$$slots:{default:!0}}),c()}I0(["keydown"]);var QW=P("<a>Reply to you</a>"),KW=P("<a> </a>"),ZW=P("<a> </a>"),XW=P("<a>Reply</a>"),wW=P('<p class="back"><i class="fa-solid fa-reply"></i> <!></p>');function Bz(z,J){_(J,!0);let Q=M0(()=>l0(J.uri)),K=M0(()=>W(Q).repo),X=M0(()=>W(Q).rkey);var Z=wW(),w=S(O(Z),2);{var G=(B)=>{var F=QW();g((q)=>i(F,"href",q),[()=>G5(W(K),W(X))]),V(B,F)},H=(B)=>{var F=d(),q=h(F);T6(q,()=>N0.fetchHandleForDid(W(K)),(Y)=>{var U=XW();g((x)=>i(U,"href",x),[()=>G5(W(K),W(X))]),V(Y,U)},(Y,U)=>{var x=KW(),I=O(x);C(x),g((M)=>{i(x,"href",M),u(I,`Reply to @${W(U)??""}`)},[()=>G5(W(U),W(X))]),V(Y,x)},(Y)=>{var U=ZW(),x=O(U);C(U),g((I)=>{i(U,"href",I),u(x,`Reply to ${W(K)??""}`)},[()=>G5(W(K),W(X))]),V(Y,U)}),V(B,F)};j(w,(B)=>{if(x0&&W(K)==x0.user.did)B(G);else B(H,!1)})}C(Z),V(z,Z),c()}var WW=P("<!> <!>",1),YW=P('<main class="notifications svelte-3q0ai2k4d1d8n"><header><h2>Replies & Mentions:</h2></header> <!></main>');function LJ(z,J){_(J,!0);let Q=C0([]),K=f(!1),X=f(!1),Z=!1,w=!1,G;F6(async(Y)=>{if(Z||w)return;Z=!0;try{let U=await x0.loadMentions(G),x=U.posts.map((I)=>new S0(I));if(!W(K)&&x.length>0)D(K,!0);if(Q.push(...x),Z=!1,G=U.cursor,!G)w=!0;else if(x.length==0)Y()}catch(U){console.log(U),Z=!1,D(X,!0)}});var H=d();E6("387i67",(Y)=>{H1(()=>{W6.title="Notifications - Skythread"})});var B=h(H);{var F=(Y)=>{var U=YW(),x=S(O(U),2);A0(x,17,()=>Q,(I)=>I.uri,(I,M)=>{var A=WW(),E=h(A);{var v=(y)=>{Bz(y,{get uri(){return W(M).parentReference.uri}})};j(E,(y)=>{if(W(M).parentReference)y(v)})}var T=S(E,2);L1(T,{get post(){return W(M)},placement:"feed"}),V(I,A)}),C(U),V(Y,U)},q=(Y)=>{var U=d(),x=h(U);{var I=(M)=>{o5(M,{})};j(x,(M)=>{if(!W(X))M(I)},!0)}V(Y,U)};j(B,(Y)=>{if(W(K))Y(F);else Y(q,!1)})}V(z,H),c()}var OK=(z,J=J5)=>{var Q=GW(),K=h(Q),X=S(K,2),Z=O(X,!0);C(X);var w=S(X,2),G=O(w,!0);C(w),g(()=>{i(K,"src",J().avatar),u(Z,J().displayName||"â€“"),u(G,J().handle)}),V(z,Q)},GW=P('<img class="avatar svelte-2z5j67wda5rm6" alt="Avatar"/> <span class="name svelte-2z5j67wda5rm6"> </span> <span class="handle svelte-2z5j67wda5rm6"> </span>',1),BW=P("<div><!></div>"),HW=P('<div class="autocomplete svelte-2z5j67wda5rm6"></div>'),UW=P('<div class="user-row svelte-2z5j67wda5rm6"><!> <a class="remove svelte-2z5j67wda5rm6" href="#">âœ•</a></div>'),VW=P('<div class="user-choice svelte-2z5j67wda5rm6"><input type="text" placeholder="Add user" autocomplete="off" class="svelte-2z5j67wda5rm6"/> <!> <div class="selected-users svelte-2z5j67wda5rm6"></div></div>');function IJ(z,J){_(J,!0);let Q=j0(J,"selectedUsers",27,()=>C0([])),K=f(""),X=f(C0([])),Z=f(-1),w=M0(()=>Q().map((R)=>R.did)),G=M0(()=>W(X).length>0),H=f(0),B;Q1(()=>{let R=document.body.parentNode;return R.addEventListener("click",U),()=>{R.removeEventListener("click",U)}});function F(){if(B)clearTimeout(B);let R=W(K).trim();if(R.length>0)B=setTimeout(()=>Y(R),100);else U(),B=void 0}function q(R){if(R.key=="Enter"){if(R.preventDefault(),W(Z)>=0)M(W(Z))}else if(R.key=="Escape")U();else if(R.key=="ArrowDown"&&W(X).length>0)R.preventDefault(),x(1);else if(R.key=="ArrowUp"&&W(X).length>0)R.preventDefault(),x(-1)}async function Y(R){let k=await N0.autocompleteUsers(R),$=new Set(W(w));if(k=k.filter((b)=>!$.has(b.did)),k.length>0)D(X,k,!0),D(Z,0);else U()}function U(){D(X,[],!0),D(Z,-1)}function x(R){if(W(X).length==0)return;let k=W(Z)+R;if(k<0)k=W(X).length-1;else if(k>=W(X).length)k=0;D(Z,k,!0)}function I(R,k){R.preventDefault(),M(k)}function M(R){let k=W(X)[R];if(!k)return;Q().push(k),D(K,""),U()}function A(R,k){R.preventDefault(),Q().splice(k,1)}var E=VW(),v=O(E);p0(v),k6(v,!0),v.__input=F,v.__keydown=q;var T=S(v,2);{var y=(R)=>{var k=HW();let $;A0(k,23,()=>W(X),(b)=>b.did,(b,l,n)=>{var s=BW();let a;s.__mousedown=(K0)=>{I(K0,W(n))};var W0=O(s);OK(W0,()=>W(l)),C(s),g(()=>a=K1(s,1,"user-row svelte-2z5j67wda5rm6",null,a,{highlighted:W(Z)==W(n)})),C1("mouseenter",s,()=>{D(Z,W(n),!0)}),V(b,s)}),C(k),g(()=>$=_5(k,"",$,{display:W(G)?"block":"none",top:`${W(H)??""}px`})),V(R,k)};j(T,(R)=>{if(W(G))R(y)})}var N=S(T,2);A0(N,23,Q,(R)=>R.did,(R,k,$)=>{var b=UW(),l=O(b);OK(l,()=>W(k));var n=S(l,2);n.__click=(s)=>{A(s,W($))},C(b),V(R,b)}),C(N),C(E),P1(v,()=>W(K),(R)=>D(K,R)),S9(v,"offsetHeight",(R)=>D(H,R)),V(z,E),c()}I0(["input","keydown","mousedown","click"]);var qW=P('<th class="svelte-3u8wzgp5meuu">All posts /d</th> <th class="svelte-3u8wzgp5meuu">Own posts /d</th> <th class="svelte-3u8wzgp5meuu">Reposts /d</th>',1),FW=P('<th class="svelte-3u8wzgp5meuu">Posts /d</th>'),xW=P('<th class="svelte-3u8wzgp5meuu">% of timeline</th>'),MW=P('<td class="svelte-3u8wzgp5meuu"> </td>'),CW=P('<td class="svelte-3u8wzgp5meuu"> </td>'),OW=P('<td class="percent svelte-3u8wzgp5meuu"></td>'),PW=P('<tr class="total svelte-3u8wzgp5meuu"><td class="no svelte-3u8wzgp5meuu"></td><td class="handle svelte-3u8wzgp5meuu">Total:</td><!><td class="svelte-3u8wzgp5meuu"> </td><!><!></tr>'),LW=P('<td class="svelte-3u8wzgp5meuu"> </td>'),IW=P('<td class="svelte-3u8wzgp5meuu"> </td>'),SW=P('<td class="percent svelte-3u8wzgp5meuu"> </td>'),jW=P('<tr><td class="no svelte-3u8wzgp5meuu"></td><td class="handle svelte-3u8wzgp5meuu"><img class="avatar svelte-3u8wzgp5meuu" alt="Avatar"/> <a target="_blank"> </a></td><!><td class="svelte-3u8wzgp5meuu"> </td><!><!></tr>'),DW=P('<table class="scan-result svelte-3u8wzgp5meuu"><thead><tr><th class="svelte-3u8wzgp5meuu">#</th><th class="svelte-3u8wzgp5meuu">Handle</th><!><!></tr></thead><tbody><!><!></tbody></table>');function SJ(z,J){_(J,!0);let Q=j0(J,"showReposts",3,!0),K=j0(J,"showPercentages",3,!0),X=j0(J,"showTotal",3,!0);function Z(E){return E>0?E.toFixed(1):"â€“"}var w=DW(),G=O(w),H=O(G),B=S(O(H),2);{var F=(E)=>{var v=qW();z1(4),V(E,v)},q=(E)=>{var v=FW();V(E,v)};j(B,(E)=>{if(Q())E(F);else E(q,!1)})}var Y=S(B);{var U=(E)=>{var v=xW();V(E,v)};j(Y,(E)=>{if(K())E(U)})}C(H),C(G);var x=S(G),I=O(x);{var M=(E)=>{var v=PW(),T=S(O(v),2);{var y=(n)=>{var s=MW(),a=O(s,!0);C(s),g((W0)=>u(a,W0),[()=>Z(J.sums.all/J.daysBack)]),V(n,s)};j(T,(n)=>{if(Q())n(y)})}var N=S(T),R=O(N,!0);C(N);var k=S(N);{var $=(n)=>{var s=CW(),a=O(s,!0);C(s),g((W0)=>u(a,W0),[()=>Z(J.sums.reposts/J.daysBack)]),V(n,s)};j(k,(n)=>{if(Q())n($)})}var b=S(k);{var l=(n)=>{var s=OW();V(n,s)};j(b,(n)=>{if(K())n(l)})}C(v),g((n)=>u(R,n),[()=>Z(J.sums.own/J.daysBack)]),V(E,v)};j(I,(E)=>{if(X())E(M)})}var A=S(I);A0(A,17,()=>J.users,O1,(E,v,T)=>{var y=jW(),N=O(y);N.textContent=T+1;var R=S(N),k=O(R),$=S(k,2),b=O($,!0);C($),C(R);var l=S(R);{var n=(e)=>{var P0=LW(),V0=O(P0,!0);C(P0),g((k0)=>u(V0,k0),[()=>Z(W(v).all/J.daysBack)]),V(e,P0)};j(l,(e)=>{if(Q())e(n)})}var s=S(l),a=O(s,!0);C(s);var W0=S(s);{var K0=(e)=>{var P0=IW(),V0=O(P0,!0);C(P0),g((k0)=>u(V0,k0),[()=>Z(W(v).reposts/J.daysBack)]),V(e,P0)};j(W0,(e)=>{if(Q())e(K0)})}var q0=S(W0);{var o=(e)=>{var P0=SW(),V0=O(P0);C(P0),g((k0)=>u(V0,`${k0??""}%`),[()=>Z(W(v).all*100/J.sums.all)]),V(e,P0)};j(q0,(e)=>{if(K())e(o)})}C(y),g((e)=>{i(k,"src",W(v).avatar),i($,"href",`https://bsky.app/profile/${W(v).handle??""}`),u(b,W(v).handle),u(a,e)},[()=>Z(W(v).own/J.daysBack)]),V(E,y)}),C(x),C(w),V(z,w),c()}class jJ{appView;userProgress;onProgress;abortController;constructor(z){this.onProgress=z,this.appView=new _1("public.api.bsky.app"),this.userProgress={}}async scanHomeTimeline(z){let J=new Date().getTime();this.abortController=new AbortController;let Q=await x0.loadHomeTimeline(z,{onPageLoad:(K)=>this.updateProgress(K,J),abortSignal:this.abortController.signal,keepLastPage:!0});return this.generateResults(Q,z,J)}async scanListTimeline(z,J){let Q=new Date().getTime();this.abortController=new AbortController;let K=await x0.loadListTimeline(z,J,{onPageLoad:(X)=>this.updateProgress(X,Q),abortSignal:this.abortController.signal,keepLastPage:!0});return this.generateResults(K,J,Q)}async scanUserTimelines(z,J){let Q=new Date().getTime(),K=z.map((H)=>H.did);this.resetUserProgress(K),this.abortController=new AbortController;let X=this.abortController.signal,Z=K.map((H)=>this.appView.loadUserTimeline(H,J,{filter:"posts_and_author_threads",onPageLoad:(B)=>this.updateUserProgress(H,B,Q,J),abortSignal:X,keepLastPage:!0})),G=(await Promise.all(Z)).flat();return this.generateResults(G,J,Q,{countFetchedDays:!1,users:z})}async scanYourTimeline(z){let J=new Date().getTime();this.abortController=new AbortController;let Q=await x0.loadUserTimeline(x0.user.did,z,{filter:"posts_no_replies",onPageLoad:(K)=>this.updateProgress(K,J),abortSignal:this.abortController.signal,keepLastPage:!0});return this.generateResults(Q,z,J)}generateResults(z,J,Q,K={}){let X=z.at(-1);if(!X)return null;let Z={},w=d1(X),G=(Q-w)/86400/1000,H;if(K.countFetchedDays!==!1)H=Math.min(J,G);else H=J;let B=Q-J*86400*1000;if(z=z.filter((U)=>d1(U)>B),z.reverse(),K.users)for(let U of K.users)Z[U.handle]={handle:U.handle,own:0,reposts:0,avatar:U.avatar};let F=new Set,q={own:0,reposts:0,all:0};for(let U of z){if(U.reply){if(!F.has(U.reply.parent.uri))continue}let x=U.reason?U.reason.by:U.post.author,I=x.handle;if(Z[I]=Z[I]??{handle:I,own:0,reposts:0,avatar:x.avatar},U.reason)Z[I].reposts+=1,q.reposts+=1;else Z[I].own+=1,q.own+=1,F.add(U.post.uri)}let Y=Object.values(Z);return Y.forEach((U)=>{U.all=U.own+U.reposts}),Y.sort((U,x)=>x.all-U.all),q.all=q.own+q.reposts,{users:Y,sums:q,fetchedDays:G,daysBack:H}}updateProgress(z,J){let Q=z.at(-1);if(!Q)return;let K=d1(Q),X=(J-K)/86400/1000;this.onProgress?.(X)}resetUserProgress(z){this.userProgress={};for(let J of z)this.userProgress[J]={pages:0,progress:0}}updateUserProgress(z,J,Q,K){let X=J.at(-1);if(!X)return;let Z=d1(X),w=(Q-Z)/86400/1000;this.userProgress[z].pages+=1,this.userProgress[z].progress=Math.min(w/K,1);let G=Object.values(this.userProgress).map((Y)=>Y.pages/Y.progress),H=G.filter((Y)=>!isNaN(Y)),B=H.reduce((Y,U)=>Y+U)/H.length*G.length,q=Object.values(this.userProgress).map((Y)=>Y.pages).reduce((Y,U)=>Y+U)/B*K;this.onProgress?.(q)}abortScan(){this.abortController?.abort(),delete this.abortController}}var RW=P('<input type="radio" name="scan_type" class="svelte-936eaahz55lf"/> <label class="svelte-936eaahz55lf"> </label>',1),AW=P("<option> </option>"),NW=P('<p class="list-choice"><label for="posting_stats_list">Select list:</label> <select id="posting_stats_list" name="scan_list" class="svelte-936eaahz55lf"></select></p>'),kW=P('<progress class="svelte-936eaahz55lf"></progress>'),bW=P('<p class="scan-info svelte-936eaahz55lf"> </p>'),TW=P('<main><h2>Bluesky posting statistics</h2> <form><p>Scan posts from: <!></p> <p>Time range: <input id="posting_stats_range" type="range" min="1" max="60" class="svelte-936eaahz55lf"/> <label for="posting_stats_range"> </label></p> <!> <!> <p><input type="submit" class="svelte-936eaahz55lf"/> <!></p></form> <!> <!></main>');function DJ(z,J){_(J,!0);let Q=[],K=[{id:"home",title:"Home timeline"},{id:"list",title:"List feed"},{id:"users",title:"Selected users"},{id:"you",title:"Your profile"}],X=f(C0([])),Z=f(7),w=f(C0(K[0].id)),G=f(C0([])),H=f(void 0),B=f(!1),F=f(void 0),q=f(void 0),Y=f(void 0),U=f(C0({})),x=f(null),I=new jJ((z0)=>{D(q,Math.max(W(q)||0,z0),!0)});Q1(()=>{A()});function M(){D(x,null)}async function A(){let z0=await x0.loadUserLists();D(X,z0.sort((t,B0)=>{let D0=t.name.toLocaleLowerCase(),H0=B0.name.toLocaleLowerCase();return D0.localeCompare(H0)}),!0),D(H,W(X)[0]?.uri,!0)}async function E(z0){z0.preventDefault();try{if(!W(B))await v();else D(B,!1),I.abortScan()}catch(t){if(t.name!=="AbortError")throw t}}async function v(){if(W(w)=="list"&&!W(H)||W(w)=="users"&&W(G).length==0)return;D(Y,void 0),D(x,null),D(F,W(Z),!0),D(q,0),D(B,!0);let z0=new Date().getTime(),t,B0;if(W(w)=="home")B0={},t=await I.scanHomeTimeline(W(F));else if(W(w)=="list")B0={showReposts:!1},t=await I.scanListTimeline(W(H),W(F));else if(W(w)=="users")B0={showTotal:!1,showPercentages:!1},t=await I.scanUserTimelines(W(G),W(F));else B0={showTotal:!1,showPercentages:!1},t=await I.scanYourTimeline(W(F));if(new Date().getTime()-z0<150)await new Promise((H0)=>setTimeout(H0,150));D(U,B0,!0),D(x,t,!0),D(B,!1)}var T=TW(),y=S(O(T),2),N=O(y),R=S(O(N));A0(R,17,()=>K,O1,(z0,t)=>{var B0=RW(),D0=h(B0);p0(D0),D0.__click=M;var H0,G0=S(D0,2),n0=O(G0,!0);C(G0),g(()=>{if(i(D0,"id",`scan_type_${W(t).id??""}`),H0!==(H0=W(t).id))D0.value=(D0.__value=W(t).id)??"";i(G0,"for",`scan_type_${W(t).id??""}`),u(n0,W(t).title)}),c8(Q,[],D0,()=>{return W(t).id,W(w)},(v5)=>D(w,v5)),V(z0,B0)}),C(N);var k=S(N,2),$=S(O(k));p0($);var b=S($,2),l=O(b,!0);C(b),C(k);var n=S(k,2);{var s=(z0)=>{var t=NW(),B0=S(O(t),2);A0(B0,21,()=>W(X),O1,(D0,H0)=>{var G0=AW(),n0=O(G0);C(G0);var v5={};g(()=>{if(u(n0,`${W(H0).name??""}Â `),v5!==(v5=W(H0).uri))G0.value=(G0.__value=W(H0).uri)??""}),V(D0,G0)}),C(B0),C(t),x9(B0,()=>W(H),(D0)=>D(H,D0)),V(z0,t)};j(n,(z0)=>{if(W(w)=="list")z0(s)})}var a=S(n,2);{var W0=(z0)=>{IJ(z0,{get selectedUsers(){return W(G)},set selectedUsers(t){D(G,t,!0)}})};j(a,(z0)=>{if(W(w)=="users")z0(W0)})}var K0=S(a,2),q0=O(K0);p0(q0);var o=S(q0,2);{var e=(z0)=>{var t=kW();g(()=>{i(t,"max",W(F)),W5(t,W(q))}),V(z0,t)};j(o,(z0)=>{if(W(B))z0(e)})}C(K0),C(y);var P0=S(y,2);{var V0=(z0)=>{var t=bW(),B0=O(t,!0);C(t),g(()=>u(B0,W(Y))),V(z0,t)};j(P0,(z0)=>{if(W(Y))z0(V0)})}var k0=S(P0,2);{var Y0=(z0)=>{SJ(z0,R9(()=>W(U),()=>W(x)))};j(k0,(z0)=>{if(W(x))z0(Y0)})}C(T),g((z0)=>{u(l,z0),W5(q0,!W(B)?"Start scan":"Cancel")},[()=>v6(W(Z))]),C1("submit",y,E),P1($,()=>W(Z),(z0)=>D(Z,z0)),V(z,T),c()}I0(["click"]);var EW=P("<!> <!>",1),yW=P('<main class="quotes svelte-3bl0i96onoebm"><header><h2><!></h2></header> <!></main>');function RJ(z,J){_(J,!0);let Q=!1,K,X=!1,Z=C0([]),w=f(void 0),G=f(!1);F6(async()=>{if(Q||X)return;Q=!0;try{let Y=await Kz.getQuotes(J.postURL,K),x=(await N0.loadPosts(Y.posts)).map((I)=>new S0(I));if(W(w)===void 0)D(w,Y.quoteCount,!0);if(Z.push(...x),Q=!1,K=Y.cursor,!K||Z.length==0)X=!0}catch(Y){console.log(Y),Q=!1,D(G,!0),U6(Y)}});var H=d(),B=h(H);{var F=(Y)=>{var U=yW(),x=O(U),I=O(x),M=O(I);{var A=(T)=>{var y=N1();g(()=>u(y,`${W(w)??""} quotes:`)),V(T,y)},E=(T)=>{var y=d(),N=h(y);{var R=($)=>{var b=N1("1 quote:");V($,b)},k=($)=>{var b=N1("No quotes found.");V($,b)};j(N,($)=>{if(W(w)==1)$(R);else $(k,!1)},!0)}V(T,y)};j(M,(T)=>{if(W(w)>1)T(A);else T(E,!1)})}C(I),C(x);var v=S(x,2);A0(v,17,()=>Z,(T)=>T.uri,(T,y)=>{var N=EW(),R=h(N);{var k=(b)=>{Bz(b,{get uri(){return W(y).parentReference.uri}})};j(R,(b)=>{if(W(y).parentReference)b(k)})}var $=S(R,2);L1($,{get post(){return W(y)},placement:"quotes"}),V(T,N)}),C(U),V(Y,U)},q=(Y)=>{var U=d(),x=h(U);{var I=(M)=>{o5(M,{})};j(x,(M)=>{if(!W(G))M(I)},!0)}V(Y,U)};j(B,(Y)=>{if(W(w)!==void 0)Y(F);else Y(q,!1)})}V(z,H),c()}var vW=P('<div id="tangled" class="svelte-14j5zro1yllpd"><a href="https://tangled.org/mackuba.eu/skythread" target="_blank" class="svelte-14j5zro1yllpd"><img src="icons/tangled_dolly.svg" alt="Tangled" class="svelte-14j5zro1yllpd"/></a></div>');function AJ(z){var J=vW();V(z,J)}var gW=P('<p class="back"><i class="fa-solid fa-reply"></i> <a> </a></p>'),hW=P('<div class="back"><!></div>'),mW=P('<p class="back"><i class="fa-solid fa-ban"></i> parent post has been deleted</p>'),fW=P(`<p class="back"><i class="fa-solid fa-ban"></i> something went wrong, this shouldn't happen</p>`);function NJ(z,J){_(J,!0);var Q=d(),K=h(Q);{var X=(w)=>{var G=gW(),H=S(O(G),2),B=O(H);C(H),C(G),g((F)=>{i(H,"href",F),u(B,`See parent post (@${J.post.author.handle??""})`)},[()=>y5(J.post)]),V(w,G)},Z=(w)=>{var G=d(),H=h(G);{var B=(q)=>{var Y=hW(),U=O(Y);A8(U,{get post(){return J.post},placement:"parent",reason:"Parent post blocked"}),C(Y),V(q,Y)},F=(q)=>{var Y=d(),U=h(Y);{var x=(M)=>{var A=mW();V(M,A)},I=(M)=>{var A=fW();V(M,A)};j(U,(M)=>{if(J.post instanceof O5)M(x);else M(I,!1)},!0)}V(q,Y)};j(H,(q)=>{if(J.post instanceof E5)q(B);else q(F,!1)},!0)}V(w,G)};j(K,(w)=>{if(J.post instanceof S0)w(X);else w(Z,!1)})}V(z,Q),c()}var $W=P("<!> <!>",1),uW=P("<main><!></main>");function x7(z,J){_(J,!0);let Q=c5(J,["$$slots","$$events","$$legacy"]),K=f(void 0),X=f(!1),Z=f(void 0),w;if("url"in Q){let{url:q}=Q;if(q.startsWith("at://"))w=N0.loadThreadByAtURI(q);else w=N0.loadThreadByURL(q)}else{let{author:q,rkey:Y}=Q;w=N0.loadThreadById(q,Y)}w.then((q)=>{let Y=V6(q.thread);if(window.root=Y,window.subtreeRoot=Y,D(K,Y,!0),Y instanceof S0)Y.data.quoteCount=void 0,Kz.getQuoteCount(Y.uri).then((U)=>{W(Z)?.setQuoteCount(U)}).catch((U)=>{console.warn("Couldn't load quote count: "+U)})}).catch((q)=>{U6(q),D(X,!0)});var G=d();E6("64euhl",(q)=>{var Y=d(),U=h(Y);{var x=(I)=>{u8(()=>{W6.title=`${W(K).author.displayName??""}: "${W(K).text??""}" - Skythread`})};j(U,(I)=>{if(W(K)instanceof S0)I(x)})}V(q,Y)});var H=h(G);{var B=(q)=>{var Y=uW(),U=O(Y);{var x=(M)=>{var A=$W(),E=h(A);{var v=(N)=>{NJ(N,{get post(){return W(K).parent}})},T=(N)=>{var R=d(),k=h(R);{var $=(b)=>{wz(b,{get uri(){return W(K).parentReference.uri}})};j(k,(b)=>{if(W(K).parentReference)b($)},!0)}V(N,R)};j(E,(N)=>{if(W(K).parent)N(v);else N(T,!1)})}var y=S(E,2);z5(L1(y,{get post(){return W(K)},placement:"thread"}),(N)=>D(Z,N,!0),()=>W(Z)),V(M,A)},I=(M)=>{$6(M,{get post(){return W(K)},placement:"thread"})};j(U,(M)=>{if(W(K)instanceof S0)M(x);else M(I,!1)})}C(Y),V(q,Y)},F=(q)=>{var Y=d(),U=h(Y);{var x=(I)=>{o5(I,{})};j(U,(I)=>{if(!W(X))I(x)},!0)}V(q,Y)};j(H,(q)=>{if(W(K))q(B);else q(F,!1)})}V(z,G),c()}class kJ{timelinePosts;abortController;constructor(){this.timelinePosts=[]}async fetchTimeline(z,J){let Q=new Date().getTime();this.abortController=new AbortController;let K=await x0.loadHomeTimeline(z,{abortSignal:this.abortController.signal,onPageLoad:(X)=>{let Z=this.calculateProgress(X,Q);if(Z)J(Z)}});this.timelinePosts=K}calculateProgress(z,J){let Q=z.at(-1);if(!Q)return null;let K=d1(Q);return(J-K)/86400/1000}searchPosts(z){if(z.length==0)return[];return this.timelinePosts.filter((Q)=>Q.post.record.text.toLowerCase().includes(z)).map((Q)=>XK(Q))}abortFetch(){this.abortController?.abort(),delete this.abortController}}var lW=P("<progress></progress>"),pW=P('<p class="archive-status"> </p>'),dW=P('<form class="search-form"><p class="search">Search: <input type="text" class="search-query" autocomplete="off"/></p></form> <div class="results"></div>',1),iW=P('<h2>Timeline search</h2> <div class="timeline-search"><form><p>Fetch timeline posts: <input id="timeline_search_range" type="range" min="1" max="60" class="svelte-27yj0b3y75jqg"/> <label for="timeline_search_range"> </label></p> <p><input type="submit"/> <!></p></form> <!> <hr/></div> <!>',1);function bJ(z,J){_(J,!0);let Q=f(7),K=f(void 0),X=f(void 0),Z=M0(()=>W(X)!==void 0),w=f(void 0),G=f(""),H=f(C0([])),B=new kJ;async function F(Y){Y.preventDefault();try{if(!W(Z))D(K,W(Q),!0),D(X,0),await B.fetchTimeline(W(Q),(U)=>{D(X,U,!0)}),D(w,W(X),!0),D(X,void 0);else D(X,void 0),B.abortFetch()}catch(U){if(U.name!=="AbortError")throw U}}function q(Y){if(Y.key=="Enter"){Y.preventDefault();let U=W(G).trim().toLowerCase();D(H,B.searchPosts(U),!0)}}Gz(z,{children:(Y,U)=>{var x=iW(),I=S(h(x),2),M=O(I),A=O(M),E=S(O(A));p0(E);var v=S(E,2),T=O(v,!0);C(v),C(A);var y=S(A,2),N=O(y);p0(N);var R=S(N,2);{var k=(s)=>{var a=lW();g(()=>{i(a,"max",W(K)),W5(a,W(X))}),V(s,a)};j(R,(s)=>{if(W(Z))s(k)})}C(y),C(M);var $=S(M,2);{var b=(s)=>{var a=pW(),W0=O(a);C(a),g((K0)=>u(W0,`Timeline archive fetched: ${K0??""}`),[()=>v6(Math.round(W(w)))]),V(s,a)};j($,(s)=>{if(W(w))s(b)})}z1(2),C(I);var l=S(I,2);{var n=(s)=>{var a=dW(),W0=h(a),K0=O(W0),q0=S(O(K0));p0(q0),q0.__keydown=q,C(K0),C(W0);var o=S(W0,2);A0(o,21,()=>W(H),(e)=>e.uri,(e,P0)=>{L1(e,{get post(){return W(P0)},placement:"feed"})}),C(o),P1(q0,()=>W(G),(e)=>D(G,e)),V(s,a)};j(l,(s)=>{if(W(w))s(n)})}g((s)=>{u(T,s),W5(N,W(Z)?"Cancel":"Fetch timeline")},[()=>v6(W(Q))]),C1("submit",M,F),P1(E,()=>W(Q),(s)=>D(Q,s)),V(Y,x)},$$slots:{default:!0}}),c()}I0(["keydown"]);var _W=P("<!> <!> <!> <!>",1);function TJ(z,J){_(J,!0);let Q=(F)=>{var q=d(),Y=h(q);{var U=(I)=>{LJ(I,{})},x=(I)=>{var M=d(),A=h(M);{var E=(T)=>{DJ(T,{})},v=(T)=>{var y=d(),N=h(y);{var R=($)=>{OJ($,{})},k=($)=>{var b=d(),l=h(b);{var n=(a)=>{var W0=d(),K0=h(W0);{var q0=(e)=>{PJ(e,{get lycan(){return J.params.lycan}})},o=(e)=>{bJ(e,{})};j(K0,(e)=>{if(J.params.mode=="likes")e(q0);else e(o,!1)})}V(a,W0)},s=(a)=>{V7(a,{})};j(l,(a)=>{if(J.params.page=="search")a(n);else a(s,!1)},!0)}V($,b)};j(N,($)=>{if(J.params.page=="like_stats")$(R);else $(k,!1)},!0)}V(T,y)};j(A,(T)=>{if(J.params.page=="posting_stats")T(E);else T(v,!1)},!0)}V(I,M)};j(Y,(I)=>{if(J.params.page=="notif")I(U);else I(x,!1)})}V(F,q)};if(J.params.page&&!X1.loggedIn)I8({showClose:!1});var K=_W(),X=h(K);r9(X,{});var Z=S(X,2);o9(Z,{});var w=S(Z,2);AJ(w,{});var G=S(w,2);{var H=(F)=>{x7(F,{get url(){return J.params.q}})},B=(F)=>{var q=d(),Y=h(q);{var U=(I)=>{x7(I,{get author(){return J.params.author},get rkey(){return J.params.post}})},x=(I)=>{var M=d(),A=h(M);{var E=(T)=>{RJ(T,{get postURL(){return J.params.quotes}})},v=(T)=>{var y=d(),N=h(y);{var R=($)=>{MJ($,{get hashtag(){return J.params.hash}})},k=($)=>{var b=d(),l=h(b);{var n=(a)=>{var W0=d(),K0=h(W0);{var q0=(o)=>{Q(o)};j(K0,(o)=>{if(X1.loggedIn)o(q0)})}V(a,W0)},s=(a)=>{V7(a,{})};j(l,(a)=>{if(J.params.page)a(n);else a(s,!1)},!0)}V($,b)};j(N,($)=>{if(J.params.hash)$(R);else $(k,!1)},!0)}V(T,y)};j(A,(T)=>{if(J.params.quotes)T(E);else T(v,!1)},!0)}V(I,M)};j(Y,(I)=>{if(J.params.author&&J.params.post)I(U);else I(x,!1)},!0)}V(F,q)};j(G,(F)=>{if(J.params.q)F(H);else F(B,!1)})}V(z,K),c()}function PK(){if(window.location.protocol!="https:")return;let z=window._paq=window._paq||[];z.push(["setExcludedQueryParams",["fbclid"]]),z.push(["setTrackerUrl","https://mackuba.eu/stat/matomo.php"]),z.push(["setCustomUrl",cW(location.href)]),z.push(["setRequestMethod","POST"]),z.push(["setSiteId","13"]),z.push(["disableCookies"]),z.push(["disableAlwaysUseSendBeacon"]),z.push(["trackPageView"])}function cW(z){let J=new URL(z),Q=J.searchParams;for(let K of Q.keys())if(["q","author","post","quotes","hash"].includes(K))Q.set(K,"xxx");return J.search=Q.toString(),J.origin+J.pathname+J.search}function sW(){let z=YK(location.search);B8(TJ,{target:document.body,props:{params:z}})}document.addEventListener("DOMContentLoaded",sW);PK();})();

//# debugId=6B984B831C8949D464756E2164756E21
//# sourceMappingURL=skythread.js.map
